<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="UTF-8" />
  <title>Provider Portal â€“ My Car Concierge</title>
  <script>
    (function() {
      const theme = localStorage.getItem('theme') || 'dark';
      document.documentElement.setAttribute('data-theme', theme);
    })();
  </script>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="theme-color" content="#12161c" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="apple-mobile-web-app-title" content="My Car Concierge" />
  <link rel="manifest" href="/manifest.json" />
  <link rel="apple-touch-icon" href="/icons/apple-touch-icon.png" />
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/icon-192.png" />
  <!-- Preload critical resources -->
  <link rel="preload" href="/providers-core.js" as="script" />
  <link rel="preload" href="/supabaseclient.js" as="script" />
  <link rel="preload" href="/logo.png" as="image" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <!-- Preconnect to external services -->
  <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
  <link rel="preconnect" href="https://js.stripe.com" crossorigin>
  <link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin>
  <link rel="dns-prefetch" href="https://supabase.co">
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&family=Playfair+Display:wght@500;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/shared-styles.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/qr-creator/dist/qr-creator.min.js" defer></script>
  <script src="https://unpkg.com/html5-qrcode@2.3.8/html5-qrcode.min.js" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/signature_pad@4.1.7/dist/signature_pad.umd.min.js" defer></script>
  <style>
    :root {
      /* Automotive Theme - Warmer, garage-inspired */
      --bg-deep: #12161c;
      --bg-card: rgba(26, 32, 42, 0.9);
      --bg-elevated: rgba(36, 44, 56, 0.95);
      --bg-input: rgba(30, 38, 48, 0.9);
      --text-primary: #f5f5f7;
      --text-secondary: #a0a8b8;
      --text-muted: #6b7280;
      /* Bronze/copper - engine metal vibes */
      --accent-gold: #c9a227;
      --accent-gold-soft: rgba(201, 162, 39, 0.18);
      --accent-bronze: #cd7f32;
      --accent-bronze-soft: rgba(205, 127, 50, 0.15);
      /* Coolant teal - automotive fluid accent */
      --accent-teal: #22d3ee;
      --accent-teal-soft: rgba(34, 211, 238, 0.12);
      --accent-blue: #38bdf8;
      --accent-blue-soft: rgba(56, 189, 248, 0.12);
      --accent-green: #34d399;
      --accent-green-soft: rgba(52, 211, 153, 0.12);
      --accent-red: #f87171;
      --accent-red-soft: rgba(248, 113, 113, 0.15);
      --accent-orange: #fb923c;
      --accent-orange-soft: rgba(251, 146, 60, 0.15);
      --border-subtle: rgba(160, 168, 184, 0.15);
      --border-medium: rgba(160, 168, 184, 0.25);
      --border-focus: rgba(212, 168, 85, 0.5);
      --radius-sm: 8px;
      --radius-md: 12px;
      --radius-lg: 16px;
      --radius-xl: 24px;
    }

    /* Light Theme */
    [data-theme="light"] {
      /* Crisp, clean backgrounds */
      --bg-deep: #ffffff;
      --bg-card: rgba(250, 250, 252, 0.98);
      --bg-elevated: rgba(255, 255, 255, 1);
      --bg-input: #f0f2f5;
      /* Bold, readable text */
      --text-primary: #0d1117;
      --text-secondary: #2d3748;
      --text-muted: #5a6272;
      /* Stronger borders for definition */
      --border-subtle: rgba(0, 0, 0, 0.1);
      --border-medium: rgba(0, 0, 0, 0.18);
      --border-focus: rgba(201, 162, 39, 0.6);
      /* Richer accents for light mode */
      --accent-gold: #b8860b;
      --accent-gold-soft: rgba(184, 134, 11, 0.15);
      --accent-bronze: #a0522d;
      --accent-bronze-soft: rgba(160, 82, 45, 0.12);
      --accent-teal: #0891b2;
      --accent-teal-soft: rgba(8, 145, 178, 0.12);
      --accent-blue: #0284c7;
      --accent-blue-soft: rgba(2, 132, 199, 0.12);
    }

    /* Light mode sidebar - sleek light panel */
    [data-theme="light"] .sidebar {
      background: linear-gradient(180deg, #f8f9fa 0%, #ffffff 100%);
      border-right: 1px solid rgba(0, 0, 0, 0.08);
    }
    [data-theme="light"] .sidebar-footer {
      background: linear-gradient(180deg, transparent, rgba(248, 249, 250, 0.9));
    }
    [data-theme="light"] .user-info {
      background: linear-gradient(135deg, rgba(240, 242, 245, 0.9), rgba(255, 255, 255, 0.95));
      border: 1px solid rgba(0, 0, 0, 0.06);
    }
    [data-theme="light"] .nav-item:hover {
      background: rgba(184, 134, 11, 0.08);
      border-color: rgba(184, 134, 11, 0.15);
    }
    [data-theme="light"] .nav-item.active {
      background: linear-gradient(135deg, rgba(184, 134, 11, 0.12), rgba(184, 134, 11, 0.06));
      color: #b8860b;
      border-color: rgba(184, 134, 11, 0.25);
    }

    /* Light mode cards with subtle shadows */
    [data-theme="light"] .card,
    [data-theme="light"] .stat-card,
    [data-theme="light"] .vehicle-card {
      background: #ffffff;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06), 0 1px 2px rgba(0, 0, 0, 0.04);
      border: 1px solid rgba(0, 0, 0, 0.06);
    }
    [data-theme="light"] .stat-card:hover,
    [data-theme="light"] .vehicle-card:hover {
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
    }

    /* Theme transition */
    html.theme-transition,
    html.theme-transition *,
    html.theme-transition *::before,
    html.theme-transition *::after {
      transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease, box-shadow 0.3s ease !important;
    }

    /* Theme Toggle Button */
    .theme-toggle {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: var(--bg-elevated);
      border: 1px solid var(--border-subtle);
      cursor: pointer;
      transition: all 0.2s ease;
      font-size: 1.2rem;
    }
    .theme-toggle:hover {
      background: var(--accent-gold-soft);
      border-color: var(--accent-gold);
      transform: scale(1.05);
    }

    /* Headlight Theme Toggle */
    .theme-toggle-btn {
      display: flex;
      align-items: center;
      gap: 10px;
      width: 100%;
      padding: 12px 14px;
      margin-bottom: 8px;
      background: var(--bg-elevated);
      border: 1px solid var(--border-subtle);
      border-radius: 10px;
      cursor: pointer;
      font-family: inherit;
      font-size: 0.88rem;
      color: var(--text-secondary);
      transition: all 0.3s ease;
    }
    .theme-toggle-btn:hover {
      background: var(--accent-gold-soft);
      border-color: var(--accent-gold);
      color: var(--accent-gold);
      transform: scale(1.02);
      box-shadow: 0 0 20px rgba(201, 162, 39, 0.2);
    }
    .theme-icon-dark, .theme-icon-light {
      font-size: 1.2rem;
      transition: transform 0.3s ease;
    }
    [data-theme="dark"] .theme-icon-light { display: none; }
    [data-theme="light"] .theme-icon-dark { display: none; }
    [data-theme="dark"] .theme-toggle-btn:hover .theme-icon-dark {
      animation: flashlight 0.5s ease;
    }
    @keyframes flashlight {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.3); filter: drop-shadow(0 0 8px #ffd700); }
    }
    .theme-label { font-weight: 500; }

    /* Member Loyalty Badges */
    .member-badges { display: inline-flex; flex-wrap: wrap; gap: 6px; margin-left: 8px; }
    .member-badge { display: inline-flex; align-items: center; gap: 3px; padding: 3px 8px; border-radius: 100px; font-size: 0.7rem; font-weight: 600; letter-spacing: 0.02em; }
    .member-badge.vip { background: linear-gradient(135deg, #c9a227, #e8bc5a); color: #1a1a2e; box-shadow: 0 2px 6px rgba(201, 162, 39, 0.3); }
    .member-badge.trusted { background: var(--accent-teal-soft); color: var(--accent-teal); border: 1px solid rgba(34, 211, 238, 0.35); }
    .member-badge.loyal { background: var(--accent-bronze-soft); color: var(--accent-bronze); border: 1px solid rgba(205, 127, 50, 0.4); }

    /* Loyalty Network Referral Badges */
    .referral-type-badge { display: inline-flex; align-items: center; gap: 4px; padding: 4px 10px; border-radius: 100px; font-size: 0.72rem; font-weight: 600; letter-spacing: 0.02em; }
    .referral-type-badge.loyal-customer { background: linear-gradient(135deg, rgba(201, 162, 39, 0.25), rgba(201, 162, 39, 0.15)); color: var(--accent-gold); border: 1px solid rgba(201, 162, 39, 0.4); }
    .referral-type-badge.new-member { background: var(--accent-blue-soft); color: var(--accent-blue); border: 1px solid rgba(56, 189, 248, 0.35); }
    .referral-type-badge.provider { background: var(--accent-green-soft); color: var(--accent-green); border: 1px solid rgba(52, 211, 153, 0.35); }
    .loyalty-referral-item { display: flex; align-items: center; gap: 16px; padding: 16px; background: var(--bg-elevated); border: 1px solid var(--border-subtle); border-radius: var(--radius-md); margin-bottom: 12px; transition: all 0.2s ease; }
    .loyalty-referral-item:hover { border-color: var(--border-medium); background: rgba(30, 38, 48, 0.95); }
    .loyalty-referral-avatar { width: 44px; height: 44px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1rem; font-weight: 600; flex-shrink: 0; }
    .loyalty-referral-avatar.loyal-customer { background: linear-gradient(135deg, var(--accent-gold), #e8bc5a); color: #1a1a2e; }
    .loyalty-referral-avatar.new-member { background: linear-gradient(135deg, var(--accent-blue), #6bb8f8); color: #fff; }
    .loyalty-referral-avatar.provider { background: linear-gradient(135deg, var(--accent-green), #6be8b7); color: #fff; }
    .loyalty-referral-info { flex: 1; min-width: 0; }
    .loyalty-referral-name { font-weight: 600; font-size: 0.95rem; margin-bottom: 4px; }
    .loyalty-referral-date { font-size: 0.8rem; color: var(--text-muted); }
    .loyalty-qr-stats { display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 12px; margin-top: 16px; }
    .loyalty-qr-stat { display: flex; align-items: center; gap: 10px; padding: 12px 16px; background: var(--bg-input); border-radius: var(--radius-md); }
    .loyalty-qr-stat-icon { font-size: 1.2rem; }
    .loyalty-qr-stat-value { font-size: 1.2rem; font-weight: 700; }
    .loyalty-qr-stat-label { font-size: 0.75rem; color: var(--text-muted); }

    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { min-height: 100vh; font-family: 'Outfit', -apple-system, sans-serif; background: var(--bg-deep); color: var(--text-primary); display: flex; }

    .sidebar { width: 260px; background: linear-gradient(180deg, rgba(18, 18, 28, 0.98) 0%, rgba(12, 12, 20, 0.99) 100%); border-right: 1px solid var(--border-subtle); padding: 20px 12px; display: flex; flex-direction: column; position: fixed; height: 100vh; z-index: 50; overflow-y: auto; -webkit-overflow-scrolling: touch; padding-bottom: 100px; scrollbar-width: none; -ms-overflow-style: none; backdrop-filter: blur(20px); }
    .sidebar::-webkit-scrollbar { display: none; }
    .sidebar-brand { display: flex; align-items: center; justify-content: center; padding: 12px 12px 24px; border-bottom: 1px solid rgba(148, 148, 168, 0.08); margin-bottom: 20px; text-decoration: none; }
    .sidebar-brand-icon { height: 90px; width: auto; border-radius: var(--radius-lg); image-rendering: -webkit-optimize-contrast; image-rendering: crisp-edges; filter: drop-shadow(0 4px 20px rgba(212, 168, 85, 0.35)); border: 2px solid rgba(212, 168, 85, 0.25); transition: all 0.3s ease; }
    .sidebar-brand:hover .sidebar-brand-icon { filter: drop-shadow(0 6px 24px rgba(212, 168, 85, 0.5)); border-color: rgba(212, 168, 85, 0.4); transform: scale(1.02); }
    .sidebar-brand-text { font-family: 'Playfair Display', serif; font-weight: 500; color: var(--text-primary); }
    .nav-label { font-size: 0.65rem; text-transform: uppercase; letter-spacing: 0.14em; color: var(--text-muted); padding: 16px 14px 8px; margin-bottom: 4px; font-weight: 600; opacity: 0.7; }
    .nav-item { display: flex; align-items: center; gap: 10px; padding: 11px 14px; border-radius: 10px; cursor: pointer; font-size: 0.88rem; color: var(--text-secondary); transition: all 0.2s ease; margin-bottom: 2px; border: 1px solid transparent; font-weight: 450; }
    .nav-item:hover { background: rgba(212, 168, 85, 0.08); color: var(--text-primary); border-color: rgba(212, 168, 85, 0.12); }
    .nav-item.active { background: linear-gradient(135deg, rgba(212, 168, 85, 0.15), rgba(212, 168, 85, 0.08)); color: var(--accent-gold); border-color: rgba(212, 168, 85, 0.25); font-weight: 500; }
    .nav-badge { margin-left: auto; background: var(--accent-green); color: #022c22; font-size: 0.7rem; font-weight: 600; padding: 3px 8px; border-radius: 100px; min-width: 22px; text-align: center; }
    .sidebar-footer { margin-top: auto; padding: 16px; border-top: 1px solid rgba(148, 148, 168, 0.08); background: linear-gradient(180deg, transparent, rgba(18, 18, 28, 0.5)); }
    .user-info { display: flex; align-items: center; gap: 12px; padding: 12px 14px; border-radius: 12px; background: linear-gradient(135deg, rgba(28, 28, 42, 0.6), rgba(18, 18, 28, 0.8)); margin-bottom: 12px; border: 1px solid rgba(148, 148, 168, 0.08); }
    .user-avatar { width: 38px; height: 38px; background: linear-gradient(135deg, var(--accent-gold), #c49a45); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 14px; font-weight: 600; color: #0a0a0f; box-shadow: 0 2px 8px rgba(212, 168, 85, 0.25); }
    .user-name { font-size: 0.88rem; font-weight: 500; }
    .user-email { font-size: 0.75rem; color: var(--text-muted); }

    .main { flex: 1; margin-left: 260px; padding: 32px 40px 100px; min-height: 100vh; overflow-y: auto; -webkit-overflow-scrolling: touch; scrollbar-width: thin; scrollbar-color: rgba(212, 168, 85, 0.3) transparent; }
    .main::-webkit-scrollbar { width: 8px; }
    .main::-webkit-scrollbar-track { background: transparent; }
    .main::-webkit-scrollbar-thumb { background: linear-gradient(180deg, rgba(212, 168, 85, 0.4), rgba(212, 168, 85, 0.2)); border-radius: 10px; border: 2px solid transparent; background-clip: padding-box; }
    .main::-webkit-scrollbar-thumb:hover { background: linear-gradient(180deg, rgba(212, 168, 85, 0.6), rgba(212, 168, 85, 0.35)); border-radius: 10px; border: 2px solid transparent; background-clip: padding-box; }
    .page-header { margin-bottom: 32px; }
    .page-title { font-family: 'Playfair Display', serif; font-size: 1.8rem; font-weight: 500; margin-bottom: 8px; }
    .page-subtitle { color: var(--text-secondary); font-size: 0.95rem; }

    .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: 16px; margin-bottom: 32px; }
    .stat-card { background: linear-gradient(145deg, var(--bg-card), rgba(20, 26, 36, 0.95)); border: 1px solid var(--border-subtle); border-radius: var(--radius-lg); padding: 20px; box-shadow: 0 4px 20px rgba(0,0,0,0.2), inset 0 1px 0 rgba(255,255,255,0.03); }
    .stat-icon { width: 40px; height: 40px; border-radius: var(--radius-md); display: flex; align-items: center; justify-content: center; font-size: 18px; margin-bottom: 12px; }
    .stat-icon.gold { background: var(--accent-gold-soft); }
    .stat-icon.blue { background: var(--accent-blue-soft); }
    .stat-icon.green { background: var(--accent-green-soft); }
    .stat-value { font-size: 1.6rem; font-weight: 600; margin-bottom: 2px; }
    .stat-label { font-size: 0.82rem; color: var(--text-muted); }

    .card { background: linear-gradient(145deg, var(--bg-card), rgba(20, 26, 36, 0.95)); border: 1px solid var(--border-subtle); border-radius: var(--radius-lg); padding: 24px; margin-bottom: 20px; box-shadow: 0 4px 20px rgba(0,0,0,0.2), inset 0 1px 0 rgba(255,255,255,0.03); }
    .card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
    .card-title { font-size: 1.1rem; font-weight: 600; }

    .btn { display: inline-flex; align-items: center; gap: 8px; padding: 10px 20px; font-family: inherit; font-size: 0.88rem; font-weight: 500; border: none; border-radius: var(--radius-md); cursor: pointer; transition: all 0.2s ease; box-shadow: 0 2px 8px rgba(0,0,0,0.2); }
    .btn-primary { background: linear-gradient(135deg, var(--accent-blue), #5eb8f7); color: #fff; box-shadow: 0 2px 12px rgba(56, 189, 248, 0.3); }
    .btn-primary:hover { transform: translateY(-1px); box-shadow: 0 4px 16px rgba(56, 189, 248, 0.4); }
    .btn-secondary { background: var(--bg-elevated); color: var(--text-primary); border: 1px solid var(--border-subtle); }
    .btn-ghost { background: transparent; color: var(--text-secondary); padding: 8px 12px; }
    .btn-sm { padding: 6px 12px; font-size: 0.82rem; }
    .btn-gold { background: linear-gradient(135deg, var(--accent-gold), #e6b84a); color: #12161c; box-shadow: 0 2px 12px rgba(201, 162, 39, 0.3); }
    .btn-success { background: linear-gradient(135deg, var(--accent-green), #4ade80); color: #fff; box-shadow: 0 2px 12px rgba(52, 211, 153, 0.3); }

    .package-card { background: var(--bg-card); border: 1px solid var(--border-subtle); border-radius: var(--radius-lg); padding: 24px; margin-bottom: 16px; }
    .package-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 12px; }
    .package-title { font-size: 1.1rem; font-weight: 600; margin-bottom: 4px; }
    .package-vehicle { font-size: 0.88rem; color: var(--text-secondary); }
    .package-badge { padding: 4px 12px; border-radius: 100px; font-size: 0.78rem; font-weight: 500; }
    .package-badge.open { background: var(--accent-green-soft); color: var(--accent-green); }
    .package-badge.recurring { background: var(--accent-blue-soft); color: var(--accent-blue); }
    .package-meta { display: flex; gap: 16px; flex-wrap: wrap; margin-bottom: 12px; font-size: 0.85rem; color: var(--text-muted); }
    .package-description { color: var(--text-secondary); font-size: 0.9rem; line-height: 1.6; margin-bottom: 16px; }
    .package-footer { display: flex; justify-content: space-between; align-items: center; padding-top: 16px; border-top: 1px solid var(--border-subtle); }

    .bid-card { background: var(--bg-elevated); border: 1px solid var(--border-subtle); border-radius: var(--radius-md); padding: 16px 20px; margin-bottom: 12px; }
    .bid-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; }
    .bid-package { font-weight: 600; }
    .bid-amount { font-size: 1.2rem; font-weight: 600; color: var(--accent-gold); }
    .bid-status { padding: 4px 12px; border-radius: 100px; font-size: 0.75rem; font-weight: 500; }
    .bid-status.pending { background: var(--accent-gold-soft); color: var(--accent-gold); }
    .bid-status.accepted { background: var(--accent-green-soft); color: var(--accent-green); }
    .bid-status.rejected { background: rgba(239,95,95,0.15); color: var(--accent-red); }
    .bid-meta { font-size: 0.85rem; color: var(--text-muted); }

    .modal-backdrop { position: fixed; inset: 0; background: rgba(0,0,0,0.7); backdrop-filter: blur(4px); display: none; align-items: center; justify-content: center; z-index: 100; padding: 24px; }
    .modal-backdrop.active { display: flex; }
    .modal { background: var(--bg-elevated); border: 1px solid var(--border-medium); border-radius: var(--radius-xl); width: 100%; max-width: 560px; max-height: 90vh; overflow-y: auto; animation: modalIn 0.2s ease; scrollbar-width: thin; scrollbar-color: rgba(201,162,39,0.4) transparent; }
    .modal::-webkit-scrollbar { width: 8px; }
    .modal::-webkit-scrollbar-track { background: transparent; border-radius: 4px; }
    .modal::-webkit-scrollbar-thumb { background: linear-gradient(180deg, rgba(201,162,39,0.5), rgba(201,162,39,0.3)); border-radius: 4px; }
    .modal::-webkit-scrollbar-thumb:hover { background: linear-gradient(180deg, rgba(201,162,39,0.7), rgba(201,162,39,0.5)); }
    @keyframes modalIn { from { opacity: 0; transform: scale(0.95); } to { opacity: 1; transform: scale(1); } }
    .modal-header { display: flex; justify-content: space-between; align-items: center; padding: 24px 28px; border-bottom: 1px solid var(--border-subtle); }
    .modal-title { font-size: 1.15rem; font-weight: 600; }
    .modal-close { width: 32px; height: 32px; display: flex; align-items: center; justify-content: center; background: transparent; border: none; color: var(--text-muted); cursor: pointer; border-radius: var(--radius-sm); font-size: 20px; }
    .modal-body { padding: 24px 28px; }
    .modal-footer { display: flex; justify-content: flex-end; gap: 12px; padding: 20px 28px; border-top: 1px solid var(--border-subtle); }

    .form-group { margin-bottom: 20px; }
    .form-label { display: block; font-size: 0.85rem; font-weight: 500; margin-bottom: 8px; color: var(--text-secondary); }
    .form-input, .form-textarea { width: 100%; padding: 12px 16px; background: var(--bg-input); border: 1px solid var(--border-subtle); border-radius: var(--radius-md); color: var(--text-primary); font-family: inherit; font-size: 0.92rem; }
    .form-input:focus, .form-textarea:focus { outline: none; border-color: var(--border-focus); }
    .form-textarea { min-height: 100px; resize: vertical; }
    .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }
    .form-hint { font-size: 0.78rem; color: var(--text-muted); margin-top: 6px; }

    .messages-container { max-height: 300px; overflow-y: auto; margin-bottom: 16px; padding: 16px; background: var(--bg-input); border-radius: var(--radius-md); }
    .message { margin-bottom: 12px; }
    .message.sent { text-align: right; }
    .message-bubble { display: inline-block; max-width: 80%; padding: 10px 14px; border-radius: var(--radius-md); font-size: 0.9rem; }
    .message.received .message-bubble { background: var(--bg-elevated); }
    .message.sent .message-bubble { background: var(--accent-gold); color: #0a0a0f; }
    .message-time { font-size: 0.72rem; color: var(--text-muted); margin-top: 4px; }
    .message-input-row { display: flex; gap: 12px; }

    .photo-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); gap: 12px; }
    .photo-item { aspect-ratio: 4/3; border-radius: var(--radius-md); overflow: hidden; border: 1px solid var(--border-subtle); cursor: pointer; }
    .photo-item img { width: 100%; height: 100%; object-fit: cover; }

    .section { display: none; }
    .section.active { display: block; }
    .empty-state { text-align: center; padding: 48px 24px; color: var(--text-muted); }
    .empty-state-icon { font-size: 48px; margin-bottom: 16px; opacity: 0.5; }

    /* Countdown Timer */
    .countdown-timer { display: inline-flex; align-items: center; gap: 6px; padding: 6px 12px; background: var(--accent-gold-soft); border-radius: var(--radius-sm); font-size: 0.82rem; font-weight: 500; color: var(--accent-gold); }
    .countdown-timer.urgent { background: rgba(239, 95, 95, 0.15); color: var(--accent-red); animation: pulse 2s infinite; }
    .countdown-timer.expired { background: var(--bg-input); color: var(--text-muted); }
    @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.7; } }

    /* Services Grid */
    .services-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 10px; }
    .service-checkbox { display: flex; align-items: center; gap: 10px; padding: 12px 14px; background: var(--bg-input); border: 1px solid var(--border-subtle); border-radius: var(--radius-md); cursor: pointer; font-size: 0.9rem; transition: all 0.15s; }
    .service-checkbox:hover { border-color: var(--border-medium); }
    .service-checkbox:has(input:checked) { border-color: var(--accent-gold); background: var(--accent-gold-soft); }
    .service-checkbox input { width: 18px; height: 18px; accent-color: var(--accent-gold); cursor: pointer; }

    .toast-container { position: fixed; bottom: 24px; right: 24px; z-index: 200; }
    .toast { background: var(--bg-elevated); border: 1px solid var(--accent-green); border-radius: var(--radius-md); padding: 16px 20px; display: flex; align-items: center; gap: 12px; animation: toastIn 0.3s ease; }
    @keyframes toastIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

    /* Logistics Dashboard Styles */
    .job-dashboard { background: var(--bg-card); border: 1px solid var(--border-subtle); border-radius: var(--radius-lg); padding: 24px; margin-bottom: 20px; }
    .job-dashboard-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 20px; padding-bottom: 16px; border-bottom: 1px solid var(--border-subtle); }
    .job-dashboard-title { font-size: 1.15rem; font-weight: 600; margin-bottom: 4px; }
    .job-dashboard-vehicle { font-size: 0.9rem; color: var(--text-secondary); }
    .job-dashboard-price { font-size: 1.3rem; font-weight: 600; color: var(--accent-gold); }
    
    .logistics-section { background: var(--bg-elevated); border: 1px solid var(--border-subtle); border-radius: var(--radius-md); padding: 20px; margin-bottom: 16px; }
    .logistics-section-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; }
    .logistics-section-title { font-size: 1rem; font-weight: 600; display: flex; align-items: center; gap: 8px; }
    .logistics-section-content { color: var(--text-secondary); font-size: 0.9rem; }
    
    /* Status Timeline */
    .status-timeline { display: flex; flex-direction: column; gap: 0; margin: 16px 0; }
    .status-step { display: flex; align-items: flex-start; gap: 12px; position: relative; padding-bottom: 16px; }
    .status-step:last-child { padding-bottom: 0; }
    .status-step::before { content: ''; position: absolute; left: 15px; top: 32px; bottom: 0; width: 2px; background: var(--border-subtle); }
    .status-step:last-child::before { display: none; }
    .status-dot { width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 14px; flex-shrink: 0; border: 2px solid var(--border-subtle); background: var(--bg-input); }
    .status-step.completed .status-dot { background: var(--accent-green); border-color: var(--accent-green); color: #fff; }
    .status-step.current .status-dot { background: var(--accent-gold); border-color: var(--accent-gold); color: #0a0a0f; animation: pulse 2s infinite; }
    .status-step.pending .status-dot { opacity: 0.5; }
    .status-info { flex: 1; padding-top: 4px; }
    .status-label { font-weight: 500; font-size: 0.9rem; margin-bottom: 2px; }
    .status-step.pending .status-label { color: var(--text-muted); }
    .status-time { font-size: 0.78rem; color: var(--text-muted); }
    .status-action { margin-top: 8px; }
    
    /* Appointment Card */
    .appointment-card { background: var(--bg-input); border: 1px solid var(--border-subtle); border-radius: var(--radius-md); padding: 16px; }
    .appointment-date { font-size: 1.1rem; font-weight: 600; color: var(--accent-gold); margin-bottom: 4px; }
    .appointment-time { font-size: 0.9rem; color: var(--text-secondary); }
    .appointment-status { display: inline-block; padding: 4px 12px; border-radius: 100px; font-size: 0.78rem; font-weight: 500; margin-top: 8px; }
    .appointment-status.proposed { background: var(--accent-gold-soft); color: var(--accent-gold); }
    .appointment-status.confirmed { background: var(--accent-green-soft); color: var(--accent-green); }
    .appointment-status.rescheduled { background: var(--accent-blue-soft); color: var(--accent-blue); }
    
    /* Location Card */
    .location-card { background: var(--bg-input); border: 1px solid var(--border-subtle); border-radius: var(--radius-md); padding: 16px; display: flex; gap: 12px; align-items: flex-start; }
    .location-icon { font-size: 24px; }
    .location-details { flex: 1; }
    .location-address { font-size: 0.9rem; margin-bottom: 4px; line-height: 1.4; }
    .location-time { font-size: 0.78rem; color: var(--text-muted); }

    @media (max-width: 900px) {
      .sidebar { transform: translateX(-100%); transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1); width: 300px; padding: 16px 14px; padding-bottom: 100px; overflow-y: auto; -webkit-overflow-scrolling: touch; background: rgba(12, 12, 18, 0.98); }
      .sidebar.open { transform: translateX(0); box-shadow: 8px 0 40px rgba(0,0,0,0.6); }
      .main { margin-left: 0; padding: 24px 16px 100px; }
      .mobile-header { display: flex; align-items: center; gap: 16px; margin-bottom: 24px; }
      .mobile-menu-btn { width: 44px; height: 44px; display: flex; align-items: center; justify-content: center; background: var(--bg-card); border: 1px solid var(--border-subtle); border-radius: var(--radius-md); color: var(--text-primary); cursor: pointer; font-size: 1.2rem; }
      .form-row { grid-template-columns: 1fr; }
      .nav-item { padding: 13px 16px; font-size: 0.95rem; border-radius: 12px; margin-bottom: 3px; }
      .nav-label { padding: 20px 16px 10px; font-size: 0.68rem; }
      .sidebar-brand-icon { height: 64px; }
      .sidebar-footer { padding: 16px; margin-top: auto; background: rgba(18, 18, 28, 0.5); border-radius: var(--radius-md); margin: auto 4px 8px; }
      .btn { min-height: 48px; }
      .package-card { padding: 16px; }
      .filter-bar { flex-direction: column; }
      .filter-group { min-width: 100% !important; }
      body.sidebar-open { overflow: hidden; }
    }
    @media (min-width: 901px) { .mobile-header { display: none; } }

    /* Emergency Queue Styles */
    .emergency-card { background: linear-gradient(135deg, rgba(239, 95, 95, 0.15), rgba(255, 68, 68, 0.1)); border: 1px solid rgba(239, 95, 95, 0.3); border-radius: var(--radius-lg); padding: 20px; margin-bottom: 16px; transition: all 0.3s ease; }
    .emergency-card:hover { border-color: rgba(239, 95, 95, 0.5); }
    .emergency-card.urgent-emergency { background: linear-gradient(135deg, rgba(239, 95, 95, 0.25), rgba(255, 68, 68, 0.2)); border-color: rgba(239, 95, 95, 0.6); animation: urgentPulse 1.5s infinite; }
    @keyframes urgentPulse { 0%, 100% { box-shadow: 0 0 0 0 rgba(239, 95, 95, 0.4); } 50% { box-shadow: 0 0 20px 4px rgba(239, 95, 95, 0.3); } }
    .emergency-type-badge { display: inline-block; padding: 4px 12px; border-radius: 100px; font-size: 0.78rem; font-weight: 500; background: rgba(239, 95, 95, 0.2); color: var(--accent-red); }
    .emergency-distance { font-size: 0.9rem; color: var(--accent-gold); font-weight: 500; }
    .emergency-time { font-size: 0.8rem; color: var(--text-muted); }
    .emergency-actions { display: flex; gap: 12px; margin-top: 16px; }
    .btn-emergency { background: linear-gradient(135deg, #ef5f5f, #ff4444); color: white; }
    .btn-emergency:hover { box-shadow: 0 4px 16px rgba(239, 95, 95, 0.3); }
    .nav-badge.emergency { background: var(--accent-red); animation: pulse 2s infinite; }
    @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.6; } }

    /* Team Member Cards */
    .team-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 20px; }
    .team-card { background: var(--bg-card); border: 1px solid var(--border-subtle); border-radius: var(--radius-lg); padding: 24px; transition: all 0.2s ease; }
    .team-card:hover { border-color: var(--accent-gold); box-shadow: 0 4px 20px rgba(212, 168, 85, 0.15); transform: translateY(-2px); }
    .team-card-header { display: flex; gap: 16px; align-items: flex-start; margin-bottom: 16px; }
    .team-avatar { width: 80px; height: 80px; border-radius: 50%; background: linear-gradient(135deg, var(--accent-gold-soft), var(--bg-elevated)); display: flex; align-items: center; justify-content: center; font-size: 32px; color: var(--accent-gold); flex-shrink: 0; overflow: hidden; border: 2px solid var(--border-subtle); }
    .team-avatar img { width: 100%; height: 100%; object-fit: cover; }
    .team-info { flex: 1; min-width: 0; }
    .team-name { font-size: 1.1rem; font-weight: 600; margin-bottom: 4px; }
    .team-role { display: inline-block; padding: 4px 12px; border-radius: 100px; font-size: 0.78rem; font-weight: 500; background: var(--accent-blue-soft); color: var(--accent-blue); }
    .team-experience { font-size: 0.85rem; color: var(--text-muted); margin-top: 8px; }
    .team-bio { font-size: 0.9rem; color: var(--text-secondary); line-height: 1.5; margin-bottom: 16px; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
    .team-badges { display: flex; flex-wrap: wrap; gap: 6px; margin-bottom: 16px; }
    .team-badge { padding: 4px 10px; border-radius: 100px; font-size: 0.72rem; font-weight: 500; background: var(--accent-gold-soft); color: var(--accent-gold); }
    .team-actions { display: flex; gap: 8px; padding-top: 16px; border-top: 1px solid var(--border-subtle); }
    .team-photo-upload { width: 150px; height: 150px; border-radius: 50%; background: var(--bg-input); border: 2px dashed var(--border-subtle); display: flex; flex-direction: column; align-items: center; justify-content: center; cursor: pointer; margin: 0 auto 20px; transition: all 0.2s ease; overflow: hidden; }
    .team-photo-upload:hover { border-color: var(--accent-gold); }
    .team-photo-upload.has-photo { border-style: solid; }
    .team-photo-upload img { width: 100%; height: 100%; object-fit: cover; }
    .team-photo-upload-icon { font-size: 36px; margin-bottom: 8px; color: var(--text-muted); }
    .team-photo-upload-text { font-size: 0.85rem; color: var(--text-muted); }
    .team-status-badge { display: inline-flex; align-items: center; gap: 6px; padding: 4px 10px; border-radius: 100px; font-size: 0.75rem; font-weight: 500; }
    .team-status-badge.active { background: var(--accent-green-soft); color: var(--accent-green); }
    .team-status-badge.inactive { background: rgba(107, 107, 122, 0.15); color: var(--text-muted); }

    /* Multi-Point Inspection Styles */
    .inspection-modal { max-width: 800px; }
    .inspection-category { background: var(--bg-input); border: 1px solid var(--border-subtle); border-radius: var(--radius-md); margin-bottom: 16px; overflow: hidden; }
    .inspection-category-header { padding: 14px 16px; background: var(--bg-elevated); display: flex; justify-content: space-between; align-items: center; cursor: pointer; border-bottom: 1px solid var(--border-subtle); }
    .inspection-category-header:hover { background: rgba(28, 28, 42, 0.98); }
    .inspection-category-title { font-weight: 600; font-size: 0.95rem; display: flex; align-items: center; gap: 8px; }
    .inspection-category-count { font-size: 0.78rem; color: var(--text-muted); }
    .inspection-category-body { padding: 16px; display: none; }
    .inspection-category.expanded .inspection-category-body { display: block; }
    .inspection-item { display: flex; justify-content: space-between; align-items: center; padding: 12px 0; border-bottom: 1px solid var(--border-subtle); gap: 12px; flex-wrap: wrap; }
    .inspection-item:last-child { border-bottom: none; padding-bottom: 0; }
    .inspection-item-label { font-size: 0.9rem; font-weight: 500; min-width: 120px; }
    .inspection-status-btns { display: flex; gap: 6px; flex-wrap: wrap; }
    .inspection-status-btn { padding: 6px 12px; border-radius: 100px; font-size: 0.75rem; font-weight: 500; border: 1px solid var(--border-subtle); background: var(--bg-input); color: var(--text-muted); cursor: pointer; transition: all 0.15s; }
    .inspection-status-btn:hover { border-color: var(--text-secondary); }
    .inspection-status-btn.good { border-color: var(--accent-green); color: var(--accent-green); }
    .inspection-status-btn.good.active { background: var(--accent-green); color: #fff; }
    .inspection-status-btn.fair { border-color: #f59e0b; color: #f59e0b; }
    .inspection-status-btn.fair.active { background: #f59e0b; color: #000; }
    .inspection-status-btn.needs_attention { border-color: #f97316; color: #f97316; }
    .inspection-status-btn.needs_attention.active { background: #f97316; color: #fff; }
    .inspection-status-btn.urgent { border-color: var(--accent-red); color: var(--accent-red); }
    .inspection-status-btn.urgent.active { background: var(--accent-red); color: #fff; }
    .inspection-status-btn.na { border-color: var(--text-muted); color: var(--text-muted); }
    .inspection-status-btn.na.active { background: var(--text-muted); color: var(--bg-deep); }
    .inspection-measurement { display: flex; align-items: center; gap: 8px; margin-left: auto; }
    .inspection-measurement input { width: 60px; padding: 6px 8px; background: var(--bg-elevated); border: 1px solid var(--border-subtle); border-radius: var(--radius-sm); color: var(--text-primary); font-size: 0.85rem; text-align: center; }
    .inspection-measurement span { font-size: 0.78rem; color: var(--text-muted); }
    .inspection-summary { background: var(--bg-elevated); border: 1px solid var(--border-subtle); border-radius: var(--radius-md); padding: 20px; margin-bottom: 16px; }
    .inspection-summary-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; text-align: center; }
    .inspection-summary-item { padding: 12px; border-radius: var(--radius-sm); }
    .inspection-summary-item.excellent { background: var(--accent-green-soft); color: var(--accent-green); }
    .inspection-summary-item.good { background: rgba(34, 197, 94, 0.15); color: #22c55e; }
    .inspection-summary-item.fair { background: rgba(245, 158, 11, 0.15); color: #f59e0b; }
    .inspection-summary-item.attention { background: rgba(249, 115, 22, 0.15); color: #f97316; }
    .inspection-summary-item.urgent { background: rgba(239, 95, 95, 0.15); color: var(--accent-red); }
    .inspection-summary-count { font-size: 1.5rem; font-weight: 600; }
    .inspection-summary-label { font-size: 0.75rem; text-transform: uppercase; letter-spacing: 0.05em; }
    .inspection-overall { display: flex; align-items: center; gap: 16px; padding: 16px; background: var(--bg-input); border-radius: var(--radius-md); margin-bottom: 16px; }
    .inspection-overall-badge { padding: 8px 20px; border-radius: 100px; font-weight: 600; font-size: 0.9rem; }
    .inspection-overall-badge.excellent { background: var(--accent-green); color: #fff; }
    .inspection-overall-badge.good { background: #22c55e; color: #fff; }
    .inspection-overall-badge.fair { background: #f59e0b; color: #000; }
    .inspection-overall-badge.needs_attention { background: #f97316; color: #fff; }
    .inspection-btn { display: inline-flex; align-items: center; gap: 6px; padding: 8px 14px; background: linear-gradient(135deg, var(--accent-blue), #6b9fff); color: #fff; border: none; border-radius: var(--radius-md); font-size: 0.85rem; font-weight: 500; cursor: pointer; transition: all 0.2s; }
    .inspection-btn:hover { box-shadow: 0 4px 12px rgba(74, 124, 255, 0.3); transform: translateY(-1px); }

    /* Performance Scoring Styles */
    .performance-score-display { display: flex; flex-direction: column; align-items: center; justify-content: center; width: 180px; height: 180px; border-radius: 50%; background: linear-gradient(135deg, var(--bg-elevated), var(--bg-input)); border: 4px solid var(--accent-gold); position: relative; }
    .performance-score-value { font-size: 3.5rem; font-weight: 700; color: var(--accent-gold); line-height: 1; }
    .performance-score-label { font-size: 0.85rem; color: var(--text-muted); margin-top: 4px; }
    .performance-tier-badge { display: inline-flex; align-items: center; gap: 8px; padding: 10px 24px; border-radius: 100px; font-size: 1rem; font-weight: 600; text-transform: uppercase; letter-spacing: 0.1em; }
    .performance-tier-badge.platinum { background: linear-gradient(135deg, #e5e4e2, #c0c0c0); color: #1a1a2e; box-shadow: 0 4px 20px rgba(229, 228, 226, 0.4); }
    .performance-tier-badge.gold { background: linear-gradient(135deg, var(--accent-gold), #c49a45); color: #1a1a2e; box-shadow: 0 4px 20px rgba(212, 168, 85, 0.4); }
    .performance-tier-badge.silver { background: linear-gradient(135deg, #c0c0c0, #a8a8a8); color: #1a1a2e; box-shadow: 0 4px 20px rgba(192, 192, 192, 0.4); }
    .performance-tier-badge.bronze { background: linear-gradient(135deg, #cd7f32, #b87333); color: #fff; box-shadow: 0 4px 20px rgba(205, 127, 50, 0.4); }
    .performance-metrics-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 16px; }
    .performance-metric-card { background: var(--bg-elevated); border: 1px solid var(--border-subtle); border-radius: var(--radius-lg); padding: 20px; text-align: center; transition: all 0.2s; }
    .performance-metric-card:hover { border-color: var(--accent-gold); transform: translateY(-2px); }
    .performance-metric-icon { font-size: 1.5rem; margin-bottom: 8px; }
    .performance-metric-value { font-size: 1.6rem; font-weight: 700; color: var(--text-primary); margin-bottom: 4px; }
    .performance-metric-label { font-size: 0.82rem; color: var(--text-muted); }
    .performance-badges-grid { display: flex; flex-wrap: wrap; gap: 12px; }
    .performance-badge { display: inline-flex; align-items: center; gap: 8px; padding: 12px 18px; background: var(--bg-elevated); border: 1px solid var(--border-subtle); border-radius: var(--radius-md); font-size: 0.9rem; font-weight: 500; transition: all 0.2s; }
    .performance-badge.earned { background: var(--accent-gold-soft); border-color: var(--accent-gold); color: var(--accent-gold); }
    .performance-badge.locked { opacity: 0.4; }
    .performance-badge-icon { font-size: 1.3rem; }
    .performance-tip { display: flex; align-items: flex-start; gap: 12px; padding: 16px; background: var(--accent-blue-soft); border: 1px solid rgba(74, 124, 255, 0.3); border-radius: var(--radius-md); margin-bottom: 12px; }
    .performance-tip-icon { font-size: 1.2rem; flex-shrink: 0; }
    .performance-tip-text { font-size: 0.9rem; color: var(--text-secondary); }
    .stars-display { display: inline-flex; gap: 2px; color: var(--accent-gold); }

    /* Destination Tasks Styles */
    .dest-filter-tabs { display: flex; gap: 8px; margin-bottom: 20px; flex-wrap: wrap; }
    .dest-filter-tab { padding: 10px 18px; background: var(--bg-input); border: 1px solid var(--border-subtle); border-radius: var(--radius-md); cursor: pointer; font-size: 0.88rem; color: var(--text-secondary); transition: all 0.15s; display: flex; align-items: center; gap: 6px; }
    .dest-filter-tab:hover { border-color: var(--accent-gold); color: var(--text-primary); }
    .dest-filter-tab.active { background: var(--accent-gold-soft); border-color: var(--accent-gold); color: var(--accent-gold); }
    .dest-task-card { background: var(--bg-card); border: 1px solid var(--border-subtle); border-radius: var(--radius-lg); padding: 20px; margin-bottom: 16px; cursor: pointer; transition: all 0.2s; }
    .dest-task-card:hover { border-color: var(--accent-gold); box-shadow: 0 4px 20px rgba(0,0,0,0.2); transform: translateY(-2px); }
    .dest-task-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 12px; }
    .dest-task-type { display: inline-flex; align-items: center; gap: 8px; padding: 6px 14px; border-radius: 100px; font-size: 0.82rem; font-weight: 500; }
    .dest-task-type.airport { background: rgba(74, 124, 255, 0.15); color: var(--accent-blue); }
    .dest-task-type.dealership { background: rgba(249, 115, 22, 0.15); color: #f97316; }
    .dest-task-type.detail { background: rgba(168, 85, 247, 0.15); color: #a855f7; }
    .dest-task-type.valet { background: rgba(236, 72, 153, 0.15); color: #ec4899; }
    .dest-task-status { padding: 4px 12px; border-radius: 100px; font-size: 0.75rem; font-weight: 500; text-transform: capitalize; }
    .dest-task-status.pending { background: var(--accent-gold-soft); color: var(--accent-gold); }
    .dest-task-status.assigned { background: var(--accent-blue-soft); color: var(--accent-blue); }
    .dest-task-status.en_route, .dest-task-status.in_transit { background: rgba(249, 115, 22, 0.15); color: #f97316; }
    .dest-task-status.picked_up, .dest-task-status.in_progress { background: rgba(168, 85, 247, 0.15); color: #a855f7; }
    .dest-task-status.at_destination { background: rgba(34, 197, 94, 0.15); color: #22c55e; }
    .dest-task-status.completed { background: var(--accent-green-soft); color: var(--accent-green); }
    .dest-task-route { display: flex; align-items: center; gap: 12px; margin: 12px 0; padding: 12px; background: var(--bg-input); border-radius: var(--radius-md); font-size: 0.9rem; }
    .dest-task-route-arrow { color: var(--accent-gold); font-weight: bold; }
    .dest-task-meta { display: flex; gap: 16px; flex-wrap: wrap; font-size: 0.85rem; color: var(--text-muted); }
    .dest-task-time { display: flex; align-items: center; gap: 6px; color: var(--accent-gold); font-weight: 500; }
    .dest-task-priority { display: inline-flex; align-items: center; gap: 4px; padding: 2px 8px; border-radius: 4px; font-size: 0.72rem; font-weight: 600; }
    .dest-task-priority.high { background: rgba(239, 95, 95, 0.15); color: var(--accent-red); }
    .dest-task-priority.normal { background: var(--accent-blue-soft); color: var(--accent-blue); }
    .dest-task-priority.low { background: rgba(107, 107, 122, 0.15); color: var(--text-muted); }
    .dest-task-actions { display: flex; gap: 8px; margin-top: 16px; padding-top: 16px; border-top: 1px solid var(--border-subtle); flex-wrap: wrap; }
    .dest-timeline { margin: 20px 0; }
    .dest-timeline-item { display: flex; gap: 12px; position: relative; padding-bottom: 16px; }
    .dest-timeline-item:last-child { padding-bottom: 0; }
    .dest-timeline-item::before { content: ''; position: absolute; left: 15px; top: 32px; bottom: 0; width: 2px; background: var(--border-subtle); }
    .dest-timeline-item:last-child::before { display: none; }
    .dest-timeline-dot { width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 14px; flex-shrink: 0; background: var(--bg-input); border: 2px solid var(--border-subtle); }
    .dest-timeline-item.completed .dest-timeline-dot { background: var(--accent-green); border-color: var(--accent-green); color: #fff; }
    .dest-timeline-item.current .dest-timeline-dot { background: var(--accent-gold); border-color: var(--accent-gold); color: #0a0a0f; animation: pulse 2s infinite; }
    .dest-service-icon { font-size: 1.5rem; }
    .dest-driver-select { padding: 12px; background: var(--bg-elevated); border: 1px solid var(--border-subtle); border-radius: var(--radius-md); margin-top: 12px; }
    .dest-completed-stats { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 12px; margin-bottom: 20px; }
    .dest-completed-stat { background: var(--bg-elevated); border: 1px solid var(--border-subtle); border-radius: var(--radius-md); padding: 16px; text-align: center; }
    .dest-completed-stat-value { font-size: 1.5rem; font-weight: 600; color: var(--accent-gold); }
    .dest-completed-stat-label { font-size: 0.82rem; color: var(--text-muted); }

    /* Fleet Services Styles */
    .fleet-batch-card { background: var(--bg-card); border: 1px solid var(--border-subtle); border-radius: var(--radius-lg); padding: 24px; margin-bottom: 16px; transition: all 0.2s; cursor: pointer; }
    .fleet-batch-card:hover { border-color: var(--accent-gold); box-shadow: 0 4px 20px rgba(0,0,0,0.2); transform: translateY(-2px); }
    .fleet-batch-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 16px; }
    .fleet-batch-title { font-size: 1.15rem; font-weight: 600; margin-bottom: 4px; }
    .fleet-batch-company { display: flex; align-items: center; gap: 8px; font-size: 0.9rem; color: var(--accent-blue); }
    .fleet-batch-company-logo { width: 24px; height: 24px; border-radius: 4px; background: var(--accent-blue-soft); display: flex; align-items: center; justify-content: center; font-size: 0.7rem; font-weight: 600; }
    .fleet-batch-status { padding: 6px 14px; border-radius: 100px; font-size: 0.78rem; font-weight: 500; }
    .fleet-batch-status.draft { background: rgba(107, 107, 122, 0.15); color: var(--text-muted); }
    .fleet-batch-status.pending_approval { background: var(--accent-gold-soft); color: var(--accent-gold); }
    .fleet-batch-status.approved { background: var(--accent-blue-soft); color: var(--accent-blue); }
    .fleet-batch-status.in_progress { background: rgba(168, 85, 247, 0.15); color: #a855f7; }
    .fleet-batch-status.completed { background: var(--accent-green-soft); color: var(--accent-green); }
    .fleet-batch-status.open { background: var(--accent-green-soft); color: var(--accent-green); }
    .fleet-batch-meta { display: flex; gap: 20px; flex-wrap: wrap; font-size: 0.88rem; color: var(--text-secondary); margin-bottom: 16px; }
    .fleet-batch-meta-item { display: flex; align-items: center; gap: 6px; }
    .fleet-progress-bar { height: 8px; background: var(--bg-input); border-radius: 4px; overflow: hidden; margin: 12px 0; }
    .fleet-progress-fill { height: 100%; background: linear-gradient(90deg, var(--accent-gold), #c49a45); border-radius: 4px; transition: width 0.3s ease; }
    .fleet-progress-text { font-size: 0.85rem; color: var(--text-secondary); display: flex; justify-content: space-between; }
    .fleet-batch-value { font-size: 1.3rem; font-weight: 600; color: var(--accent-gold); }
    
    .fleet-vehicle-badge { display: inline-flex; align-items: center; gap: 6px; padding: 4px 10px; background: linear-gradient(135deg, var(--accent-blue-soft), rgba(74, 124, 255, 0.2)); border: 1px solid rgba(74, 124, 255, 0.3); border-radius: 100px; font-size: 0.75rem; font-weight: 500; color: var(--accent-blue); }
    .fleet-vehicle-badge-icon { font-size: 0.9rem; }
    
    .fleet-item-card { background: var(--bg-elevated); border: 1px solid var(--border-subtle); border-radius: var(--radius-md); padding: 16px; margin-bottom: 12px; }
    .fleet-item-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
    .fleet-item-vehicle { font-weight: 600; font-size: 0.95rem; }
    .fleet-item-driver { font-size: 0.85rem; color: var(--text-secondary); margin-top: 4px; }
    .fleet-item-status { padding: 4px 10px; border-radius: 100px; font-size: 0.72rem; font-weight: 500; }
    .fleet-item-status.pending { background: var(--accent-gold-soft); color: var(--accent-gold); }
    .fleet-item-status.scheduled { background: var(--accent-blue-soft); color: var(--accent-blue); }
    .fleet-item-status.in_progress { background: rgba(168, 85, 247, 0.15); color: #a855f7; }
    .fleet-item-status.completed { background: var(--accent-green-soft); color: var(--accent-green); }
    .fleet-item-status.skipped { background: rgba(239, 95, 95, 0.15); color: var(--accent-red); }
    .fleet-item-meta { display: flex; gap: 16px; flex-wrap: wrap; font-size: 0.82rem; color: var(--text-muted); margin-bottom: 12px; }
    .fleet-item-actions { display: flex; gap: 8px; flex-wrap: wrap; }
    
    .fleet-bulk-actions { display: flex; gap: 12px; flex-wrap: wrap; padding: 16px; background: var(--bg-elevated); border: 1px solid var(--border-subtle); border-radius: var(--radius-md); margin-bottom: 20px; }
    
    .fleet-bid-calculator { background: var(--bg-elevated); border: 1px solid var(--border-subtle); border-radius: var(--radius-md); padding: 20px; margin-bottom: 20px; }
    .fleet-bid-row { display: flex; justify-content: space-between; align-items: center; padding: 12px 0; border-bottom: 1px solid var(--border-subtle); }
    .fleet-bid-row:last-child { border-bottom: none; }
    .fleet-bid-total { font-size: 1.4rem; font-weight: 700; color: var(--accent-gold); }
    
    .fleet-report-summary { display: grid; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: 16px; margin-bottom: 24px; }
    .fleet-report-stat { background: var(--bg-elevated); border: 1px solid var(--border-subtle); border-radius: var(--radius-md); padding: 20px; text-align: center; }
    .fleet-report-stat-value { font-size: 1.6rem; font-weight: 600; color: var(--accent-gold); margin-bottom: 4px; }
    .fleet-report-stat-label { font-size: 0.82rem; color: var(--text-muted); }
    
    .fleet-tabs { display: flex; gap: 8px; margin-bottom: 24px; flex-wrap: wrap; }
    .fleet-tab { padding: 10px 20px; background: var(--bg-input); border: 1px solid var(--border-subtle); border-radius: var(--radius-md); cursor: pointer; font-size: 0.88rem; color: var(--text-secondary); transition: all 0.15s; }
    .fleet-tab:hover { border-color: var(--accent-gold); color: var(--text-primary); }
    .fleet-tab.active { background: var(--accent-gold-soft); border-color: var(--accent-gold); color: var(--accent-gold); }
    
    .fleet-section { display: none; }
    .fleet-section.active { display: block; }
    
    /* Document Expiration Badges */
    .expiration-badge { display: inline-flex; align-items: center; gap: 4px; padding: 4px 10px; border-radius: 100px; font-size: 0.72rem; font-weight: 500; margin-left: 8px; }
    .expiration-badge.valid { background: var(--accent-green-soft); color: var(--accent-green); }
    .expiration-badge.expiring-soon { background: var(--accent-orange); color: #0a0a0f; animation: pulse 2s infinite; }
    .expiration-badge.expired { background: var(--accent-red); color: #fff; }
    .expiration-warning { display: flex; align-items: center; gap: 8px; padding: 12px 16px; background: rgba(239, 95, 95, 0.1); border: 1px solid rgba(239, 95, 95, 0.3); border-radius: var(--radius-md); margin-bottom: 16px; font-size: 0.9rem; color: var(--accent-red); }
    .expiration-warning.warning { background: rgba(245, 158, 11, 0.1); border-color: rgba(245, 158, 11, 0.3); color: var(--accent-orange); }

    /* Walk-In POS Styles */
    .pos-container { max-width: 900px; margin: 0 auto; position: relative; }
    .pos-stepper { display: flex; justify-content: space-between; margin-bottom: 32px; padding: 20px; background: var(--bg-card); border: 1px solid var(--border-subtle); border-radius: var(--radius-lg); position: relative; overflow: hidden; }
    .pos-stepper-line { position: absolute; top: 50%; left: 60px; right: 60px; height: 4px; background: var(--border-subtle); transform: translateY(-50%); z-index: 0; border-radius: 2px; }
    .pos-stepper-line-fill { position: absolute; top: 50%; left: 60px; height: 4px; background: linear-gradient(90deg, var(--accent-green), #c9a227); transform: translateY(-50%); z-index: 1; border-radius: 2px; transition: width 0.4s ease; width: 0%; }
    .pos-step { display: flex; flex-direction: column; align-items: center; gap: 8px; z-index: 2; background: var(--bg-card); padding: 0 12px; flex: 1; position: relative; }
    .pos-step-circle { width: 52px; height: 52px; border-radius: 50%; background: var(--bg-input); border: 3px solid var(--border-subtle); display: flex; align-items: center; justify-content: center; font-size: 18px; font-weight: 600; color: var(--text-muted); transition: all 0.3s ease; }
    .pos-step.active .pos-step-circle { background: linear-gradient(135deg, #c9a227, #d4a855); border-color: #c9a227; color: #0a0a0f; box-shadow: 0 4px 16px rgba(201, 162, 39, 0.4); }
    .pos-step.completed .pos-step-circle { background: var(--accent-green); border-color: var(--accent-green); color: #fff; }
    .pos-step-label { font-size: 0.85rem; color: var(--text-muted); text-align: center; font-weight: 500; }
    .pos-step.active .pos-step-label { color: #c9a227; }
    .pos-step.completed .pos-step-label { color: var(--accent-green); }
    .pos-step-content { display: none; }
    .pos-step-content.active { display: block; }
    .pos-card { background: var(--bg-card); border: 1px solid var(--border-subtle); border-radius: var(--radius-lg); padding: 32px; margin-bottom: 24px; }
    .pos-input { width: 100%; padding: 20px 22px; background: var(--bg-input); border: 2px solid var(--border-subtle); border-radius: var(--radius-md); color: var(--text-primary); font-family: inherit; font-size: 1.15rem; transition: all 0.2s; min-height: 60px; }
    .pos-input:focus { outline: none; border-color: #c9a227; box-shadow: 0 0 0 3px rgba(201, 162, 39, 0.15); }
    .pos-input::placeholder { color: var(--text-muted); font-size: 1.1rem; }
    .pos-input-lg { font-size: 1.6rem; padding: 26px; text-align: center; letter-spacing: 4px; min-height: 80px; }
    .pos-input-hint { font-size: 0.9rem; color: var(--text-muted); margin-top: 10px; text-align: center; }
    .pos-btn { display: inline-flex; align-items: center; justify-content: center; gap: 10px; padding: 20px 40px; font-family: inherit; font-size: 1.15rem; font-weight: 600; border: none; border-radius: var(--radius-md); cursor: pointer; transition: all 0.2s ease; min-height: 56px; position: relative; }
    .pos-btn-primary { background: linear-gradient(135deg, #c9a227, #d4a855); color: #0a0a0f; }
    .pos-btn-primary:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(201, 162, 39, 0.35); }
    .pos-btn-primary:disabled { opacity: 0.6; cursor: not-allowed; transform: none; }
    .pos-btn-secondary { background: var(--bg-elevated); color: var(--text-primary); border: 2px solid var(--border-subtle); min-height: 56px; }
    .pos-btn-secondary:hover { border-color: #c9a227; }
    .pos-btn-success { background: linear-gradient(135deg, var(--accent-green), #5fd9a0); color: #0a0a0f; }
    .pos-btn-ghost { background: transparent; color: var(--text-secondary); border: 1px solid var(--border-subtle); min-height: 48px; padding: 12px 20px; font-size: 0.95rem; }
    .pos-btn-ghost:hover { border-color: #c9a227; color: #c9a227; }
    .pos-label { display: block; font-size: 1.05rem; font-weight: 500; margin-bottom: 12px; color: var(--text-secondary); }
    .pos-form-group { margin-bottom: 24px; }
    .pos-form-row { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; }
    .pos-vehicle-card { background: var(--bg-elevated); border: 2px solid var(--border-subtle); border-radius: var(--radius-md); padding: 24px; cursor: pointer; transition: all 0.2s; margin-bottom: 12px; min-height: 80px; }
    .pos-vehicle-card:hover { border-color: #c9a227; }
    .pos-vehicle-card.selected { border-color: #c9a227; background: rgba(201, 162, 39, 0.1); box-shadow: 0 0 0 3px rgba(201, 162, 39, 0.15); }
    .pos-vehicle-title { font-size: 1.15rem; font-weight: 600; margin-bottom: 4px; }
    .pos-vehicle-meta { font-size: 0.95rem; color: var(--text-muted); }
    .pos-summary-row { display: flex; justify-content: space-between; align-items: center; padding: 16px 0; border-bottom: 1px solid var(--border-subtle); font-size: 1rem; }
    .pos-summary-row:last-child { border-bottom: none; }
    .pos-summary-row.total { font-size: 1.3rem; font-weight: 700; color: #c9a227; border-top: 2px solid var(--border-subtle); margin-top: 12px; padding-top: 20px; }
    .pos-otp-display { background: linear-gradient(135deg, rgba(201, 162, 39, 0.2), rgba(201, 162, 39, 0.08)); border: 3px solid #c9a227; border-radius: var(--radius-lg); padding: 32px; text-align: center; margin: 20px 0; box-shadow: 0 4px 20px rgba(201, 162, 39, 0.15); }
    .pos-otp-code { font-size: 3.5rem; font-weight: 700; letter-spacing: 12px; color: #c9a227; font-family: monospace; text-shadow: 0 2px 10px rgba(201, 162, 39, 0.3); }
    .pos-otp-hint { font-size: 1rem; color: var(--text-muted); margin-top: 12px; }
    .pos-otp-resend { margin-top: 16px; }
    .pos-history-card { background: var(--bg-elevated); border: 1px solid var(--border-subtle); border-radius: var(--radius-md); padding: 16px 20px; margin-bottom: 12px; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 12px; }
    .pos-history-info { flex: 1; min-width: 200px; }
    .pos-history-customer { font-weight: 600; font-size: 1rem; }
    .pos-history-vehicle { font-size: 0.88rem; color: var(--text-muted); }
    .pos-history-amount { font-size: 1.2rem; font-weight: 700; color: #c9a227; }
    .pos-history-date { font-size: 0.82rem; color: var(--text-muted); }
    .pos-status-badge { padding: 6px 14px; border-radius: 100px; font-size: 0.78rem; font-weight: 500; }
    .pos-status-badge.completed { background: var(--accent-green-soft); color: var(--accent-green); }
    .pos-status-badge.pending { background: var(--accent-gold-soft); color: var(--accent-gold); }
    .pos-status-badge.failed { background: rgba(239, 95, 95, 0.15); color: var(--accent-red); }
    #pos-stripe-element { padding: 20px 22px; background: var(--bg-input); border: 2px solid var(--border-subtle); border-radius: var(--radius-md); min-height: 70px; }
    .pos-loading { pointer-events: none; position: relative; }
    .pos-loading::after { content: ''; position: absolute; inset: 0; background: rgba(10, 10, 15, 0.5); border-radius: inherit; }
    .pos-spinner { display: inline-block; width: 22px; height: 22px; border: 3px solid transparent; border-top-color: currentColor; border-radius: 50%; animation: pos-spin 0.8s linear infinite; }
    @keyframes pos-spin { to { transform: rotate(360deg); } }
    .pos-quick-services { display: flex; flex-wrap: wrap; gap: 10px; margin-bottom: 24px; }
    .pos-quick-btn { padding: 14px 20px; background: var(--bg-elevated); border: 2px solid var(--border-subtle); border-radius: var(--radius-md); cursor: pointer; transition: all 0.2s; font-size: 0.95rem; font-weight: 500; color: var(--text-primary); min-height: 56px; display: flex; flex-direction: column; align-items: center; gap: 4px; flex: 1; min-width: 140px; }
    .pos-quick-btn:hover { border-color: #c9a227; background: rgba(201, 162, 39, 0.08); }
    .pos-quick-btn-price { color: #c9a227; font-weight: 600; font-size: 1.1rem; }
    .pos-signature-container { background: var(--bg-input); border: 2px solid var(--border-subtle); border-radius: var(--radius-md); padding: 4px; margin-bottom: 16px; }
    .pos-signature-container.has-signature { border-color: var(--accent-green); }
    .pos-signature-canvas { width: 100%; height: 200px; border-radius: var(--radius-sm); background: #fff; cursor: crosshair; touch-action: none; }
    .pos-signature-actions { display: flex; gap: 12px; margin-top: 12px; }
    .pos-waiver-box { background: var(--bg-elevated); border: 1px solid var(--border-subtle); border-radius: var(--radius-md); padding: 20px; margin-bottom: 24px; max-height: 200px; overflow-y: auto; }
    .pos-waiver-text { font-size: 0.9rem; line-height: 1.7; color: var(--text-secondary); }
    .pos-auth-summary { background: linear-gradient(135deg, rgba(201, 162, 39, 0.1), rgba(201, 162, 39, 0.05)); border: 1px solid rgba(201, 162, 39, 0.3); border-radius: var(--radius-md); padding: 16px; margin-bottom: 24px; }
    .pos-auth-row { display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid rgba(148, 148, 168, 0.1); }
    .pos-auth-row:last-child { border-bottom: none; }
    .pos-auth-label { color: var(--text-muted); font-size: 0.9rem; }
    .pos-auth-value { font-weight: 500; font-size: 0.95rem; }
    .pos-authorized-badge { display: inline-flex; align-items: center; gap: 6px; background: var(--accent-green-soft); color: var(--accent-green); padding: 4px 12px; border-radius: 100px; font-size: 0.8rem; font-weight: 500; }
    .pos-success-animation { animation: pos-success-pop 0.6s ease-out; }
    @keyframes pos-success-pop { 0% { transform: scale(0.5); opacity: 0; } 50% { transform: scale(1.1); } 100% { transform: scale(1); opacity: 1; } }
    .pos-success-checkmark { font-size: 5rem; margin-bottom: 16px; animation: pos-checkmark 0.5s ease-in-out 0.3s both; }
    @keyframes pos-checkmark { 0% { transform: scale(0) rotate(-45deg); opacity: 0; } 100% { transform: scale(1) rotate(0); opacity: 1; } }
    .pos-confetti { position: absolute; width: 10px; height: 10px; border-radius: 2px; }
    @keyframes confetti-fall { 0% { transform: translateY(0) rotate(0deg); opacity: 1; } 100% { transform: translateY(400px) rotate(720deg); opacity: 0; } }
    @media (max-width: 768px) { .pos-stepper { flex-wrap: wrap; gap: 8px; } .pos-step { flex-basis: 48%; } .pos-step-label { font-size: 0.78rem; } .pos-btn { width: 100%; } .pos-quick-btn { min-width: 100%; } .pos-otp-code { font-size: 2.5rem; letter-spacing: 8px; } }

    /* POS Integration Styles */
    .integration-card { background: var(--bg-card); border: 1px solid var(--border-subtle); border-radius: var(--radius-lg); padding: 24px; margin-bottom: 20px; transition: all 0.2s ease; }
    .integration-card:hover { border-color: var(--accent-gold); box-shadow: 0 4px 20px rgba(212, 168, 85, 0.1); }
    .integration-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; flex-wrap: wrap; gap: 12px; }
    .integration-logo { height: 48px; width: auto; margin-right: 12px; }
    .integration-logo-placeholder { display: flex; align-items: center; gap: 12px; font-size: 1.3rem; font-weight: 600; color: var(--accent-gold); }
    .integration-logo-placeholder span { font-size: 2rem; }
    .integration-status .status-badge { display: inline-flex; align-items: center; gap: 6px; padding: 6px 14px; border-radius: 100px; font-size: 0.82rem; font-weight: 500; }
    .integration-status .status-badge.connected { background: var(--accent-green-soft); color: var(--accent-green); }
    .integration-status .status-badge.disconnected { background: rgba(107, 107, 122, 0.2); color: var(--text-muted); }
    .integration-status .status-badge::before { content: ''; width: 8px; height: 8px; border-radius: 50%; }
    .integration-status .status-badge.connected::before { background: var(--accent-green); }
    .integration-status .status-badge.disconnected::before { background: var(--text-muted); }
    .integration-benefits { margin-bottom: 24px; padding: 20px; background: var(--bg-elevated); border: 1px solid var(--border-subtle); border-radius: var(--radius-md); }
    .integration-benefits h4 { font-size: 1rem; font-weight: 600; margin-bottom: 12px; color: var(--text-primary); }
    .integration-benefits ul { list-style: none; padding: 0; margin: 0; }
    .integration-benefits ul li { display: flex; align-items: center; gap: 10px; padding: 8px 0; font-size: 0.9rem; color: var(--text-secondary); border-bottom: 1px solid var(--border-subtle); }
    .integration-benefits ul li:last-child { border-bottom: none; }
    .integration-benefits ul li::before { content: 'âœ“'; color: var(--accent-green); font-weight: 600; }
    .integration-actions { display: flex; gap: 12px; flex-wrap: wrap; margin-bottom: 20px; }
    .integration-connection-info { background: var(--bg-elevated); border: 1px solid var(--border-subtle); border-radius: var(--radius-md); padding: 16px; margin-bottom: 20px; }
    .integration-connection-info p { display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid var(--border-subtle); font-size: 0.9rem; color: var(--text-secondary); }
    .integration-connection-info p:last-child { border-bottom: none; }
    .integration-connection-info p span { font-weight: 500; color: var(--text-primary); }
    .transactions-table { width: 100%; border-collapse: collapse; margin-top: 16px; }
    .transactions-table th, .transactions-table td { padding: 12px 16px; text-align: left; border-bottom: 1px solid var(--border-subtle); font-size: 0.88rem; }
    .transactions-table th { background: var(--bg-elevated); color: var(--text-muted); font-weight: 500; text-transform: uppercase; font-size: 0.75rem; letter-spacing: 0.05em; }
    .transactions-table td { color: var(--text-secondary); }
    .transactions-table tbody tr:hover { background: rgba(212, 168, 85, 0.05); }
    .transactions-table .amount { font-weight: 600; color: var(--accent-gold); }
    .transactions-table .status-success { color: var(--accent-green); }
    .transactions-table .status-pending { color: var(--accent-orange); }
    .transactions-table .status-failed { color: var(--accent-red); }
    .view-all-link { display: inline-block; margin-top: 16px; color: var(--accent-blue); font-size: 0.88rem; text-decoration: none; font-weight: 500; }
    .view-all-link:hover { text-decoration: underline; }
    .clover-sync-spinner { display: inline-block; width: 16px; height: 16px; border: 2px solid transparent; border-top-color: currentColor; border-radius: 50%; animation: pos-spin 0.8s linear infinite; margin-right: 8px; }
    .pos-sync-spinner { display: inline-block; width: 16px; height: 16px; border: 2px solid transparent; border-top-color: currentColor; border-radius: 50%; animation: pos-spin 0.8s linear infinite; margin-right: 8px; }
    .pos-integrations-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 20px; margin-bottom: 24px; }
    .pos-integration-card { background: var(--bg-card); border: 1px solid var(--border-subtle); border-radius: var(--radius-lg); padding: 24px; transition: all 0.2s ease; }
    .pos-integration-card:hover { border-color: var(--accent-gold); box-shadow: 0 4px 20px rgba(212, 168, 85, 0.1); }
    .pos-integration-card.connected { border-color: var(--accent-green); }
    .pos-card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; }
    .pos-provider-logo { display: flex; align-items: center; gap: 12px; }
    .pos-provider-icon { width: 48px; height: 48px; border-radius: var(--radius-md); display: flex; align-items: center; justify-content: center; font-size: 1.8rem; }
    .pos-provider-icon.clover { background: linear-gradient(135deg, #4caf50, #2e7d32); }
    .pos-provider-icon.square { background: linear-gradient(135deg, #006aff, #0047ab); }
    .pos-provider-name { font-size: 1.1rem; font-weight: 600; }
    .pos-provider-subtitle { font-size: 0.82rem; color: var(--text-muted); }
    .pos-connection-badge { display: inline-flex; align-items: center; gap: 6px; padding: 6px 14px; border-radius: 100px; font-size: 0.82rem; font-weight: 500; }
    .pos-connection-badge.connected { background: var(--accent-green-soft); color: var(--accent-green); }
    .pos-connection-badge.disconnected { background: rgba(107, 107, 122, 0.2); color: var(--text-muted); }
    .pos-connection-badge::before { content: ''; width: 8px; height: 8px; border-radius: 50%; }
    .pos-connection-badge.connected::before { background: var(--accent-green); }
    .pos-connection-badge.disconnected::before { background: var(--text-muted); }
    .pos-card-stats { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 16px; padding: 16px; background: var(--bg-elevated); border-radius: var(--radius-md); }
    .pos-stat { text-align: center; }
    .pos-stat-value { font-size: 1.3rem; font-weight: 600; color: var(--accent-gold); }
    .pos-stat-label { font-size: 0.78rem; color: var(--text-muted); }
    .pos-card-actions { display: flex; gap: 8px; flex-wrap: wrap; }
    .pos-card-info { margin-top: 16px; padding: 12px; background: var(--bg-elevated); border-radius: var(--radius-md); font-size: 0.85rem; color: var(--text-secondary); }
    .pos-card-info-row { display: flex; justify-content: space-between; padding: 6px 0; border-bottom: 1px solid var(--border-subtle); }
    .pos-card-info-row:last-child { border-bottom: none; }
    .pos-card-info-row span:last-child { font-weight: 500; color: var(--text-primary); }
    .all-pos-transactions { background: var(--bg-card); border: 1px solid var(--border-subtle); border-radius: var(--radius-lg); padding: 24px; margin-top: 24px; }
    .pos-tx-source-badge { display: inline-flex; align-items: center; gap: 4px; padding: 2px 8px; border-radius: 100px; font-size: 0.72rem; font-weight: 500; }
    .pos-tx-source-badge.clover { background: rgba(76, 175, 80, 0.15); color: #4caf50; }
    .pos-tx-source-badge.square { background: rgba(0, 106, 255, 0.15); color: #006aff; }

    /* Bid Calculator Styles */
    .bid-calculator-toggle { display: flex; align-items: center; justify-content: center; gap: 10px; padding: 14px 20px; background: linear-gradient(135deg, var(--accent-gold-soft), rgba(212, 168, 85, 0.08)); border: 1px dashed var(--accent-gold); border-radius: var(--radius-md); cursor: pointer; font-size: 0.95rem; font-weight: 500; color: var(--accent-gold); transition: all 0.2s; margin-bottom: 20px; }
    .bid-calculator-toggle:hover { background: linear-gradient(135deg, rgba(212, 168, 85, 0.2), rgba(212, 168, 85, 0.12)); border-style: solid; }
    .bid-calculator-toggle.active { border-style: solid; background: linear-gradient(135deg, rgba(212, 168, 85, 0.25), rgba(212, 168, 85, 0.15)); }
    .bid-calculator-toggle .toggle-icon { transition: transform 0.3s; }
    .bid-calculator-toggle.active .toggle-icon { transform: rotate(180deg); }
    .bid-calculator-container { display: none; background: var(--bg-card); border: 1px solid var(--border-medium); border-radius: var(--radius-lg); padding: 20px; margin-bottom: 24px; animation: calcSlideIn 0.3s ease; }
    .bid-calculator-container.active { display: block; }
    @keyframes calcSlideIn { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
    .calc-section { margin-bottom: 20px; }
    .calc-section-title { font-size: 0.82rem; font-weight: 600; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.08em; margin-bottom: 12px; display: flex; align-items: center; gap: 8px; }
    .calc-row { display: flex; gap: 12px; align-items: center; margin-bottom: 12px; flex-wrap: wrap; }
    .calc-input-group { display: flex; align-items: center; background: var(--bg-input); border: 1px solid var(--border-subtle); border-radius: var(--radius-md); overflow: hidden; flex: 1; min-width: 120px; }
    .calc-input-group:focus-within { border-color: var(--border-focus); }
    .calc-input-prefix { padding: 10px 12px; color: var(--text-muted); font-size: 0.9rem; background: var(--bg-elevated); border-right: 1px solid var(--border-subtle); font-weight: 500; }
    .calc-input-suffix { padding: 10px 12px; color: var(--text-muted); font-size: 0.82rem; background: var(--bg-elevated); border-left: 1px solid var(--border-subtle); white-space: nowrap; }
    .calc-input { flex: 1; padding: 10px 12px; background: transparent; border: none; color: var(--text-primary); font-size: 0.92rem; min-width: 60px; }
    .calc-input:focus { outline: none; }
    .calc-input::-webkit-inner-spin-button { -webkit-appearance: none; }
    .calc-multiply { color: var(--text-muted); font-size: 1.2rem; padding: 0 4px; }
    .calc-slider-container { flex: 1; min-width: 200px; }
    .calc-slider { width: 100%; height: 6px; -webkit-appearance: none; appearance: none; background: var(--bg-elevated); border-radius: 3px; outline: none; cursor: pointer; }
    .calc-slider::-webkit-slider-thumb { -webkit-appearance: none; width: 20px; height: 20px; background: linear-gradient(135deg, var(--accent-gold), #c49a45); border-radius: 50%; cursor: pointer; box-shadow: 0 2px 8px rgba(212, 168, 85, 0.4); }
    .calc-slider-value { min-width: 50px; text-align: center; font-weight: 600; color: var(--accent-gold); font-size: 1rem; }
    .calc-optional-row { display: flex; align-items: center; gap: 12px; padding: 10px 14px; background: var(--bg-input); border: 1px solid var(--border-subtle); border-radius: var(--radius-md); margin-bottom: 10px; transition: all 0.2s; }
    .calc-optional-row:has(input[type="checkbox"]:checked) { border-color: var(--accent-gold); background: var(--accent-gold-soft); }
    .calc-optional-row input[type="checkbox"] { width: 18px; height: 18px; accent-color: var(--accent-gold); cursor: pointer; flex-shrink: 0; }
    .calc-optional-label { flex: 1; font-size: 0.9rem; cursor: pointer; }
    .calc-optional-input { width: 100px; padding: 8px 10px; background: var(--bg-elevated); border: 1px solid var(--border-subtle); border-radius: var(--radius-sm); color: var(--text-primary); font-size: 0.9rem; opacity: 0.5; pointer-events: none; }
    .calc-optional-row:has(input[type="checkbox"]:checked) .calc-optional-input { opacity: 1; pointer-events: auto; }
    .calc-toggle-switch { position: relative; width: 50px; height: 26px; flex-shrink: 0; }
    .calc-toggle-switch input { opacity: 0; width: 0; height: 0; }
    .calc-toggle-slider { position: absolute; inset: 0; background: var(--bg-elevated); border-radius: 26px; cursor: pointer; transition: 0.3s; border: 1px solid var(--border-subtle); }
    .calc-toggle-slider::before { content: ''; position: absolute; height: 20px; width: 20px; left: 2px; bottom: 2px; background: var(--text-muted); border-radius: 50%; transition: 0.3s; }
    .calc-toggle-switch input:checked + .calc-toggle-slider { background: var(--accent-gold); border-color: var(--accent-gold); }
    .calc-toggle-switch input:checked + .calc-toggle-slider::before { transform: translateX(24px); background: #0a0a0f; }
    .calc-urgency-row { display: flex; align-items: center; justify-content: space-between; padding: 12px 16px; background: var(--bg-input); border: 1px solid var(--border-subtle); border-radius: var(--radius-md); }
    .calc-urgency-row.active { border-color: var(--accent-red); background: rgba(239, 95, 95, 0.1); }
    .calc-urgency-label { display: flex; align-items: center; gap: 10px; font-size: 0.9rem; }
    .calc-urgency-badge { padding: 3px 8px; background: rgba(239, 95, 95, 0.15); color: var(--accent-red); border-radius: 100px; font-size: 0.75rem; font-weight: 500; }
    .calc-breakdown { background: var(--bg-elevated); border: 1px solid var(--border-subtle); border-radius: var(--radius-md); padding: 16px 20px; margin-top: 20px; font-family: 'Outfit', monospace; }
    .calc-breakdown-row { display: flex; justify-content: space-between; padding: 6px 0; font-size: 0.88rem; color: var(--text-secondary); }
    .calc-breakdown-row.highlight { color: var(--text-primary); font-weight: 500; }
    .calc-breakdown-row.add { color: var(--accent-gold); }
    .calc-breakdown-row .label-detail { font-size: 0.78rem; color: var(--text-muted); margin-left: 4px; }
    .calc-breakdown-divider { border: none; border-top: 1px dashed var(--border-medium); margin: 10px 0; }
    .calc-breakdown-total { display: flex; justify-content: space-between; padding: 12px 0 8px; font-size: 1.15rem; font-weight: 700; color: var(--accent-gold); border-top: 2px solid var(--accent-gold); margin-top: 10px; }
    .calc-breakdown-fee { display: flex; justify-content: space-between; padding: 4px 0; font-size: 0.8rem; color: var(--text-muted); }
    .calc-breakdown-net { display: flex; justify-content: space-between; padding: 8px 0; font-size: 1rem; font-weight: 600; color: var(--accent-green); }
    .calc-competition { background: linear-gradient(135deg, var(--accent-blue-soft), rgba(74, 124, 255, 0.05)); border: 1px solid rgba(74, 124, 255, 0.3); border-radius: var(--radius-md); padding: 16px 20px; margin-top: 16px; }
    .calc-competition-title { font-size: 0.85rem; font-weight: 600; color: var(--accent-blue); margin-bottom: 12px; display: flex; align-items: center; gap: 8px; }
    .calc-competition-stats { display: flex; gap: 20px; flex-wrap: wrap; margin-bottom: 12px; font-size: 0.88rem; color: var(--text-secondary); }
    .calc-competition-stat { display: flex; align-items: center; gap: 6px; }
    .calc-competition-stat strong { color: var(--text-primary); }
    .calc-gauge { height: 8px; background: var(--bg-elevated); border-radius: 4px; position: relative; overflow: visible; margin-top: 8px; }
    .calc-gauge-fill { height: 100%; border-radius: 4px; transition: width 0.3s, background 0.3s; }
    .calc-gauge-fill.low { background: linear-gradient(90deg, var(--accent-green), #22c55e); }
    .calc-gauge-fill.competitive { background: linear-gradient(90deg, var(--accent-gold), #f59e0b); }
    .calc-gauge-fill.high { background: linear-gradient(90deg, #f97316, var(--accent-red)); }
    .calc-gauge-marker { position: absolute; top: -6px; width: 20px; height: 20px; background: var(--text-primary); border: 3px solid var(--bg-deep); border-radius: 50%; transform: translateX(-50%); box-shadow: 0 2px 8px rgba(0,0,0,0.3); transition: left 0.3s; }
    .calc-gauge-labels { display: flex; justify-content: space-between; margin-top: 6px; font-size: 0.72rem; color: var(--text-muted); }
    .calc-gauge-position { text-align: center; margin-top: 8px; font-size: 0.85rem; font-weight: 500; }
    .calc-gauge-position.low { color: var(--accent-green); }
    .calc-gauge-position.competitive { color: var(--accent-gold); }
    .calc-gauge-position.high { color: var(--accent-red); }
    .calc-apply-btn { width: 100%; padding: 14px 20px; background: linear-gradient(135deg, var(--accent-gold), #c49a45); color: #0a0a0f; border: none; border-radius: var(--radius-md); font-size: 0.95rem; font-weight: 600; cursor: pointer; margin-top: 16px; display: flex; align-items: center; justify-content: center; gap: 8px; transition: all 0.2s; }
    .calc-apply-btn:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(212, 168, 85, 0.35); }
    @media (max-width: 600px) { .calc-row { flex-direction: column; align-items: stretch; } .calc-input-group { min-width: 100%; } .calc-multiply { display: none; } .calc-slider-container { min-width: 100%; } }
  </style>
  <script src="/i18n.js"></script>
</head>
<body>
  <div class="sidebar-overlay" id="sidebar-overlay" onclick="toggleSidebar()" style="display:none;position:fixed;inset:0;background:rgba(0,0,0,0.5);z-index:40;"></div>
  <aside class="sidebar" id="sidebar">
    <div class="mobile-close" onclick="toggleSidebar()" style="display:none;position:absolute;top:16px;right:16px;width:36px;height:36px;background:var(--bg-elevated);border:1px solid var(--border-subtle);border-radius:50%;cursor:pointer;font-size:1.2rem;align-items:center;justify-content:center;">âœ•</div>
    <div style="display:flex;align-items:center;justify-content:space-between;padding:0 8px 16px;">
      <a href="index.html" class="sidebar-brand" style="padding:8px 4px 8px;margin-bottom:0;border-bottom:none;">
        <img src="logo.png" alt="My Car Concierge" class="sidebar-brand-icon">
      </a>
      <button class="theme-toggle" id="theme-toggle-btn" onclick="toggleTheme()" title="Toggle theme">
        <span id="theme-icon">ðŸŒ™</span>
      </button>
    </div>
    <div id="language-switcher" style="padding:0 12px 16px;"></div>
    <div class="nav-label">Provider Portal</div>
    <div class="nav-item active" data-section="overview">ðŸ“Š Dashboard</div>
    <div class="nav-item" data-section="subscription">ðŸŽŸï¸ Bid Credits <span class="nav-badge" id="sub-badge" style="display:none;"></span></div>
    <div class="nav-item" data-section="browse">ðŸ“¦ Browse Packages <span class="nav-badge" id="open-count">0</span></div>
    <div class="nav-item" data-section="bids">ðŸ’¬ My Bids</div>
    <div class="nav-item" data-section="jobs">âœ“ Active Jobs</div>
    <div class="nav-item" data-section="emergencies">ðŸš¨ Emergency Queue <span class="nav-badge emergency" id="emergency-count" style="display:none;">0</span></div>
    <div class="nav-item" data-section="fleet-services">ðŸ¢ Fleet Services <span class="nav-badge" id="fleet-count" style="display:none;background:var(--accent-gold);">0</span></div>
    <div class="nav-item pos-feature" data-section="walkin-pos" style="display:none;">ðŸ›’ Walk-In POS</div>
    <div class="nav-item pos-feature" data-section="pos-analytics" style="display:none;">ðŸ“ˆ POS Analytics</div>
    <div class="nav-item" data-section="customer-queue">ðŸ“‹ Customer Queue <span class="nav-badge" id="queue-count" style="display:none;background:var(--accent-orange);">0</span></div>
    <div class="nav-item" data-section="earnings">ðŸ’° Earnings</div>
    <div class="nav-item" data-section="earnings-analytics">ðŸ“Š Earnings Analytics</div>
    <div class="nav-item" data-section="reviews">â­ My Reviews</div>
    <div class="nav-item" data-section="performance">ðŸ“ˆ Performance</div>
    <div class="nav-item" data-section="messages">ðŸ’¬ Messages</div>
    <div class="nav-item" data-section="notifications">ðŸ”” Notifications <span class="nav-badge" id="notif-count" style="display:none;background:var(--accent-red);">0</span></div>
    
    <div class="nav-label">Settings</div>
    <div class="nav-item" data-section="profile">âš™ï¸ Business Profile</div>
    <div class="nav-item" data-section="team">ðŸ‘¥ Team Members</div>
    <div class="nav-item team-management-nav" data-section="team-section" style="display:none;">ðŸ‘¤ Team</div>
    <div class="nav-item" data-section="background-checks">ðŸ›¡ï¸ Background Checks</div>
    <div class="nav-item pos-feature" data-section="pos-integration" style="display:none;">ðŸ”— POS Integration</div>
    
    <div class="nav-label">Earn More</div>
    <div class="nav-item" data-section="refer-providers">ðŸ¤ Refer Providers</div>
    <div class="nav-item" data-section="loyalty-network">ðŸ‘¥ Loyalty Network <span class="nav-badge" id="loyalty-count" style="display:none;background:var(--accent-gold);">0</span></div>
    <div class="sidebar-footer">
      <div id="realtime-status" style="padding:8px 12px;margin-bottom:8px;font-size:0.75rem;display:flex;align-items:center;gap:6px;color:var(--text-muted);">
        <span id="realtime-dot" style="width:8px;height:8px;border-radius:50%;background:var(--accent-orange);"></span>
        <span id="realtime-text">Connecting...</span>
      </div>
      <div class="user-info">
        <div class="user-avatar" id="user-avatar">P</div>
        <div><div class="user-name" id="user-name">Loading...</div><div class="user-email" id="user-email">...</div></div>
      </div>
      <div id="switch-portal-container" style="display:none;background:var(--bg-elevated);border:1px solid var(--accent-blue);border-radius:var(--radius-md);padding:12px;margin-bottom:12px;">
        <div style="font-size:0.75rem;color:var(--text-muted);margin-bottom:8px;text-transform:uppercase;letter-spacing:0.05em;">Switch Portal</div>
        <button id="switch-portal-btn" class="btn" onclick="switchToMember()" style="width:100%;padding:12px 16px;font-size:0.9rem;background:linear-gradient(135deg, var(--accent-blue), #6b9fff);color:#fff;font-weight:600;border:none;">
          ðŸš— Member Portal
        </button>
        <div style="font-size:0.72rem;color:var(--text-muted);margin-top:6px;text-align:center;">You have dual access</div>
      </div>
      <button class="theme-toggle-btn" onclick="toggleTheme()" title="Toggle light/dark mode">
        <span class="theme-icon-dark">ðŸ”¦</span>
        <span class="theme-icon-light">ðŸŒ™</span>
        <span class="theme-label">Lights</span>
      </button>
      <button class="btn btn-secondary" onclick="logout()" style="width:100%;padding:14px 20px;font-size:0.95rem;">ðŸšª Log Out</button>
    </div>
  </aside>

  <main class="main">
    <div class="mobile-header">
      <button class="mobile-menu-btn" onclick="toggleSidebar()">â˜°</button>
      <span style="font-family:'Playfair Display',serif;font-weight:600;font-size:1.1rem;">Provider Dashboard</span>
    </div>

    <section id="overview" class="section active">
      <div class="page-header">
        <p class="page-subtitle" style="margin-top:4px;">Find jobs and grow your business.</p>
      </div>
      
      <!-- Bid Credits Info Card -->
      <div class="card" style="background:linear-gradient(135deg, var(--bg-card), var(--accent-gold-soft));border:1px solid var(--accent-gold);margin-bottom:24px;">
        <div style="display:flex;align-items:center;gap:20px;flex-wrap:wrap;">
          <div style="flex:1;min-width:200px;">
            <div style="display:flex;align-items:center;gap:12px;margin-bottom:8px;">
              <span style="font-size:2rem;">ðŸŽŸï¸</span>
              <div>
                <div style="font-size:0.8rem;color:var(--text-muted);text-transform:uppercase;letter-spacing:0.05em;">Your Bid Credits</div>
                <div style="font-size:1.8rem;font-weight:700;color:var(--accent-gold);" id="dashboard-bid-credits">0</div>
              </div>
            </div>
          </div>
          <div style="flex:2;min-width:280px;">
            <p style="font-size:0.9rem;color:var(--text-secondary);margin:0 0 8px 0;line-height:1.5;">
              <strong>How it works:</strong> Each bid costs 1 credit. Members see your bid and choose based on price, ratings, and reviews. Win jobs to grow your business!
            </p>
            <button class="btn btn-primary" onclick="showSection('subscription')" style="padding:10px 20px;font-size:0.9rem;">Buy More Credits â†’</button>
          </div>
        </div>
      </div>

      <div class="stats-grid">
        <div class="stat-card" onclick="showSection('subscription')" style="cursor:pointer;border:2px solid var(--accent-gold);">
          <div class="stat-icon gold">ðŸŽŸï¸</div>
          <div class="stat-value" id="stat-credits">0</div>
          <div class="stat-label">Bid Credits</div>
        </div>
        <div class="stat-card">
          <div class="stat-icon blue">ðŸ‘¥</div>
          <div class="stat-value" id="stat-members-nearby">0</div>
          <div class="stat-label">Members In Your Area</div>
        </div>
        <div class="stat-card"><div class="stat-icon gold">ðŸ“¦</div><div class="stat-value" id="stat-open">0</div><div class="stat-label">Open Packages</div></div>
        <div class="stat-card"><div class="stat-icon blue">ðŸ’¬</div><div class="stat-value" id="stat-bids">0</div><div class="stat-label">Pending Bids</div></div>
        <div class="stat-card"><div class="stat-icon green">âœ“</div><div class="stat-value" id="stat-won">0</div><div class="stat-label">Jobs Won</div></div>
        <div class="stat-card" onclick="showSection('reviews')" style="cursor:pointer;">
          <div class="stat-icon gold">â­</div>
          <div class="stat-value" id="stat-rating">--</div>
          <div class="stat-label">Your Rating <span id="stat-review-count" style="color:var(--text-muted);font-size:0.8rem;">(0 reviews)</span></div>
        </div>
      </div>
      <div class="card">
        <div class="card-header"><h2 class="card-title">Recent Opportunities</h2><button class="btn btn-ghost" onclick="showSection('browse')">View All â†’</button></div>
        <div id="recent-packages"><div class="empty-state"><div class="empty-state-icon">ðŸ“¦</div><p>Loading packages...</p></div></div>
      </div>
    </section>

    <section id="browse" class="section">
      <div class="page-header"><h1 class="page-title">Browse Packages</h1><p class="page-subtitle">Find maintenance packages to bid on.</p></div>
      
      <!-- Credits Indicator for Browse -->
      <div id="browse-credits-bar" style="background:var(--bg-card);border:1px solid var(--border-subtle);border-radius:var(--radius-lg);padding:16px 20px;margin-bottom:20px;display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:12px;">
        <div style="display:flex;align-items:center;gap:12px;">
          <span style="font-size:1.5rem;">ðŸŽŸï¸</span>
          <div>
            <span style="font-size:0.85rem;color:var(--text-muted);">Your Bid Credits:</span>
            <span style="font-size:1.2rem;font-weight:700;color:var(--accent-gold);margin-left:8px;" id="browse-credits-count">0</span>
          </div>
        </div>
        <button class="btn btn-primary btn-sm" onclick="showSection('subscription')" style="padding:10px 18px;">ðŸ›’ Buy More Credits</button>
      </div>

      <!-- Filter Bar -->
      <div class="filter-bar" style="display:flex;flex-wrap:wrap;gap:12px;margin-bottom:24px;padding:16px;background:var(--bg-card);border:1px solid var(--border-subtle);border-radius:var(--radius-lg);">
        <div class="filter-group" style="flex:1;min-width:150px;">
          <label style="font-size:0.8rem;color:var(--text-muted);display:block;margin-bottom:4px;">ðŸ“ Distance</label>
          <select class="form-input" id="filter-distance" onchange="applyFilters()" style="padding:10px 12px;">
            <option value="" selected>All Locations</option>
            <option value="10">Within 10 miles</option>
            <option value="25">Within 25 miles</option>
            <option value="50">Within 50 miles</option>
            <option value="100">Within 100 miles</option>
          </select>
        </div>
        <div class="filter-group" style="flex:1;min-width:150px;">
          <label style="font-size:0.8rem;color:var(--text-muted);display:block;margin-bottom:4px;">Category</label>
          <select class="form-input" id="filter-category" onchange="applyFilters()" style="padding:10px 12px;">
            <option value="">All Categories</option>
            <option value="maintenance">ðŸ”§ Maintenance</option>
            <option value="detailing">âœ¨ Detailing</option>
            <option value="cosmetic">ðŸŽ¨ Cosmetic</option>
            <option value="accident_repair">ðŸš— Accident Repair</option>
            <option value="other">ðŸ“¦ Other</option>
          </select>
        </div>
        <div class="filter-group" style="flex:1;min-width:150px;">
          <label style="font-size:0.8rem;color:var(--text-muted);display:block;margin-bottom:4px;">Urgency</label>
          <select class="form-input" id="filter-urgency" onchange="applyFilters()" style="padding:10px 12px;">
            <option value="">Any Deadline</option>
            <option value="urgent">âš¡ Under 24 hours</option>
            <option value="soon">â° Under 3 days</option>
            <option value="flexible">ðŸ“… More than 3 days</option>
          </select>
        </div>
        <div class="filter-group" style="flex:1;min-width:150px;">
          <label style="font-size:0.8rem;color:var(--text-muted);display:block;margin-bottom:4px;">Parts Preference</label>
          <select class="form-input" id="filter-parts" onchange="applyFilters()" style="padding:10px 12px;">
            <option value="">Any Parts</option>
            <option value="economy">ðŸ’° Economy</option>
            <option value="standard">âš™ï¸ Standard OEM</option>
            <option value="premium">â­ Premium</option>
          </select>
        </div>
        <div class="filter-group" style="flex:1;min-width:150px;">
          <label style="font-size:0.8rem;color:var(--text-muted);display:block;margin-bottom:4px;">Sort By</label>
          <select class="form-input" id="filter-sort" onchange="applyFilters()" style="padding:10px 12px;">
            <option value="nearest">Nearest First</option>
            <option value="newest">Newest First</option>
            <option value="ending">Ending Soon</option>
            <option value="oldest">Oldest First</option>
          </select>
        </div>
        <div class="filter-group" style="display:flex;align-items:flex-end;">
          <button class="btn btn-secondary btn-sm" onclick="clearFilters()">Clear Filters</button>
        </div>
      </div>

      <!-- Service Type Quick Filters -->
      <div style="display:flex;gap:8px;margin-bottom:16px;flex-wrap:wrap;align-items:center;">
        <span style="font-size:0.85rem;color:var(--text-muted);margin-right:4px;">Quick Filters:</span>
        <button class="btn btn-ghost btn-sm service-type-filter active" data-service-type="all" onclick="filterByServiceType('all')" style="font-size:0.82rem;padding:6px 12px;">All Packages</button>
        <button class="btn btn-ghost btn-sm service-type-filter" data-service-type="destination" onclick="filterByServiceType('destination')" style="font-size:0.82rem;padding:6px 12px;background:var(--accent-blue-soft);border:1px solid rgba(74,124,255,0.3);">ðŸš— Destination</button>
        <button class="btn btn-ghost btn-sm service-type-filter" data-service-type="standard" onclick="filterByServiceType('standard')" style="font-size:0.82rem;padding:6px 12px;">ðŸ”§ Standard</button>
      </div>

      <div id="location-warning" style="display:none;background:var(--accent-orange-soft);border:1px solid rgba(245,158,11,0.3);color:var(--accent-orange);padding:14px 16px;border-radius:var(--radius-md);margin-bottom:16px;">
        âš ï¸ <strong>Set your location</strong> to see packages in your service area. <a href="#" onclick="showSection('profile');return false;" style="color:inherit;text-decoration:underline;">Go to Business Profile â†’</a>
      </div>

      <div id="filter-results-info" style="margin-bottom:16px;font-size:0.9rem;color:var(--text-muted);"></div>
      <div id="open-packages">
        <div class="skeleton-loader">
          <div class="skeleton-card"><div class="skeleton-title"></div><div class="skeleton-meta"></div><div class="skeleton-text"></div><div class="skeleton-button"></div></div>
          <div class="skeleton-card"><div class="skeleton-title"></div><div class="skeleton-meta"></div><div class="skeleton-text"></div><div class="skeleton-button"></div></div>
          <div class="skeleton-card"><div class="skeleton-title"></div><div class="skeleton-meta"></div><div class="skeleton-text"></div><div class="skeleton-button"></div></div>
        </div>
      </div>
    </section>

    <section id="bids" class="section">
      <div class="page-header"><h1 class="page-title">My Bids</h1><p class="page-subtitle">Track your submitted bids.</p></div>
      <div id="my-bids"><div class="empty-state"><div class="empty-state-icon">ðŸ’¬</div><p>No bids yet.</p></div></div>
    </section>

    <section id="jobs" class="section">
      <div class="page-header"><h1 class="page-title">Active Jobs</h1><p class="page-subtitle">Packages where your bid was accepted.</p></div>
      <div id="active-jobs"><div class="empty-state"><div class="empty-state-icon">âœ“</div><p>No active jobs.</p></div></div>
    </section>

    <section id="earnings" class="section">
      <div class="page-header"><h1 class="page-title">Earnings</h1><p class="page-subtitle">Track your income and payments.</p></div>
      <div class="stats-grid" style="margin-bottom:24px;">
        <div class="stat-card"><div class="stat-value" id="earnings-pending">$0</div><div class="stat-label">Pending (In Escrow)</div></div>
        <div class="stat-card"><div class="stat-value" id="earnings-released">$0</div><div class="stat-label">Released (30 days)</div></div>
        <div class="stat-card"><div class="stat-value" id="earnings-total">$0</div><div class="stat-label">Total Earnings</div></div>
      </div>
      <div class="card">
        <div class="card-header"><h2 class="card-title">Payment History</h2></div>
        <div id="earnings-list"><div class="empty-state"><div class="empty-state-icon">ðŸ’°</div><p>No payments yet. Complete jobs to see your earnings!</p></div></div>
      </div>
      <div class="alert" style="background:var(--accent-blue-soft);border:1px solid rgba(74,124,255,0.3);color:var(--accent-blue);margin-top:16px;padding:16px;border-radius:var(--radius-md);">
        ðŸ’¡ <strong>How payments work:</strong> When a member accepts your bid, payment is held in escrow. Once the job is complete and the member confirms, the payment is released to you (minus the 7.5% MCC fee). Payments are processed within 3-5 business days.
      </div>
    </section>

    <!-- Earnings Analytics Section -->
    <section id="earnings-analytics" class="section">
      <div class="page-header">
        <h1 class="page-title">Earnings Analytics</h1>
        <p class="page-subtitle">Track your earnings breakdown over time.</p>
      </div>

      <div class="card">
        <div class="card-header" style="flex-wrap:wrap;gap:16px;">
          <div>
            <h2 class="card-title">Earnings</h2>
            <p style="font-size:0.9rem;color:var(--text-secondary);margin-top:4px;">Total earned in <span id="earnings-year-label">2025</span>: <strong id="earnings-total-label" style="color:var(--accent-gold);">$0.00</strong></p>
          </div>
          <div style="display:flex;gap:12px;flex-wrap:wrap;align-items:center;">
            <select class="form-select" id="earnings-year-filter" style="min-width:100px;"></select>
            <button class="btn btn-secondary btn-sm" onclick="downloadEarningsCSV()">ðŸ“¥ Download CSV</button>
          </div>
        </div>
        <div style="position:relative;height:350px;margin-top:20px;">
          <canvas id="earnings-chart"></canvas>
        </div>
        <div id="earnings-legend" style="display:flex;flex-wrap:wrap;gap:20px;margin-top:20px;padding-top:16px;border-top:1px solid var(--border-subtle);">
          <div style="display:flex;align-items:center;gap:8px;">
            <span style="width:12px;height:12px;border-radius:50%;background:#4a7cff;"></span>
            <span style="font-size:0.88rem;color:var(--text-secondary);">Service Revenue: <strong id="legend-revenue" style="color:var(--text-primary);">$0</strong></span>
          </div>
          <div style="display:flex;align-items:center;gap:8px;">
            <span style="width:12px;height:12px;border-radius:50%;background:#9b59b6;"></span>
            <span style="font-size:0.88rem;color:var(--text-secondary);">Tips: <strong id="legend-tips" style="color:var(--text-primary);">$0</strong></span>
          </div>
          <div style="display:flex;align-items:center;gap:8px;">
            <span style="width:12px;height:12px;border-radius:50%;background:#4ac88c;"></span>
            <span style="font-size:0.88rem;color:var(--text-secondary);">Upsells: <strong id="legend-upsells" style="color:var(--text-primary);">$0</strong></span>
          </div>
          <div style="display:flex;align-items:center;gap:8px;">
            <span style="width:12px;height:12px;border-radius:50%;background:#f59e0b;"></span>
            <span style="font-size:0.88rem;color:var(--text-secondary);">Reimbursements: <strong id="legend-reimbursements" style="color:var(--text-primary);">$0</strong></span>
          </div>
        </div>
      </div>

      <!-- Advanced Analytics Dashboard -->
      <div id="advanced-analytics-section" style="margin-top:24px;">
        <div class="card" style="margin-bottom:24px;">
          <div class="card-header" style="flex-wrap:wrap;gap:16px;">
            <div>
              <h2 class="card-title" style="display:flex;align-items:center;gap:10px;">
                <span style="color:var(--accent-gold);">ðŸ“Š</span> Revenue Trend
              </h2>
              <p style="font-size:0.9rem;color:var(--text-secondary);margin-top:4px;">Track your revenue over time with daily, weekly, or monthly views</p>
            </div>
            <div style="display:flex;gap:8px;flex-wrap:wrap;">
              <select id="revenue-period-filter" class="form-select" style="min-width:100px;">
                <option value="daily">Daily</option>
                <option value="weekly">Weekly</option>
                <option value="monthly">Monthly</option>
              </select>
              <select id="revenue-range-filter" class="form-select" style="min-width:100px;">
                <option value="30">Last 30 Days</option>
                <option value="60">Last 60 Days</option>
                <option value="90">Last 90 Days</option>
                <option value="180">Last 6 Months</option>
                <option value="365">Last Year</option>
              </select>
            </div>
          </div>
          <div id="revenue-chart-loading" style="text-align:center;padding:60px 20px;color:var(--text-secondary);display:none;">
            <div style="font-size:2rem;margin-bottom:12px;">â³</div>
            <p>Loading revenue data...</p>
          </div>
          <div id="revenue-chart-error" style="text-align:center;padding:40px 20px;color:var(--accent-red);display:none;">
            <div style="font-size:2rem;margin-bottom:12px;">âš ï¸</div>
            <p>Failed to load revenue data. <a href="javascript:loadAdvancedRevenueChart()" style="color:var(--accent-gold);">Retry</a></p>
          </div>
          <div style="position:relative;height:300px;margin-top:20px;">
            <canvas id="advanced-revenue-chart"></canvas>
          </div>
          <div style="display:flex;flex-wrap:wrap;gap:20px;margin-top:16px;padding-top:12px;border-top:1px solid var(--border-subtle);">
            <div style="display:flex;align-items:center;gap:8px;">
              <span style="width:12px;height:3px;border-radius:2px;background:#4a7cff;"></span>
              <span style="font-size:0.85rem;color:var(--text-secondary);">POS Revenue</span>
            </div>
            <div style="display:flex;align-items:center;gap:8px;">
              <span style="width:12px;height:3px;border-radius:2px;background:#d4a855;"></span>
              <span style="font-size:0.85rem;color:var(--text-secondary);">Marketplace Revenue</span>
            </div>
            <div style="display:flex;align-items:center;gap:8px;">
              <span style="width:12px;height:3px;border-radius:2px;background:#4ac88c;"></span>
              <span style="font-size:0.85rem;color:var(--text-secondary);">Tips</span>
            </div>
          </div>
        </div>

        <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(320px,1fr));gap:24px;">
          <!-- Service Category Breakdown -->
          <div class="card">
            <div class="card-header">
              <h2 class="card-title" style="display:flex;align-items:center;gap:10px;">
                <span style="color:var(--accent-gold);">ðŸ”§</span> Service Categories
              </h2>
            </div>
            <div id="services-chart-loading" style="text-align:center;padding:40px 20px;color:var(--text-secondary);display:none;">
              <div style="font-size:1.5rem;margin-bottom:8px;">â³</div>
              <p style="font-size:0.9rem;">Loading...</p>
            </div>
            <div style="position:relative;height:250px;">
              <canvas id="services-pie-chart"></canvas>
            </div>
            <div id="services-list" style="margin-top:12px;"></div>
          </div>

          <!-- Busy Hours Analysis -->
          <div class="card">
            <div class="card-header">
              <h2 class="card-title" style="display:flex;align-items:center;gap:10px;">
                <span style="color:var(--accent-gold);">â°</span> Peak Hours
              </h2>
            </div>
            <div id="busy-hours-loading" style="text-align:center;padding:40px 20px;color:var(--text-secondary);display:none;">
              <div style="font-size:1.5rem;margin-bottom:8px;">â³</div>
              <p style="font-size:0.9rem;">Loading...</p>
            </div>
            <div style="position:relative;height:250px;">
              <canvas id="busy-hours-chart"></canvas>
            </div>
            <div id="peak-times-summary" style="margin-top:12px;font-size:0.9rem;color:var(--text-secondary);"></div>
          </div>
        </div>

        <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(320px,1fr));gap:24px;margin-top:24px;">
          <!-- Customer Retention -->
          <div class="card">
            <div class="card-header">
              <h2 class="card-title" style="display:flex;align-items:center;gap:10px;">
                <span style="color:var(--accent-gold);">ðŸ‘¥</span> Customer Retention
              </h2>
            </div>
            <div id="retention-loading" style="text-align:center;padding:40px 20px;color:var(--text-secondary);display:none;">
              <div style="font-size:1.5rem;margin-bottom:8px;">â³</div>
              <p style="font-size:0.9rem;">Loading...</p>
            </div>
            <div style="position:relative;height:200px;">
              <canvas id="retention-chart"></canvas>
            </div>
            <div id="retention-stats" style="display:grid;grid-template-columns:repeat(2,1fr);gap:12px;margin-top:16px;"></div>
          </div>

          <!-- Rating Trends -->
          <div class="card">
            <div class="card-header">
              <h2 class="card-title" style="display:flex;align-items:center;gap:10px;">
                <span style="color:var(--accent-gold);">â­</span> Rating Trend
              </h2>
            </div>
            <div id="ratings-loading" style="text-align:center;padding:40px 20px;color:var(--text-secondary);display:none;">
              <div style="font-size:1.5rem;margin-bottom:8px;">â³</div>
              <p style="font-size:0.9rem;">Loading...</p>
            </div>
            <div style="position:relative;height:200px;">
              <canvas id="ratings-trend-chart"></canvas>
            </div>
            <div id="ratings-summary" style="margin-top:12px;"></div>
          </div>
        </div>
      </div>
    </section>

    <!-- Reviews Section -->
    <section id="reviews" class="section">
      <div class="page-header">
        <h1 class="page-title">My Reviews</h1>
        <p class="page-subtitle">See what members are saying about your work.</p>
      </div>

      <!-- Suspension Alert -->
      <div id="suspension-alert" style="display:none;margin-bottom:24px;padding:20px;background:rgba(239,95,95,0.15);border:1px solid rgba(239,95,95,0.4);border-radius:var(--radius-lg);">
        <div style="display:flex;align-items:flex-start;gap:16px;">
          <div style="font-size:2rem;">âš ï¸</div>
          <div style="flex:1;">
            <h3 style="color:var(--accent-red);margin-bottom:8px;">Account Suspended</h3>
            <p style="color:var(--text-secondary);margin-bottom:12px;" id="suspension-reason">Your average rating has dropped below 4 stars. You cannot place new bids until this is resolved.</p>
            <div style="font-size:0.9rem;color:var(--text-muted);margin-bottom:16px;">
              <span id="suspension-date"></span>
            </div>
            <div id="refund-info" style="display:none;padding:12px 16px;background:var(--bg-input);border-radius:var(--radius-md);margin-bottom:12px;">
              <div style="font-size:0.9rem;color:var(--text-secondary);">
                <strong>Bid Credits Refunded:</strong> <span id="refunded-credits">0</span> credits
              </div>
            </div>
            <p style="font-size:0.9rem;color:var(--text-muted);">Please contact support at <a href="mailto:support@mycarconcierge.com" style="color:var(--accent-blue);">support@mycarconcierge.com</a> to discuss next steps.</p>
          </div>
        </div>
      </div>

      <!-- CAR Submitted Status -->
      <div id="car-submitted-status" style="display:none;margin-bottom:24px;padding:20px;background:rgba(74,124,255,0.15);border:1px solid rgba(74,124,255,0.4);border-radius:var(--radius-lg);">
        <div style="display:flex;align-items:flex-start;gap:16px;">
          <div style="font-size:2rem;">ðŸ“‹</div>
          <div style="flex:1;">
            <h3 style="color:var(--accent-blue);margin-bottom:8px;">Corrective Action Response Submitted</h3>
            <p style="color:var(--text-secondary);margin-bottom:12px;">Your CAR is currently under review by our team. We will notify you once a decision has been made.</p>
            <div style="font-size:0.9rem;color:var(--text-muted);">
              <span id="car-submitted-date"></span>
            </div>
          </div>
        </div>
      </div>

      <!-- CAR Submission Form -->
      <div id="car-form-container" style="display:none;margin-bottom:24px;padding:24px;background:var(--bg-card);border:1px solid var(--accent-gold);border-radius:var(--radius-lg);">
        <div style="display:flex;align-items:center;gap:12px;margin-bottom:20px;">
          <span style="font-size:1.8rem;">ðŸ“</span>
          <div>
            <h3 style="color:var(--accent-gold);margin:0;">Corrective Action Response Required</h3>
            <p style="color:var(--text-secondary);font-size:0.9rem;margin:4px 0 0;">Complete this form to begin the reinstatement process.</p>
          </div>
        </div>

        <!-- Primary Complaint Display -->
        <div id="car-complaint-section" style="background:var(--bg-elevated);border:1px solid var(--border-subtle);border-radius:var(--radius-md);padding:16px;margin-bottom:20px;">
          <h4 style="color:var(--text-primary);font-size:0.95rem;margin-bottom:12px;">Primary Issue Identified</h4>
          <div id="car-primary-complaint" style="display:flex;align-items:center;gap:10px;padding:12px 16px;background:rgba(239,95,95,0.1);border-radius:var(--radius-sm);margin-bottom:12px;">
            <span style="font-size:1.2rem;">âš ï¸</span>
            <span id="car-complaint-label" style="color:var(--accent-red);font-weight:500;">--</span>
          </div>
          <div id="car-complaint-breakdown" style="display:none;">
            <h5 style="color:var(--text-muted);font-size:0.85rem;margin-bottom:10px;">Complaint Breakdown:</h5>
            <div id="car-breakdown-list" style="display:flex;flex-wrap:wrap;gap:8px;"></div>
          </div>
        </div>

        <!-- CAR Form Fields -->
        <form id="car-form" onsubmit="submitCAR(event)">
          <div class="form-group">
            <label class="form-label" style="color:var(--accent-gold);">Root Cause Analysis <span style="color:var(--accent-red);">*</span></label>
            <textarea id="car-root-cause" class="form-textarea" required placeholder="Explain why this issue occurred. Be specific about what led to the customer complaints." style="min-height:120px;"></textarea>
            <div class="form-hint">What factors contributed to this problem? Consider processes, communication, resources, or other relevant factors.</div>
          </div>

          <div class="form-group">
            <label class="form-label" style="color:var(--accent-gold);">Corrective Action Plan <span style="color:var(--accent-red);">*</span></label>
            <textarea id="car-corrective-action" class="form-textarea" required placeholder="Describe the specific steps you will take to address and fix this issue." style="min-height:120px;"></textarea>
            <div class="form-hint">What immediate actions will you take to resolve this problem? Include timelines if applicable.</div>
          </div>

          <div class="form-group">
            <label class="form-label" style="color:var(--accent-gold);">Preventative Action <span style="color:var(--accent-red);">*</span></label>
            <textarea id="car-preventative-action" class="form-textarea" required placeholder="Explain how you will prevent this issue from happening again in the future." style="min-height:120px;"></textarea>
            <div class="form-hint">What changes will you implement to ensure this doesn't recur? Consider training, process improvements, or quality checks.</div>
          </div>

          <div class="form-group">
            <label class="form-label">Additional Notes <span style="color:var(--text-muted);">(Optional)</span></label>
            <textarea id="car-additional-notes" class="form-textarea" placeholder="Any additional context or information you'd like to share." style="min-height:80px;"></textarea>
          </div>

          <div style="display:flex;justify-content:flex-end;gap:12px;padding-top:16px;border-top:1px solid var(--border-subtle);">
            <button type="submit" id="car-submit-btn" class="btn btn-primary">
              <span>ðŸ“¤</span> Submit Corrective Action Response
            </button>
          </div>
        </form>
      </div>

      <!-- Rating Warning (close to suspension) -->
      <div id="rating-warning" style="display:none;margin-bottom:24px;padding:16px;background:var(--accent-orange-soft);border:1px solid rgba(245,158,11,0.4);border-radius:var(--radius-lg);">
        <div style="display:flex;align-items:center;gap:12px;">
          <span style="font-size:1.5rem;">âš¡</span>
          <div>
            <strong style="color:var(--accent-orange);">Rating Warning</strong>
            <p style="color:var(--text-secondary);font-size:0.9rem;margin:4px 0 0;">Your rating is approaching the 3-star minimum. If it drops below 3 stars with 3+ reviews, your account will be suspended and bid credits refunded.</p>
          </div>
        </div>
      </div>

      <div class="stats-grid" style="margin-bottom:24px;">
        <div class="stat-card">
          <div class="stat-value" id="reviews-avg-rating" style="color:var(--accent-gold);">--</div>
          <div class="stat-label">Average Rating</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" id="reviews-total-count">0</div>
          <div class="stat-label">Total Reviews</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" id="reviews-5-star">0%</div>
          <div class="stat-label">5-Star Rate</div>
        </div>
      </div>

      <!-- Rating breakdown -->
      <div class="card" style="margin-bottom:24px;">
        <div class="card-header"><h2 class="card-title">Rating Breakdown</h2></div>
        <div id="rating-breakdown" style="display:grid;grid-template-columns:repeat(4,1fr);gap:16px;text-align:center;">
          <div>
            <div style="font-weight:600;margin-bottom:4px;" id="breakdown-quality">--</div>
            <div style="font-size:0.85rem;color:var(--text-muted);">Quality</div>
          </div>
          <div>
            <div style="font-weight:600;margin-bottom:4px;" id="breakdown-communication">--</div>
            <div style="font-size:0.85rem;color:var(--text-muted);">Communication</div>
          </div>
          <div>
            <div style="font-weight:600;margin-bottom:4px;" id="breakdown-timeliness">--</div>
            <div style="font-size:0.85rem;color:var(--text-muted);">Timeliness</div>
          </div>
          <div>
            <div style="font-weight:600;margin-bottom:4px;" id="breakdown-value">--</div>
            <div style="font-size:0.85rem;color:var(--text-muted);">Value</div>
          </div>
        </div>
      </div>

      <!-- Reviews list -->
      <div class="card">
        <div class="card-header"><h2 class="card-title">Recent Reviews</h2></div>
        <div id="reviews-list">
          <div class="empty-state">
            <div class="empty-state-icon">â­</div>
            <p>No reviews yet. Complete jobs to receive reviews!</p>
          </div>
        </div>
      </div>
    </section>

    <!-- Performance Section -->
    <section id="performance" class="section">
      <div class="page-header">
        <h1 class="page-title">ðŸ“ˆ Performance Dashboard</h1>
        <p class="page-subtitle">Track your performance metrics and earn badges to stand out.</p>
      </div>

      <div style="display:grid;grid-template-columns:1fr 2fr;gap:24px;margin-bottom:24px;" class="performance-hero">
        <div class="card" style="display:flex;flex-direction:column;align-items:center;justify-content:center;padding:32px;">
          <div class="performance-score-display" id="perf-score-display">
            <div class="performance-score-value" id="perf-overall-score">--</div>
            <div class="performance-score-label">Overall Score</div>
          </div>
          <div style="margin-top:20px;">
            <div class="performance-tier-badge bronze" id="perf-tier-badge">
              <span>ðŸ¥‰</span>
              <span id="perf-tier-text">Bronze</span>
            </div>
          </div>
          <button class="btn btn-ghost btn-sm" onclick="refreshPerformance()" style="margin-top:16px;">â†» Refresh</button>
        </div>

        <div class="card">
          <div class="card-header">
            <h2 class="card-title">Performance Metrics</h2>
          </div>
          <div class="performance-metrics-grid">
            <div class="performance-metric-card">
              <div class="performance-metric-icon">â­</div>
              <div class="performance-metric-value" id="perf-rating">--</div>
              <div class="performance-metric-label">Average Rating</div>
              <div class="stars-display" id="perf-stars"></div>
            </div>
            <div class="performance-metric-card">
              <div class="performance-metric-icon">âœ…</div>
              <div class="performance-metric-value" id="perf-jobs-completed">0</div>
              <div class="performance-metric-label">Jobs Completed</div>
            </div>
            <div class="performance-metric-card">
              <div class="performance-metric-icon">â±ï¸</div>
              <div class="performance-metric-value" id="perf-on-time">--</div>
              <div class="performance-metric-label">On-Time Rate</div>
            </div>
            <div class="performance-metric-card">
              <div class="performance-metric-icon">âš¡</div>
              <div class="performance-metric-value" id="perf-response-time">--</div>
              <div class="performance-metric-label">Avg Response Time</div>
            </div>
            <div class="performance-metric-card">
              <div class="performance-metric-icon">ðŸŽ¯</div>
              <div class="performance-metric-value" id="perf-acceptance-rate">--</div>
              <div class="performance-metric-label">Bid Acceptance Rate</div>
            </div>
            <div class="performance-metric-card">
              <div class="performance-metric-icon">ðŸ“Š</div>
              <div class="performance-metric-value" id="perf-bids-submitted">0</div>
              <div class="performance-metric-label">Bids Submitted</div>
            </div>
          </div>
        </div>
      </div>

      <style>
        @media (max-width: 900px) {
          .performance-hero { grid-template-columns: 1fr !important; }
        }
      </style>

      <div class="card" style="margin-bottom:24px;">
        <div class="card-header">
          <h2 class="card-title">ðŸ… Earned Badges</h2>
          <p style="font-size:0.85rem;color:var(--text-muted);margin-top:4px;">Unlock badges to boost your visibility to members</p>
        </div>
        <div class="performance-badges-grid" id="perf-badges-grid">
          <div class="performance-badge locked" data-badge="top_rated">
            <span class="performance-badge-icon">ðŸ†</span>
            <span>Top Rated</span>
          </div>
          <div class="performance-badge locked" data-badge="quick_responder">
            <span class="performance-badge-icon">âš¡</span>
            <span>Quick Responder</span>
          </div>
          <div class="performance-badge locked" data-badge="veteran">
            <span class="performance-badge-icon">ðŸŽ–ï¸</span>
            <span>Veteran</span>
          </div>
          <div class="performance-badge locked" data-badge="perfect_score">
            <span class="performance-badge-icon">â­</span>
            <span>Perfect Score</span>
          </div>
          <div class="performance-badge locked" data-badge="dispute_free">
            <span class="performance-badge-icon">ðŸ›¡ï¸</span>
            <span>Dispute-Free</span>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="card-header">
          <h2 class="card-title">ðŸ’¡ Performance Tips</h2>
        </div>
        <div id="perf-tips">
          <div class="performance-tip">
            <span class="performance-tip-icon">ðŸ“Š</span>
            <div class="performance-tip-text">Loading performance insights...</div>
          </div>
        </div>
      </div>

      <div class="alert" style="background:var(--accent-gold-soft);border:1px solid rgba(212,168,85,0.3);color:var(--text-secondary);margin-top:24px;padding:16px;border-radius:var(--radius-md);">
        <strong style="color:var(--accent-gold);">ðŸ† How Tiers Work:</strong>
        <div style="margin-top:8px;display:grid;grid-template-columns:repeat(auto-fit, minmax(140px, 1fr));gap:12px;font-size:0.9rem;">
          <div><span style="color:#e5e4e2;">â¬¥ Platinum:</span> 90+ score</div>
          <div><span style="color:var(--accent-gold);">â¬¥ Gold:</span> 75-89 score</div>
          <div><span style="color:#c0c0c0;">â¬¥ Silver:</span> 50-74 score</div>
          <div><span style="color:#cd7f32;">â¬¥ Bronze:</span> 0-49 score</div>
        </div>
      </div>
    </section>

    <section id="messages" class="section">
      <div class="page-header"><h1 class="page-title">Messages</h1><p class="page-subtitle">Conversations with members.</p></div>
      <div id="conversations"><div class="empty-state"><div class="empty-state-icon">ðŸ’¬</div><p>No conversations yet.</p></div></div>
    </section>

    <!-- Notifications Section -->
    <section id="notifications" class="section">
      <div class="page-header">
        <div style="display:flex;justify-content:space-between;align-items:center;">
          <div>
            <h1 class="page-title">Notifications</h1>
            <p class="page-subtitle">Stay updated on bids and jobs.</p>
          </div>
          <button class="btn btn-secondary" onclick="markAllNotificationsRead()">Mark All Read</button>
        </div>
      </div>
      <div id="notifications-list">
        <div class="empty-state"><div class="empty-state-icon">ðŸ””</div><p>No notifications yet.</p></div>
      </div>
    </section>

    <!-- Bid Credits Section -->
    <section id="subscription" class="section">
      <div class="page-header">
        <h1 class="page-title">ðŸŽŸï¸ Bid Credits</h1>
        <p class="page-subtitle">Purchase credits to bid on service packages.</p>
      </div>

      <!-- Quick Checkout Banner -->
      <div id="quick-checkout-banner" style="background:linear-gradient(135deg, var(--accent-gold), #c49a45);border-radius:var(--radius-lg);padding:20px 24px;margin-bottom:24px;display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:16px;">
        <div style="display:flex;align-items:center;gap:16px;">
          <span style="font-size:2.5rem;">ðŸ›’</span>
          <div>
            <div style="font-size:1.2rem;font-weight:700;color:#0a0a0f;">Ready to buy credits?</div>
            <div style="font-size:0.9rem;color:rgba(10,10,15,0.7);">Skip to checkout and choose your bid pack below</div>
          </div>
        </div>
        <button class="btn" onclick="document.getElementById('bid-packs-grid').scrollIntoView({behavior:'smooth',block:'center'})" style="background:#0a0a0f;color:var(--accent-gold);padding:14px 28px;font-size:1rem;font-weight:600;">
          View Bid Packs â†“
        </button>
      </div>

      <!-- Current Balance -->
      <div class="card">
        <div class="card-header">
          <h2 class="card-title">Your Balance</h2>
        </div>
        <div style="display:flex;align-items:center;gap:24px;flex-wrap:wrap;">
          <div style="text-align:center;padding:20px 32px;background:var(--accent-gold-soft);border-radius:var(--radius-lg);border:1px solid rgba(212,168,85,0.3);">
            <div style="font-size:3rem;font-weight:700;color:var(--accent-gold);" id="credits-balance">0</div>
            <div style="font-size:0.9rem;color:var(--text-secondary);">Bid Credits</div>
          </div>
          <div style="flex:1;min-width:200px;">
            <div style="display:grid;gap:8px;">
              <div style="display:flex;justify-content:space-between;">
                <span style="color:var(--text-muted);">Free Trial Bids</span>
                <span style="font-weight:500;" id="free-bids-remaining">0</span>
              </div>
              <div style="display:flex;justify-content:space-between;">
                <span style="color:var(--text-muted);">Total Purchased</span>
                <span style="font-weight:500;" id="total-purchased">0</span>
              </div>
              <div style="display:flex;justify-content:space-between;">
                <span style="color:var(--text-muted);">Total Used</span>
                <span style="font-weight:500;" id="total-used">0</span>
              </div>
            </div>
          </div>
        </div>
        <div id="low-credits-warning" style="display:none;margin-top:16px;padding:14px;background:var(--accent-orange-soft);border:1px solid rgba(245,158,11,0.3);border-radius:var(--radius-md);display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:12px;">
          <span style="color:var(--accent-orange);">âš ï¸ <strong>Low on credits!</strong> Purchase more to keep bidding on packages.</span>
          <button class="btn btn-sm" onclick="document.getElementById('bid-packs-grid').scrollIntoView({behavior:'smooth',block:'center'})" style="background:var(--accent-orange);color:#0a0a0f;font-weight:600;">Buy Now â†’</button>
        </div>
        <div id="no-credits-warning" style="display:none;margin-top:16px;padding:14px;background:var(--accent-red-soft);border:1px solid rgba(239,95,95,0.3);border-radius:var(--radius-md);display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:12px;">
          <span style="color:var(--accent-red);">ðŸš« <strong>No credits remaining.</strong> Purchase a bid pack to continue bidding.</span>
          <button class="btn btn-sm" onclick="document.getElementById('bid-packs-grid').scrollIntoView({behavior:'smooth',block:'center'})" style="background:var(--accent-red);color:#fff;font-weight:600;">Buy Credits â†’</button>
        </div>
      </div>

      <!-- Bid Packs -->
      <div class="card">
        <div class="card-header">
          <h2 class="card-title">Buy Bid Packs</h2>
          <span style="color:var(--text-muted);font-size:0.9rem;">Volume discounts available!</span>
        </div>

        <div id="bid-packs-grid" style="display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:16px;">
          <!-- Packs loaded dynamically -->
          <div class="empty-state"><p>Loading bid packs...</p></div>
        </div>
      </div>

      <!-- How It Works -->
      <div class="card">
        <div class="card-header">
          <h2 class="card-title">ðŸ’¡ How Bid Credits Work</h2>
        </div>
        <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:20px;">
          <div style="text-align:center;padding:16px;">
            <div style="font-size:2rem;margin-bottom:8px;">ðŸŽŸï¸</div>
            <div style="font-weight:600;margin-bottom:4px;">1 Credit = 1 Bid</div>
            <div style="font-size:0.85rem;color:var(--text-muted);">Each bid on a package uses one credit</div>
          </div>
          <div style="text-align:center;padding:16px;">
            <div style="font-size:2rem;margin-bottom:8px;">ðŸ’°</div>
            <div style="font-weight:600;margin-bottom:4px;">Buy More, Save More</div>
            <div style="font-size:0.85rem;color:var(--text-muted);">Larger packs have better per-bid rates</div>
          </div>
          <div style="text-align:center;padding:16px;">
            <div style="font-size:2rem;margin-bottom:8px;">â™¾ï¸</div>
            <div style="font-weight:600;margin-bottom:4px;">Never Expire</div>
            <div style="font-size:0.85rem;color:var(--text-muted);">Your credits stay until you use them</div>
          </div>
          <div style="text-align:center;padding:16px;">
            <div style="font-size:2rem;margin-bottom:8px;">ðŸŽ</div>
            <div style="font-weight:600;margin-bottom:4px;">Bonus Credits</div>
            <div style="font-size:0.85rem;color:var(--text-muted);">Get extra free bids on larger packs</div>
          </div>
        </div>
      </div>

      <!-- Purchase History -->
      <div class="card">
        <div class="card-header">
          <h2 class="card-title">Purchase History</h2>
        </div>
        <div id="purchase-history">
          <p style="color:var(--text-muted);">No purchases yet.</p>
        </div>
      </div>
    </section>

    <!-- Business Profile Section -->
    <section id="profile" class="section">
      <div class="page-header">
        <h1 class="page-title">Business Profile</h1>
        <p class="page-subtitle">Set up your profile to attract more customers.</p>
      </div>

      <!-- Theme Settings -->
      <div class="card">
        <div class="card-header">
          <h2 class="card-title">ðŸŽ¨ Appearance</h2>
        </div>
        <div style="display:flex;align-items:center;justify-content:space-between;padding:16px;background:var(--bg-input);border-radius:var(--radius-md);border:1px solid var(--border-subtle);">
          <div style="display:flex;align-items:center;gap:12px;">
            <span style="font-size:1.5rem;" id="settings-theme-icon-display">ðŸŒ™</span>
            <div>
              <div style="font-weight:600;" id="settings-theme-label">Dark Mode</div>
              <div style="font-size:0.85rem;color:var(--text-muted);">Switch between light and dark themes</div>
            </div>
          </div>
          <label class="toggle-switch" style="display:flex;align-items:center;gap:10px;cursor:pointer;">
            <input type="checkbox" id="settings-theme-toggle" onchange="setThemeFromToggle(this.checked)">
            <span class="toggle-slider" style="position:relative;width:50px;height:26px;background:var(--bg-elevated);border:1px solid var(--border-subtle);border-radius:13px;transition:all 0.3s;display:inline-block;"></span>
          </label>
        </div>
        <style>
          #settings-theme-toggle { display: none; }
          #settings-theme-toggle + .toggle-slider::after {
            content: '';
            position: absolute;
            top: 3px;
            left: 3px;
            width: 18px;
            height: 18px;
            background: var(--text-muted);
            border-radius: 50%;
            transition: all 0.3s;
          }
          #settings-theme-toggle:checked + .toggle-slider {
            background: var(--accent-gold);
            border-color: var(--accent-gold);
          }
          #settings-theme-toggle:checked + .toggle-slider::after {
            left: 27px;
            background: #0a0a0f;
          }
        </style>
        <script>
          document.addEventListener('DOMContentLoaded', () => {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const toggle = document.getElementById('settings-theme-toggle');
            const label = document.getElementById('settings-theme-label');
            const iconDisplay = document.getElementById('settings-theme-icon-display');
            if (toggle) toggle.checked = currentTheme === 'light';
            if (label) label.textContent = currentTheme === 'dark' ? 'Dark Mode' : 'Light Mode';
            if (iconDisplay) iconDisplay.textContent = currentTheme === 'dark' ? 'ðŸŒ™' : 'â˜€ï¸';
          });
        </script>
      </div>

      <div class="card" style="margin-top:20px;">
        <div class="card-header">
          <h2 class="card-title">Profile Completion</h2>
        </div>
        <div style="margin-bottom:20px;">
          <div style="display:flex;justify-content:space-between;margin-bottom:8px;">
            <span style="font-size:0.9rem;">Profile strength</span>
            <span style="font-size:0.9rem;font-weight:600;" id="profile-completion-pct">0%</span>
          </div>
          <div style="height:8px;background:var(--bg-input);border-radius:4px;overflow:hidden;">
            <div id="profile-completion-bar" style="height:100%;width:0%;background:linear-gradient(90deg,var(--accent-gold),#c49a45);transition:width 0.3s;"></div>
          </div>
          <p style="font-size:0.82rem;color:var(--text-muted);margin-top:8px;">Complete your profile to appear higher in search results and build trust with members.</p>
        </div>
      </div>

      <!-- Verification Status Card -->
      <div class="card" id="verification-status-card">
        <div class="card-header">
          <h2 class="card-title">ðŸ›¡ï¸ Verification Status</h2>
        </div>
        <div id="verified-badge-container" style="display:none;margin-bottom:20px;padding:16px;background:linear-gradient(135deg, rgba(74,200,140,0.15), rgba(212,168,85,0.15));border:2px solid var(--accent-gold);border-radius:var(--radius-lg);text-align:center;">
          <div style="font-size:2rem;margin-bottom:8px;">ðŸ†</div>
          <div style="font-size:1.1rem;font-weight:600;color:var(--accent-gold);">Concierge Verified Provider</div>
          <p style="font-size:0.85rem;color:var(--text-secondary);margin-top:6px;">Your business credentials have been verified by My Car Concierge</p>
        </div>
        <div id="verification-checklist" style="display:grid;gap:12px;">
          <div class="verification-item" id="verify-license" style="display:flex;align-items:center;gap:12px;padding:14px 16px;background:var(--bg-elevated);border:1px solid var(--border-subtle);border-radius:var(--radius-md);">
            <span class="verify-status" style="font-size:1.2rem;">â³</span>
            <div style="flex:1;">
              <div style="font-weight:500;">Business License</div>
              <div style="font-size:0.82rem;color:var(--text-muted);">Upload your business license for verification</div>
            </div>
            <span class="verify-badge" style="padding:4px 10px;border-radius:100px;font-size:0.75rem;font-weight:500;background:var(--accent-gold-soft);color:var(--accent-gold);">Pending</span>
          </div>
          <div class="verification-item" id="verify-insurance" style="display:flex;align-items:center;gap:12px;padding:14px 16px;background:var(--bg-elevated);border:1px solid var(--border-subtle);border-radius:var(--radius-md);">
            <span class="verify-status" style="font-size:1.2rem;">â³</span>
            <div style="flex:1;">
              <div style="font-weight:500;">Insurance Certificate</div>
              <div style="font-size:0.82rem;color:var(--text-muted);">Proof of liability insurance coverage</div>
            </div>
            <span class="verify-badge" style="padding:4px 10px;border-radius:100px;font-size:0.75rem;font-weight:500;background:var(--accent-gold-soft);color:var(--accent-gold);">Pending</span>
          </div>
          <div class="verification-item" id="verify-certifications" style="display:flex;align-items:center;gap:12px;padding:14px 16px;background:var(--bg-elevated);border:1px solid var(--border-subtle);border-radius:var(--radius-md);">
            <span class="verify-status" style="font-size:1.2rem;">â³</span>
            <div style="flex:1;">
              <div style="font-weight:500;">Certifications</div>
              <div style="font-size:0.82rem;color:var(--text-muted);">ASE, I-CAR, or other professional certifications</div>
            </div>
            <span class="verify-badge" style="padding:4px 10px;border-radius:100px;font-size:0.75rem;font-weight:500;background:var(--accent-gold-soft);color:var(--accent-gold);">Pending</span>
          </div>
        </div>
        <p style="font-size:0.82rem;color:var(--text-muted);margin-top:16px;">ðŸ“‹ Upload documents below. Our team will review and verify within 1-2 business days.</p>
      </div>

      <!-- Stripe Connect Card -->
      <div class="card" id="stripe-connect-card">
        <div class="card-header">
          <h2 class="card-title">ðŸ’³ Payment Setup</h2>
        </div>
        <div id="stripe-connect-content">
          <!-- Not Connected State -->
          <div id="stripe-not-connected" style="display:none;">
            <div style="display:flex;align-items:flex-start;gap:16px;padding:20px;background:var(--bg-elevated);border:1px solid var(--border-subtle);border-radius:var(--radius-md);">
              <div style="font-size:2rem;">ðŸ”—</div>
              <div style="flex:1;">
                <div style="font-weight:600;margin-bottom:6px;">Connect Stripe to Get Paid</div>
                <p style="font-size:0.85rem;color:var(--text-secondary);margin-bottom:12px;">Connect your Stripe account to receive payments for completed jobs. Funds are transferred directly to your bank account.</p>
                <button class="btn btn-primary" onclick="startStripeConnect()" id="stripe-connect-btn">
                  ðŸ”— Connect Stripe Account
                </button>
              </div>
            </div>
          </div>
          
          <!-- Onboarding Incomplete State -->
          <div id="stripe-incomplete" style="display:none;">
            <div style="display:flex;align-items:flex-start;gap:16px;padding:20px;background:var(--accent-gold-soft);border:1px solid var(--accent-gold);border-radius:var(--radius-md);">
              <div style="font-size:2rem;">â³</div>
              <div style="flex:1;">
                <div style="font-weight:600;margin-bottom:6px;color:var(--accent-gold);">Stripe Onboarding Incomplete</div>
                <p style="font-size:0.85rem;color:var(--text-secondary);margin-bottom:12px;">You started the Stripe setup but haven't completed it yet. Please finish your onboarding to start receiving payments.</p>
                <button class="btn btn-primary" onclick="startStripeConnect()" id="stripe-resume-btn">
                  ðŸ“ Complete Stripe Setup
                </button>
              </div>
            </div>
          </div>
          
          <!-- Connected State -->
          <div id="stripe-connected" style="display:none;">
            <div style="display:flex;align-items:flex-start;gap:16px;padding:20px;background:var(--accent-green-soft);border:1px solid var(--accent-green);border-radius:var(--radius-md);">
              <div style="font-size:2rem;">âœ…</div>
              <div style="flex:1;">
                <div style="font-weight:600;margin-bottom:6px;color:var(--accent-green);">Stripe Connected</div>
                <p style="font-size:0.85rem;color:var(--text-secondary);margin-bottom:8px;">Your Stripe account is connected and ready to receive payments. Earnings from completed jobs will be transferred directly to your bank.</p>
                <div style="display:flex;flex-wrap:wrap;gap:8px;margin-top:12px;">
                  <span class="status-badge" style="background:var(--accent-green-soft);color:var(--accent-green);padding:4px 10px;border-radius:100px;font-size:0.75rem;font-weight:500;">Charges Enabled</span>
                  <span class="status-badge" style="background:var(--accent-green-soft);color:var(--accent-green);padding:4px 10px;border-radius:100px;font-size:0.75rem;font-weight:500;">Payouts Enabled</span>
                  <span class="status-badge" style="background:var(--accent-green-soft);color:var(--accent-green);padding:4px 10px;border-radius:100px;font-size:0.75rem;font-weight:500;">Transfers Enabled</span>
                </div>
              </div>
            </div>
          </div>
          
          <!-- Loading State -->
          <div id="stripe-loading" style="display:flex;align-items:center;justify-content:center;padding:40px;">
            <div class="spinner" style="width:24px;height:24px;border:3px solid var(--border-subtle);border-top-color:var(--accent-gold);border-radius:50%;animation:spin 1s linear infinite;"></div>
            <span style="margin-left:12px;color:var(--text-muted);">Checking Stripe status...</span>
          </div>
        </div>
      </div>

      <!-- Verification Documents Upload -->
      <div class="card" id="verification-docs-card">
        <div class="card-header">
          <h2 class="card-title">ðŸ“„ Verification Documents</h2>
        </div>
        <p style="color:var(--text-secondary);margin-bottom:20px;font-size:0.9rem;">Upload documents to get verified and earn the Concierge Verified badge. Accepted formats: PDF, JPG, PNG.</p>
        
        <div style="display:grid;gap:16px;">
          <!-- Business License Upload -->
          <div class="doc-upload-item" style="padding:20px;background:var(--bg-elevated);border:1px solid var(--border-subtle);border-radius:var(--radius-md);">
            <div style="display:flex;align-items:flex-start;justify-content:space-between;gap:16px;flex-wrap:wrap;">
              <div style="flex:1;min-width:200px;">
                <div style="font-weight:600;margin-bottom:4px;">ðŸ“œ Business License</div>
                <div style="font-size:0.85rem;color:var(--text-muted);">Your official business or trade license</div>
                <div id="license-upload-status" style="margin-top:8px;font-size:0.85rem;"></div>
              </div>
              <div style="display:flex;gap:8px;align-items:center;">
                <input type="file" id="license-file-input" accept=".pdf,.jpg,.jpeg,.png" style="display:none;" onchange="uploadVerificationDoc('license')">
                <button class="btn btn-secondary btn-sm" onclick="document.getElementById('license-file-input').click()">
                  ðŸ“¤ Upload
                </button>
                <a id="license-view-btn" href="#" target="_blank" class="btn btn-ghost btn-sm" style="display:none;">View</a>
              </div>
            </div>
          </div>

          <!-- Insurance Certificate Upload -->
          <div class="doc-upload-item" style="padding:20px;background:var(--bg-elevated);border:1px solid var(--border-subtle);border-radius:var(--radius-md);">
            <div style="display:flex;align-items:flex-start;justify-content:space-between;gap:16px;flex-wrap:wrap;">
              <div style="flex:1;min-width:200px;">
                <div style="font-weight:600;margin-bottom:4px;">ðŸ›¡ï¸ Insurance Certificate</div>
                <div style="font-size:0.85rem;color:var(--text-muted);">Proof of liability insurance coverage</div>
                <div id="insurance-upload-status" style="margin-top:8px;font-size:0.85rem;"></div>
              </div>
              <div style="display:flex;gap:8px;align-items:center;">
                <input type="file" id="insurance-file-input" accept=".pdf,.jpg,.jpeg,.png" style="display:none;" onchange="uploadVerificationDoc('insurance')">
                <button class="btn btn-secondary btn-sm" onclick="document.getElementById('insurance-file-input').click()">
                  ðŸ“¤ Upload
                </button>
                <a id="insurance-view-btn" href="#" target="_blank" class="btn btn-ghost btn-sm" style="display:none;">View</a>
              </div>
            </div>
          </div>

          <!-- Certifications Upload -->
          <div class="doc-upload-item" style="padding:20px;background:var(--bg-elevated);border:1px solid var(--border-subtle);border-radius:var(--radius-md);">
            <div style="display:flex;align-items:flex-start;justify-content:space-between;gap:16px;flex-wrap:wrap;">
              <div style="flex:1;min-width:200px;">
                <div style="font-weight:600;margin-bottom:4px;">ðŸ… Certifications</div>
                <div style="font-size:0.85rem;color:var(--text-muted);">ASE, I-CAR, manufacturer, or other professional certifications</div>
                <div id="certifications-upload-status" style="margin-top:8px;font-size:0.85rem;"></div>
              </div>
              <div style="display:flex;gap:8px;align-items:center;">
                <input type="file" id="certifications-file-input" accept=".pdf,.jpg,.jpeg,.png" style="display:none;" onchange="uploadVerificationDoc('certifications')">
                <button class="btn btn-secondary btn-sm" onclick="document.getElementById('certifications-file-input').click()">
                  ðŸ“¤ Upload
                </button>
                <a id="certifications-view-btn" href="#" target="_blank" class="btn btn-ghost btn-sm" style="display:none;">View</a>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="card-header">
          <h2 class="card-title">Business Information</h2>
        </div>
        
        <div class="form-group">
          <label class="form-label">Business Name *</label>
          <input type="text" class="form-input" id="profile-business-name" placeholder="e.g., Mike's Auto Service">
          <div class="form-hint">This is how members will see your business</div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="form-label">Your Name</label>
            <input type="text" class="form-input" id="profile-full-name" placeholder="e.g., Mike Johnson">
          </div>
          <div class="form-group">
            <label class="form-label">Business Phone</label>
            <input type="tel" class="form-input" id="profile-phone" placeholder="(555) 123-4567">
          </div>
        </div>

        <div class="form-group">
          <label class="form-label">Business Address</label>
          <input type="text" class="form-input" id="profile-address" placeholder="123 Main St, City, State ZIP">
          <div class="form-hint">Members may need this for drop-off</div>
        </div>

        <div class="form-group">
          <label class="form-label">Years in Business</label>
          <select class="form-input" id="profile-years" style="cursor:pointer;">
            <option value="">Select...</option>
            <option value="1">Less than 1 year</option>
            <option value="2">1-2 years</option>
            <option value="5">3-5 years</option>
            <option value="10">6-10 years</option>
            <option value="15">11-15 years</option>
            <option value="20">16-20 years</option>
            <option value="25">20+ years</option>
          </select>
        </div>
      </div>

      <div class="card">
        <div class="card-header">
          <h2 class="card-title">Services Offered</h2>
        </div>
        <p style="color:var(--text-secondary);margin-bottom:16px;font-size:0.9rem;">Select all services your shop provides:</p>
        
        <div style="font-size:0.85rem;font-weight:600;color:var(--accent-gold);margin-bottom:10px;margin-top:8px;">Maintenance & Repair</div>
        <div class="services-grid" id="services-grid">
          <label class="service-checkbox"><input type="checkbox" value="Oil Change"> Oil Change</label>
          <label class="service-checkbox"><input type="checkbox" value="Brake Service"> Brake Service</label>
          <label class="service-checkbox"><input type="checkbox" value="Tire Service"> Tire Service</label>
          <label class="service-checkbox"><input type="checkbox" value="Engine Repair"> Engine Repair</label>
          <label class="service-checkbox"><input type="checkbox" value="Transmission"> Transmission</label>
          <label class="service-checkbox"><input type="checkbox" value="AC/Heating"> AC/Heating</label>
          <label class="service-checkbox"><input type="checkbox" value="Electrical"> Electrical</label>
          <label class="service-checkbox"><input type="checkbox" value="Suspension"> Suspension</label>
          <label class="service-checkbox"><input type="checkbox" value="Exhaust"> Exhaust</label>
          <label class="service-checkbox"><input type="checkbox" value="Diagnostics"> Diagnostics</label>
          <label class="service-checkbox"><input type="checkbox" value="State Inspection"> State Inspection</label>
          <label class="service-checkbox"><input type="checkbox" value="Emissions"> Emissions</label>
          <label class="service-checkbox"><input type="checkbox" value="Towing"> Towing</label>
          <label class="service-checkbox"><input type="checkbox" value="Mobile Service"> Mobile Service</label>
        </div>

        <div style="font-size:0.85rem;font-weight:600;color:var(--accent-gold);margin-bottom:10px;margin-top:20px;">Body & Appearance</div>
        <div class="services-grid">
          <label class="service-checkbox"><input type="checkbox" value="Detailing"> Detailing</label>
          <label class="service-checkbox"><input type="checkbox" value="Body Work"> Body Work</label>
          <label class="service-checkbox"><input type="checkbox" value="Paint"> Paint</label>
          <label class="service-checkbox"><input type="checkbox" value="Glass Repair"> Glass Repair</label>
          <label class="service-checkbox"><input type="checkbox" value="Car Wraps"> Car Wraps</label>
          <label class="service-checkbox"><input type="checkbox" value="Vinyl Graphics"> Vinyl Graphics</label>
          <label class="service-checkbox"><input type="checkbox" value="Paint Protection Film"> Paint Protection Film (PPF)</label>
          <label class="service-checkbox"><input type="checkbox" value="Ceramic Coating"> Ceramic Coating</label>
          <label class="service-checkbox"><input type="checkbox" value="Window Tinting"> Window Tinting</label>
          <label class="service-checkbox"><input type="checkbox" value="Headlight Restoration"> Headlight Restoration</label>
          <label class="service-checkbox"><input type="checkbox" value="Dent Removal"> Paintless Dent Removal</label>
        </div>

        <div style="font-size:0.85rem;font-weight:600;color:var(--accent-gold);margin-bottom:10px;margin-top:20px;">Performance & Modifications</div>
        <div class="services-grid">
          <label class="service-checkbox"><input type="checkbox" value="Engine Tuning"> Engine Tuning</label>
          <label class="service-checkbox"><input type="checkbox" value="Performance Exhaust"> Performance Exhaust</label>
          <label class="service-checkbox"><input type="checkbox" value="Turbo/Supercharger"> Turbo/Supercharger Install</label>
          <label class="service-checkbox"><input type="checkbox" value="ECU Tuning"> ECU Tuning/Remapping</label>
          <label class="service-checkbox"><input type="checkbox" value="Cold Air Intake"> Cold Air Intake</label>
          <label class="service-checkbox"><input type="checkbox" value="Lift Kits"> Lift Kits</label>
          <label class="service-checkbox"><input type="checkbox" value="Lowering Kits"> Lowering Kits</label>
          <label class="service-checkbox"><input type="checkbox" value="Coilovers"> Coilover Install</label>
          <label class="service-checkbox"><input type="checkbox" value="Big Brake Kits"> Big Brake Kits</label>
          <label class="service-checkbox"><input type="checkbox" value="Custom Wheels"> Custom Wheels & Rims</label>
          <label class="service-checkbox"><input type="checkbox" value="Roll Cages"> Roll Cages & Safety</label>
        </div>

        <div style="font-size:0.85rem;font-weight:600;color:var(--accent-gold);margin-bottom:10px;margin-top:20px;">Audio & Electronics</div>
        <div class="services-grid">
          <label class="service-checkbox"><input type="checkbox" value="Sound Systems"> Sound Systems</label>
          <label class="service-checkbox"><input type="checkbox" value="Subwoofers"> Subwoofers & Amplifiers</label>
          <label class="service-checkbox"><input type="checkbox" value="Head Units"> Head Units & Touchscreens</label>
          <label class="service-checkbox"><input type="checkbox" value="Speakers"> Speaker Upgrades</label>
          <label class="service-checkbox"><input type="checkbox" value="Dash Cameras"> Dash Cameras</label>
          <label class="service-checkbox"><input type="checkbox" value="Backup Cameras"> Backup Cameras</label>
          <label class="service-checkbox"><input type="checkbox" value="360 Camera Systems"> 360 Camera Systems</label>
          <label class="service-checkbox"><input type="checkbox" value="Rideshare Camera Setup"> Rideshare Camera Setup</label>
          <label class="service-checkbox"><input type="checkbox" value="GPS Tracking"> GPS Tracking Systems</label>
          <label class="service-checkbox"><input type="checkbox" value="Remote Start"> Remote Start Systems</label>
          <label class="service-checkbox"><input type="checkbox" value="Car Alarms"> Car Alarms & Security</label>
        </div>

        <div style="font-size:0.85rem;font-weight:600;color:var(--accent-gold);margin-bottom:10px;margin-top:20px;">Lighting & Accessories</div>
        <div class="services-grid">
          <label class="service-checkbox"><input type="checkbox" value="LED Lighting"> LED Lighting Upgrades</label>
          <label class="service-checkbox"><input type="checkbox" value="Underglow"> Underglow Lighting</label>
          <label class="service-checkbox"><input type="checkbox" value="Interior Lighting"> Interior LED Lighting</label>
          <label class="service-checkbox"><input type="checkbox" value="Christmas Lights"> Holiday/Christmas Lights</label>
          <label class="service-checkbox"><input type="checkbox" value="HID Conversion"> HID Conversion Kits</label>
          <label class="service-checkbox"><input type="checkbox" value="Custom Headlights"> Custom Headlights</label>
          <label class="service-checkbox"><input type="checkbox" value="Tail Light Mods"> Tail Light Modifications</label>
        </div>

        <div style="font-size:0.85rem;font-weight:600;color:var(--accent-gold);margin-bottom:10px;margin-top:20px;">Interior & Upholstery</div>
        <div class="services-grid">
          <label class="service-checkbox"><input type="checkbox" value="Custom Upholstery"> Custom Upholstery</label>
          <label class="service-checkbox"><input type="checkbox" value="Leather Seats"> Leather Seat Covers</label>
          <label class="service-checkbox"><input type="checkbox" value="Seat Heating"> Seat Heating Installation</label>
          <label class="service-checkbox"><input type="checkbox" value="Custom Steering Wheels"> Custom Steering Wheels</label>
          <label class="service-checkbox"><input type="checkbox" value="Custom Dash"> Custom Dashboard</label>
          <label class="service-checkbox"><input type="checkbox" value="Floor Mats"> Custom Floor Mats</label>
          <label class="service-checkbox"><input type="checkbox" value="Trunk Customization"> Trunk Customization</label>
        </div>

        <div style="font-size:0.85rem;font-weight:600;color:var(--accent-gold);margin-bottom:10px;margin-top:20px;">Off-Road & Specialty</div>
        <div class="services-grid">
          <label class="service-checkbox"><input type="checkbox" value="Off-Road Accessories"> Off-Road Accessories</label>
          <label class="service-checkbox"><input type="checkbox" value="Winches"> Winch Installation</label>
          <label class="service-checkbox"><input type="checkbox" value="Bumpers"> Custom Bumpers</label>
          <label class="service-checkbox"><input type="checkbox" value="Roof Racks"> Roof Racks & Carriers</label>
          <label class="service-checkbox"><input type="checkbox" value="Trailer Hitches"> Trailer Hitches</label>
          <label class="service-checkbox"><input type="checkbox" value="Running Boards"> Running Boards/Side Steps</label>
          <label class="service-checkbox"><input type="checkbox" value="Bed Liners"> Truck Bed Liners</label>
          <label class="service-checkbox"><input type="checkbox" value="Tonneau Covers"> Tonneau Covers</label>
        </div>

        <div style="font-size:0.85rem;font-weight:600;color:var(--accent-gold);margin-bottom:10px;margin-top:20px;">EV & Hybrid Services</div>
        <div class="services-grid">
          <label class="service-checkbox"><input type="checkbox" value="EV Battery Diagnostics"> EV Battery Diagnostics</label>
          <label class="service-checkbox"><input type="checkbox" value="Charging Station Install"> Charging Station Install</label>
          <label class="service-checkbox"><input type="checkbox" value="Electric Motor Service"> Electric Motor Service</label>
          <label class="service-checkbox"><input type="checkbox" value="Hybrid Battery Replacement"> Hybrid Battery Replacement</label>
          <label class="service-checkbox"><input type="checkbox" value="EV Maintenance"> EV Maintenance & Inspection</label>
          <label class="service-checkbox"><input type="checkbox" value="Regenerative Brake Service"> Regenerative Brake Service</label>
        </div>

        <div style="font-size:0.85rem;font-weight:600;color:var(--accent-gold);margin-bottom:10px;margin-top:20px;">Classic & Vintage Cars</div>
        <div class="services-grid">
          <label class="service-checkbox"><input type="checkbox" value="Classic Restoration"> Full Restoration</label>
          <label class="service-checkbox"><input type="checkbox" value="Rust Repair"> Rust Repair & Prevention</label>
          <label class="service-checkbox"><input type="checkbox" value="Numbers Matching Parts"> Numbers Matching Parts</label>
          <label class="service-checkbox"><input type="checkbox" value="Vintage Upholstery"> Vintage Upholstery Restoration</label>
          <label class="service-checkbox"><input type="checkbox" value="Classic Engine Rebuild"> Classic Engine Rebuild</label>
          <label class="service-checkbox"><input type="checkbox" value="Chrome Restoration"> Chrome Restoration</label>
          <label class="service-checkbox"><input type="checkbox" value="Carburetor Service"> Carburetor Service</label>
        </div>

        <div style="font-size:0.85rem;font-weight:600;color:var(--accent-gold);margin-bottom:10px;margin-top:20px;">Fleet & Commercial Graphics</div>
        <div class="services-grid">
          <label class="service-checkbox"><input type="checkbox" value="Commercial Wraps"> Commercial Vehicle Wraps</label>
          <label class="service-checkbox"><input type="checkbox" value="Logo Decals"> Logo Decals & Lettering</label>
          <label class="service-checkbox"><input type="checkbox" value="DOT Lettering"> DOT Lettering & Compliance</label>
          <label class="service-checkbox"><input type="checkbox" value="Fleet Branding"> Fleet Branding Packages</label>
          <label class="service-checkbox"><input type="checkbox" value="Magnetic Signs"> Magnetic Signs</label>
        </div>

        <div style="font-size:0.85rem;font-weight:600;color:var(--accent-gold);margin-bottom:10px;margin-top:20px;">Premium Protection</div>
        <div class="services-grid">
          <label class="service-checkbox"><input type="checkbox" value="PPF Full Front"> PPF - Full Front</label>
          <label class="service-checkbox"><input type="checkbox" value="PPF Full Body"> PPF - Full Body</label>
          <label class="service-checkbox"><input type="checkbox" value="PPF High Impact"> PPF - High Impact Areas</label>
          <label class="service-checkbox"><input type="checkbox" value="Ceramic Window Coating"> Ceramic Window Coating</label>
          <label class="service-checkbox"><input type="checkbox" value="Wheel Powder Coating"> Wheel Powder Coating</label>
          <label class="service-checkbox"><input type="checkbox" value="Brake Caliper Painting"> Brake Caliper Painting</label>
        </div>

        <div style="font-size:0.85rem;font-weight:600;color:var(--accent-gold);margin-bottom:10px;margin-top:20px;">Convertible & Specialty</div>
        <div class="services-grid">
          <label class="service-checkbox"><input type="checkbox" value="Convertible Top Replacement"> Convertible Top Replacement</label>
          <label class="service-checkbox"><input type="checkbox" value="Convertible Window Repair"> Convertible Window Repair</label>
          <label class="service-checkbox"><input type="checkbox" value="Headliner Replacement"> Headliner Replacement</label>
          <label class="service-checkbox"><input type="checkbox" value="Sunroof Repair"> Sunroof Repair</label>
          <label class="service-checkbox"><input type="checkbox" value="Mobile Mechanic"> Mobile Mechanic Services</label>
        </div>

        <div style="font-size:0.85rem;font-weight:600;color:var(--accent-gold);margin-bottom:10px;margin-top:20px;">Motorcycle Services</div>
        <div class="services-grid">
          <label class="service-checkbox"><input type="checkbox" value="Motorcycle Detailing"> Motorcycle Detailing</label>
          <label class="service-checkbox"><input type="checkbox" value="Motorcycle Maintenance"> Motorcycle Maintenance</label>
          <label class="service-checkbox"><input type="checkbox" value="Motorcycle Mods"> Motorcycle Modifications</label>
          <label class="service-checkbox"><input type="checkbox" value="Motorcycle Exhaust"> Motorcycle Exhaust Systems</label>
          <label class="service-checkbox"><input type="checkbox" value="Motorcycle Wraps"> Motorcycle Wraps</label>
        </div>

        <div style="font-size:0.85rem;font-weight:600;color:var(--accent-gold);margin-bottom:10px;margin-top:20px;">RV & Camper Services</div>
        <div class="services-grid">
          <label class="service-checkbox"><input type="checkbox" value="RV Detailing"> RV/Camper Detailing</label>
          <label class="service-checkbox"><input type="checkbox" value="RV Winterization"> RV Winterization</label>
          <label class="service-checkbox"><input type="checkbox" value="RV De-Winterization"> RV De-Winterization</label>
          <label class="service-checkbox"><input type="checkbox" value="RV Maintenance"> RV Maintenance</label>
          <label class="service-checkbox"><input type="checkbox" value="RV Roof Repair"> RV Roof Repair/Coating</label>
        </div>

        <div style="font-size:0.85rem;font-weight:600;color:var(--accent-gold);margin-bottom:10px;margin-top:20px;">Boat & Marine Services</div>
        <div class="services-grid">
          <label class="service-checkbox"><input type="checkbox" value="Boat Hull Cleaning"> Boat Hull Cleaning</label>
          <label class="service-checkbox"><input type="checkbox" value="Boat Detailing"> Boat Detailing</label>
          <label class="service-checkbox"><input type="checkbox" value="Boat Winterization"> Boat Winterization</label>
          <label class="service-checkbox"><input type="checkbox" value="Marine Engine Service"> Marine Engine Service</label>
          <label class="service-checkbox"><input type="checkbox" value="Boat Wrap"> Boat Wraps</label>
        </div>
      </div>

      <div class="card">
        <div class="card-header">
          <h2 class="card-title">Certifications</h2>
        </div>
        <p style="color:var(--text-secondary);margin-bottom:16px;font-size:0.9rem;">Add your certifications to build trust:</p>
        
        <div class="services-grid" id="certifications-grid">
          <label class="service-checkbox"><input type="checkbox" value="ASE Certified"> ASE Certified</label>
          <label class="service-checkbox"><input type="checkbox" value="ASE Master Technician"> ASE Master Technician</label>
          <label class="service-checkbox"><input type="checkbox" value="Manufacturer Certified"> Manufacturer Certified</label>
          <label class="service-checkbox"><input type="checkbox" value="I-CAR Certified"> I-CAR Certified</label>
          <label class="service-checkbox"><input type="checkbox" value="EPA Certified"> EPA Certified</label>
          <label class="service-checkbox"><input type="checkbox" value="AAA Approved"> AAA Approved</label>
          <label class="service-checkbox"><input type="checkbox" value="BBB Accredited"> BBB Accredited</label>
        </div>

        <div class="form-group" style="margin-top:16px;">
          <label class="form-label">Other Certifications</label>
          <input type="text" class="form-input" id="profile-other-certs" placeholder="e.g., Tesla Certified, BMW Specialist">
          <div class="form-hint">Separate multiple certifications with commas</div>
        </div>
      </div>

      <div class="card">
        <div class="card-header">
          <h2 class="card-title">Service Areas</h2>
        </div>
        <div class="form-group">
          <label class="form-label">ZIP Codes You Serve</label>
          <input type="text" class="form-input" id="profile-zip-codes" placeholder="e.g., 07003, 07004, 07006">
          <div class="form-hint">Enter ZIP codes separated by commas. Leave blank to serve all areas.</div>
        </div>
        
        <div class="form-group">
          <label class="form-label">Service Radius (miles)</label>
          <select class="form-input" id="profile-radius" style="cursor:pointer;">
            <option value="5">5 miles</option>
            <option value="10">10 miles</option>
            <option value="15" selected>15 miles</option>
            <option value="25">25 miles</option>
            <option value="50">50 miles</option>
            <option value="100">No limit</option>
          </select>
        </div>
      </div>

      <div class="card">
        <div class="card-header">
          <h2 class="card-title">About Your Business</h2>
        </div>
        <div class="form-group">
          <label class="form-label">Description</label>
          <textarea class="form-textarea" id="profile-description" placeholder="Tell members about your shop, your experience, specialties, what sets you apart..." style="min-height:120px;"></textarea>
          <div class="form-hint">A good description helps you win more bids</div>
        </div>
      </div>

      <!-- Availability Calendar -->
      <div class="card">
        <div class="card-header">
          <h2 class="card-title">ðŸ“… Availability</h2>
          <p style="font-size:0.9rem;color:var(--text-secondary);margin-top:4px;">Set your regular hours and block off dates when you're unavailable.</p>
        </div>
        
        <div style="margin-bottom:24px;">
          <label class="form-label" style="margin-bottom:12px;">Regular Business Hours</label>
          <div id="weekly-hours" style="display:grid;gap:8px;">
            <div class="hour-row" style="display:grid;grid-template-columns:100px 1fr 80px auto;gap:10px;align-items:center;">
              <span style="font-weight:500;">Monday</span>
              <div style="display:flex;gap:8px;align-items:center;">
                <select class="form-input time-select" id="hours-mon-start" style="padding:8px;min-width:110px;"></select>
                <span>to</span>
                <select class="form-input time-select" id="hours-mon-end" style="padding:8px;min-width:110px;"></select>
              </div>
              <label style="display:flex;align-items:center;gap:6px;cursor:pointer;"><input type="checkbox" id="hours-mon-open" checked> Open</label>
            </div>
            <div class="hour-row" style="display:grid;grid-template-columns:100px 1fr 80px auto;gap:10px;align-items:center;">
              <span style="font-weight:500;">Tuesday</span>
              <div style="display:flex;gap:8px;align-items:center;">
                <select class="form-input time-select" id="hours-tue-start" style="padding:8px;min-width:110px;"></select>
                <span>to</span>
                <select class="form-input time-select" id="hours-tue-end" style="padding:8px;min-width:110px;"></select>
              </div>
              <label style="display:flex;align-items:center;gap:6px;cursor:pointer;"><input type="checkbox" id="hours-tue-open" checked> Open</label>
            </div>
            <div class="hour-row" style="display:grid;grid-template-columns:100px 1fr 80px auto;gap:10px;align-items:center;">
              <span style="font-weight:500;">Wednesday</span>
              <div style="display:flex;gap:8px;align-items:center;">
                <select class="form-input time-select" id="hours-wed-start" style="padding:8px;min-width:110px;"></select>
                <span>to</span>
                <select class="form-input time-select" id="hours-wed-end" style="padding:8px;min-width:110px;"></select>
              </div>
              <label style="display:flex;align-items:center;gap:6px;cursor:pointer;"><input type="checkbox" id="hours-wed-open" checked> Open</label>
            </div>
            <div class="hour-row" style="display:grid;grid-template-columns:100px 1fr 80px auto;gap:10px;align-items:center;">
              <span style="font-weight:500;">Thursday</span>
              <div style="display:flex;gap:8px;align-items:center;">
                <select class="form-input time-select" id="hours-thu-start" style="padding:8px;min-width:110px;"></select>
                <span>to</span>
                <select class="form-input time-select" id="hours-thu-end" style="padding:8px;min-width:110px;"></select>
              </div>
              <label style="display:flex;align-items:center;gap:6px;cursor:pointer;"><input type="checkbox" id="hours-thu-open" checked> Open</label>
            </div>
            <div class="hour-row" style="display:grid;grid-template-columns:100px 1fr 80px auto;gap:10px;align-items:center;">
              <span style="font-weight:500;">Friday</span>
              <div style="display:flex;gap:8px;align-items:center;">
                <select class="form-input time-select" id="hours-fri-start" style="padding:8px;min-width:110px;"></select>
                <span>to</span>
                <select class="form-input time-select" id="hours-fri-end" style="padding:8px;min-width:110px;"></select>
              </div>
              <label style="display:flex;align-items:center;gap:6px;cursor:pointer;"><input type="checkbox" id="hours-fri-open" checked> Open</label>
            </div>
            <div class="hour-row" style="display:grid;grid-template-columns:100px 1fr 80px auto;gap:10px;align-items:center;">
              <span style="font-weight:500;">Saturday</span>
              <div style="display:flex;gap:8px;align-items:center;">
                <select class="form-input time-select" id="hours-sat-start" style="padding:8px;min-width:110px;"></select>
                <span>to</span>
                <select class="form-input time-select" id="hours-sat-end" style="padding:8px;min-width:110px;"></select>
              </div>
              <label style="display:flex;align-items:center;gap:6px;cursor:pointer;"><input type="checkbox" id="hours-sat-open" checked> Open</label>
            </div>
            <div class="hour-row" style="display:grid;grid-template-columns:100px 1fr 80px auto;gap:10px;align-items:center;">
              <span style="font-weight:500;">Sunday</span>
              <div style="display:flex;gap:8px;align-items:center;">
                <select class="form-input time-select" id="hours-sun-start" style="padding:8px;min-width:110px;"></select>
                <span>to</span>
                <select class="form-input time-select" id="hours-sun-end" style="padding:8px;min-width:110px;"></select>
              </div>
              <label style="display:flex;align-items:center;gap:6px;cursor:pointer;"><input type="checkbox" id="hours-sun-open"> Open</label>
            </div>
          </div>
        </div>

        <div style="border-top:1px solid var(--border-subtle);padding-top:20px;">
          <label class="form-label" style="margin-bottom:12px;">Block Off Dates</label>
          <p class="form-hint" style="margin-bottom:12px;">Mark specific dates when you're unavailable (vacation, holidays, etc.)</p>
          <div style="display:flex;gap:12px;flex-wrap:wrap;align-items:flex-end;">
            <div class="form-group" style="margin-bottom:0;">
              <label class="form-label" style="font-size:0.8rem;">Start Date</label>
              <input type="date" class="form-input" id="block-start" style="padding:8px;">
            </div>
            <div class="form-group" style="margin-bottom:0;">
              <label class="form-label" style="font-size:0.8rem;">End Date</label>
              <input type="date" class="form-input" id="block-end" style="padding:8px;">
            </div>
            <div class="form-group" style="margin-bottom:0;">
              <label class="form-label" style="font-size:0.8rem;">Reason (optional)</label>
              <input type="text" class="form-input" id="block-reason" placeholder="e.g., Vacation" style="padding:8px;">
            </div>
            <button class="btn btn-secondary" onclick="addBlockedDate()">+ Add</button>
          </div>
          <div id="blocked-dates-list" style="margin-top:16px;"></div>
        </div>
      </div>

      <!-- Emergency Services Settings -->
      <div class="card" style="border:1px solid rgba(239, 95, 95, 0.3);background:linear-gradient(135deg, var(--bg-card), rgba(239, 95, 95, 0.05));">
        <div class="card-header">
          <h2 class="card-title">ðŸš¨ Emergency Services</h2>
        </div>
        <p style="color:var(--text-secondary);margin-bottom:20px;font-size:0.9rem;">Accept emergency roadside assistance requests from members in need.</p>
        
        <div class="form-group">
          <label style="display:flex;align-items:center;gap:12px;cursor:pointer;padding:16px;background:var(--bg-elevated);border-radius:var(--radius-md);">
            <input type="checkbox" id="emergency-accept-calls" style="width:20px;height:20px;cursor:pointer;">
            <div>
              <div style="font-weight:600;">Accept Emergency Calls</div>
              <div style="font-size:0.85rem;color:var(--text-muted);">Enable to receive emergency roadside assistance requests</div>
            </div>
          </label>
        </div>
        
        <div id="emergency-settings-details" style="display:none;">
          <div class="form-group">
            <label class="form-label">Emergency Services You Offer</label>
            <div style="display:grid;grid-template-columns:repeat(auto-fill, minmax(150px, 1fr));gap:8px;">
              <label class="service-checkbox"><input type="checkbox" value="flat_tire" class="emergency-service-check"> ðŸ›ž Flat Tire</label>
              <label class="service-checkbox"><input type="checkbox" value="dead_battery" class="emergency-service-check"> ðŸ”‹ Jump Start</label>
              <label class="service-checkbox"><input type="checkbox" value="lockout" class="emergency-service-check"> ðŸ” Lockout</label>
              <label class="service-checkbox"><input type="checkbox" value="tow_needed" class="emergency-service-check"> ðŸš› Towing</label>
              <label class="service-checkbox"><input type="checkbox" value="fuel_delivery" class="emergency-service-check"> â›½ Fuel Delivery</label>
              <label class="service-checkbox"><input type="checkbox" value="other" class="emergency-service-check"> ðŸ”§ Other</label>
            </div>
          </div>
          
          <div class="form-row">
            <div class="form-group">
              <label class="form-label">Emergency Service Radius (miles)</label>
              <select class="form-input" id="emergency-radius">
                <option value="5">5 miles</option>
                <option value="10">10 miles</option>
                <option value="15" selected>15 miles</option>
                <option value="25">25 miles</option>
                <option value="50">50 miles</option>
              </select>
            </div>
            <div class="form-group">
              <label style="display:flex;align-items:center;gap:8px;cursor:pointer;margin-top:28px;">
                <input type="checkbox" id="emergency-24-7" style="width:18px;height:18px;">
                <span>Available 24/7</span>
              </label>
            </div>
          </div>
          
          <div class="form-group">
            <label style="display:flex;align-items:center;gap:8px;cursor:pointer;">
              <input type="checkbox" id="emergency-can-tow" style="width:18px;height:18px;">
              <span>I have towing capability</span>
            </label>
          </div>
          
          <!-- No-show penalty warning -->
          <div style="background:rgba(239, 95, 95, 0.15);border:1px solid rgba(239, 95, 95, 0.3);padding:16px;border-radius:var(--radius-md);margin-top:20px;">
            <div style="display:flex;align-items:flex-start;gap:12px;">
              <span style="font-size:1.5rem;">âš ï¸</span>
              <div>
                <div style="font-weight:600;color:var(--accent-red);margin-bottom:4px;">No-Show Penalty Policy</div>
                <div style="font-size:0.9rem;color:var(--text-secondary);line-height:1.5;">
                  If you claim an emergency and fail to arrive within your ETA + 15 minutes, members can report a no-show. 
                  <strong style="color:var(--accent-red);">Penalty: 3 bid credits + 24-hour suspension from the emergency queue.</strong>
                </div>
              </div>
            </div>
          </div>
          
          <!-- Claim cost info -->
          <div style="background:var(--accent-gold-soft);padding:16px;border-radius:var(--radius-md);margin-top:16px;">
            <div style="display:flex;align-items:flex-start;gap:12px;">
              <span style="font-size:1.5rem;">ðŸŽŸï¸</span>
              <div>
                <div style="font-weight:600;color:var(--accent-gold);margin-bottom:4px;">Emergency Claim Cost</div>
                <div style="font-size:0.9rem;color:var(--text-secondary);line-height:1.5;">
                  Claiming an emergency requires <strong>1 bid credit</strong>. The credit is deducted when you accept the job.
                  Each emergency has a 5-minute claim window per round.
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- POS Features Toggle -->
      <div class="card" style="margin-top:24px;">
        <div class="card-header">
          <h2 class="card-title">ðŸ›’ Point of Sale (POS) Features</h2>
        </div>
        <p style="color:var(--text-secondary);margin-bottom:16px;font-size:0.9rem;">
          Enable Walk-In POS to process payments for customers who visit your shop directly. This adds POS features to your dashboard.
        </p>
        <label class="toggle-switch" style="display:flex;align-items:center;gap:12px;cursor:pointer;">
          <input type="checkbox" id="pos-enabled-toggle" onchange="togglePosFeatures(this.checked)">
          <span class="toggle-slider"></span>
          <span style="font-size:0.95rem;font-weight:500;">Enable Walk-In POS Features</span>
        </label>
        <p style="font-size:0.82rem;color:var(--text-muted);margin-top:12px;">
          When enabled, you'll see Walk-In POS, POS Analytics, and POS Integration options in your sidebar.
        </p>
      </div>

      <!-- Push Notification Settings -->
      <div class="card" style="margin-top:24px;">
        <div class="card-header">
          <h2 class="card-title">ðŸ”” Notification Settings</h2>
          <p style="font-size:0.9rem;color:var(--text-secondary);margin-top:4px;">Get instant alerts for new opportunities and updates.</p>
        </div>
        
        <div id="provider-push-not-supported" style="display:none;padding:16px;background:rgba(239,95,95,0.1);border:1px solid rgba(239,95,95,0.3);border-radius:var(--radius-md);">
          <p style="color:var(--accent-red);margin:0;font-size:0.9rem;">Your browser doesn't support push notifications.</p>
        </div>
        
        <div id="provider-push-content">
          <div id="provider-push-status-display" style="display:flex;align-items:center;gap:12px;margin-bottom:20px;padding:16px;background:var(--bg-input);border-radius:var(--radius-md);border:1px solid var(--border-subtle);">
            <span id="provider-push-status-icon" style="font-size:1.5rem;">ðŸ”•</span>
            <div style="flex:1;">
              <div id="provider-push-status-text" style="font-weight:600;margin-bottom:2px;">Push Notifications Disabled</div>
              <div id="provider-push-status-desc" style="font-size:0.85rem;color:var(--text-muted);">Enable to receive instant alerts for new bid opportunities and updates.</div>
            </div>
            <span id="provider-push-status-badge" class="package-badge" style="background:rgba(239,95,95,0.15);color:var(--accent-red);">Off</span>
          </div>
          
          <div id="provider-push-enable-section">
            <button class="btn btn-primary" id="provider-push-enable-btn" onclick="enableProviderPushNotifications()">
              ðŸ”” Enable Push Notifications
            </button>
          </div>
          
          <div id="provider-push-enabled-section" style="display:none;">
            <div style="display:flex;align-items:center;gap:16px;padding:16px;background:var(--accent-green-soft);border:1px solid rgba(74,200,140,0.3);border-radius:var(--radius-md);margin-bottom:20px;">
              <span style="font-size:1.5rem;">âœ…</span>
              <div style="flex:1;">
                <div style="font-weight:600;color:var(--accent-green);margin-bottom:2px;">Push Notifications Active</div>
                <div style="font-size:0.9rem;color:var(--text-secondary);">You'll receive instant alerts on this device.</div>
              </div>
            </div>
            
            <div style="display:grid;gap:12px;">
              <label style="display:flex;align-items:center;gap:10px;cursor:pointer;padding:12px;background:var(--bg-input);border-radius:var(--radius-md);border:1px solid var(--border-subtle);">
                <input type="checkbox" id="provider-push-bid-opportunities" checked>
                <div>
                  <span style="font-weight:500;">ðŸ“¦ New Bid Opportunities</span>
                  <p style="font-size:0.82rem;color:var(--text-muted);margin:2px 0 0;">Get notified when new service requests match your services</p>
                </div>
              </label>
              <label style="display:flex;align-items:center;gap:10px;cursor:pointer;padding:12px;background:var(--bg-input);border-radius:var(--radius-md);border:1px solid var(--border-subtle);">
                <input type="checkbox" id="provider-push-appointment-reminders" checked>
                <div>
                  <span style="font-weight:500;">ðŸ“… Appointment Reminders</span>
                  <p style="font-size:0.82rem;color:var(--text-muted);margin:2px 0 0;">Reminders for upcoming scheduled appointments</p>
                </div>
              </label>
              <label style="display:flex;align-items:center;gap:10px;cursor:pointer;padding:12px;background:var(--bg-input);border-radius:var(--radius-md);border:1px solid var(--border-subtle);">
                <input type="checkbox" id="provider-push-payment-received" checked>
                <div>
                  <span style="font-weight:500;">ðŸ’° Payment Received</span>
                  <p style="font-size:0.82rem;color:var(--text-muted);margin:2px 0 0;">Notifications when you receive payments from customers</p>
                </div>
              </label>
              <label style="display:flex;align-items:center;gap:10px;cursor:pointer;padding:12px;background:var(--bg-input);border-radius:var(--radius-md);border:1px solid var(--border-subtle);">
                <input type="checkbox" id="provider-push-customer-messages" checked>
                <div>
                  <span style="font-weight:500;">ðŸ’¬ Customer Messages</span>
                  <p style="font-size:0.82rem;color:var(--text-muted);margin:2px 0 0;">Alerts when customers send you new messages</p>
                </div>
              </label>
            </div>
            
            <button class="btn btn-secondary" style="margin-top:16px;" onclick="disableProviderPushNotifications()">
              ðŸ”• Disable Push Notifications
            </button>
          </div>
        </div>
      </div>

      <!-- 2FA Security Settings -->
      <div class="card" style="margin-top:24px;">
        <div class="card-header">
          <h2 class="card-title">ðŸ” Two-Factor Authentication (2FA)</h2>
          <p style="font-size:0.9rem;color:var(--text-secondary);margin-top:4px;">Add an extra layer of security to your account.</p>
        </div>
        
        <div id="2fa-loading" style="text-align:center;padding:24px;display:none;">
          <div style="width:32px;height:32px;border:3px solid var(--border-subtle);border-top-color:var(--accent-gold);border-radius:50%;animation:spin 1s linear infinite;margin:0 auto 12px;"></div>
          <p style="color:var(--text-muted);font-size:0.9rem;">Loading 2FA status...</p>
        </div>
        
        <div id="2fa-content">
          <div id="2fa-status-display" style="display:flex;align-items:center;gap:12px;margin-bottom:20px;padding:16px;background:var(--bg-input);border-radius:var(--radius-md);border:1px solid var(--border-subtle);">
            <span id="2fa-status-icon" style="font-size:1.5rem;">ðŸ”“</span>
            <div style="flex:1;">
              <div id="2fa-status-text" style="font-weight:600;margin-bottom:2px;">2FA is Disabled</div>
              <div id="2fa-status-desc" style="font-size:0.85rem;color:var(--text-muted);">Your account is protected by password only.</div>
            </div>
            <span id="2fa-status-badge" class="package-badge" style="background:rgba(239,95,95,0.15);color:var(--accent-red);">Disabled</span>
          </div>
          
          <!-- Enable 2FA Section (shown when disabled) -->
          <div id="2fa-enable-section">
            <p style="color:var(--text-secondary);margin-bottom:16px;font-size:0.9rem;line-height:1.6;">
              Enable 2FA to receive a verification code via SMS each time you log in. This helps protect your account even if your password is compromised.
            </p>
            
            <div class="form-group">
              <label class="form-label">Phone Number for 2FA</label>
              <div style="display:flex;gap:12px;align-items:flex-start;">
                <input type="tel" class="form-input" id="2fa-phone-input" placeholder="(555) 555-5555" style="max-width:200px;" oninput="format2FAPhoneInput(this)">
                <button class="btn btn-primary" id="2fa-enable-btn" onclick="initiate2FAEnable()">
                  ðŸ”’ Enable 2FA
                </button>
              </div>
              <p class="form-hint">We'll send a verification code to this number.</p>
            </div>
          </div>
          
          <!-- Disable 2FA Section (shown when enabled) -->
          <div id="2fa-disable-section" style="display:none;">
            <div style="display:flex;align-items:center;gap:16px;padding:16px;background:var(--accent-green-soft);border:1px solid rgba(74,200,140,0.3);border-radius:var(--radius-md);margin-bottom:20px;">
              <span style="font-size:1.5rem;">âœ…</span>
              <div style="flex:1;">
                <div style="font-weight:600;color:var(--accent-green);margin-bottom:2px;">2FA is Active</div>
                <div style="font-size:0.9rem;color:var(--text-secondary);">Verification codes are sent to: <strong id="2fa-masked-phone">***-***-1234</strong></div>
              </div>
            </div>
            
            <button class="btn btn-danger" style="background:rgba(239,95,95,0.15);color:var(--accent-red);border:1px solid rgba(239,95,95,0.3);" onclick="open2FADisableModal()">
              ðŸ”“ Disable 2FA
            </button>
            <p style="font-size:0.82rem;color:var(--text-muted);margin-top:12px;">
              Disabling 2FA will make your account less secure. You'll only need your password to log in.
            </p>
          </div>
        </div>
      </div>

      <div style="display:flex;gap:12px;justify-content:flex-end;margin-top:24px;">
        <button class="btn btn-secondary" onclick="loadProviderProfile()">Cancel Changes</button>
        <button class="btn btn-primary" onclick="saveProviderProfile()">ðŸ’¾ Save Profile</button>
      </div>
    </section>

    <!-- Team Members Section -->
    <section id="team" class="section">
      <div class="page-header">
        <h1 class="page-title">ðŸ‘¥ Your Team</h1>
        <p class="page-subtitle">Showcase your skilled professionals to build trust with members</p>
      </div>

      <div class="card">
        <div class="card-header">
          <h2 class="card-title">Team Members</h2>
          <button class="btn btn-primary" onclick="openTeamMemberModal()">+ Add Team Member</button>
        </div>
        <div id="team-members-grid" class="team-grid">
          <div class="empty-state">
            <div class="empty-state-icon">ðŸ‘¥</div>
            <p>No team members yet. Add your first team member to showcase your team!</p>
          </div>
        </div>
      </div>
    </section>

    <!-- Team Management Section -->
    <section id="team-section" class="section">
      <div class="page-header">
        <h1 class="page-title">ðŸ‘¤ Team Management</h1>
        <p class="page-subtitle">Manage your team members and their access levels</p>
      </div>

      <div class="card">
        <div class="card-header">
          <h2 class="card-title">Team Members</h2>
          <button class="btn btn-primary" onclick="openInviteTeamModal()">+ Invite Team Member</button>
        </div>
        <div id="team-management-table">
          <div style="overflow-x:auto;">
            <table style="width:100%;border-collapse:collapse;">
              <thead>
                <tr style="border-bottom:1px solid var(--border-subtle);">
                  <th style="text-align:left;padding:12px 16px;font-size:0.85rem;color:var(--text-muted);font-weight:500;">Name</th>
                  <th style="text-align:left;padding:12px 16px;font-size:0.85rem;color:var(--text-muted);font-weight:500;">Email</th>
                  <th style="text-align:left;padding:12px 16px;font-size:0.85rem;color:var(--text-muted);font-weight:500;">Role</th>
                  <th style="text-align:left;padding:12px 16px;font-size:0.85rem;color:var(--text-muted);font-weight:500;">Status</th>
                  <th style="text-align:right;padding:12px 16px;font-size:0.85rem;color:var(--text-muted);font-weight:500;">Actions</th>
                </tr>
              </thead>
              <tbody id="team-members-tbody">
                <tr>
                  <td colspan="5" style="padding:48px;text-align:center;color:var(--text-muted);">
                    <div style="font-size:48px;margin-bottom:16px;opacity:0.5;">ðŸ‘¥</div>
                    <p>Loading team members...</p>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="card-header">
          <h2 class="card-title">Pending Invitations</h2>
        </div>
        <div id="pending-invitations-container">
          <div class="empty-state" style="padding:32px;">
            <div class="empty-state-icon">ðŸ“§</div>
            <p>No pending invitations</p>
          </div>
        </div>
      </div>
    </section>

    <!-- Refer Providers Section -->
    <section id="refer-providers" class="section">
      <div class="page-header">
        <h1 class="page-title">ðŸ¤ Refer Providers & Earn</h1>
        <p class="page-subtitle">Become a founding member and earn commissions when you refer other providers.</p>
      </div>

      <div id="referral-loading" style="text-align:center;padding:48px;">
        <div style="width:40px;height:40px;border:3px solid var(--border-subtle);border-top-color:var(--accent-gold);border-radius:50%;animation:spin 1s linear infinite;margin:0 auto 16px;"></div>
        <p style="color:var(--text-muted);">Loading your referral program...</p>
      </div>

      <div id="referral-content" style="display:none;">
        <div style="background:linear-gradient(135deg, var(--accent-gold-soft), var(--accent-blue-soft));border:1px solid var(--accent-gold);border-radius:var(--radius-xl);padding:40px;margin-bottom:32px;text-align:center;">
          <div style="font-size:2.5rem;margin-bottom:16px;">ðŸ’°</div>
          <h2 style="font-family:'Playfair Display',serif;font-size:1.8rem;font-weight:500;margin-bottom:8px;">Earn 50% Commission</h2>
          <p style="color:var(--text-secondary);font-size:1rem;margin-bottom:24px;max-width:600px;margin-left:auto;margin-right:auto;">
            On every bid pack purchased by providers you refer. Share your unique code and watch your earnings grow!
          </p>
          
          <div style="display:inline-flex;align-items:center;gap:16px;background:var(--bg-deep);border:2px solid var(--accent-gold);border-radius:var(--radius-lg);padding:16px 24px;margin-bottom:16px;">
            <div>
              <div style="font-size:0.85rem;color:var(--text-muted);">Your Referral Code</div>
              <div id="provider-referral-code" style="font-size:1.8rem;font-weight:700;color:var(--accent-gold);letter-spacing:2px;">----</div>
            </div>
            <button onclick="copyProviderReferralCode()" style="background:var(--accent-gold);color:#0a0a0f;border:none;padding:10px 16px;border-radius:var(--radius-sm);font-weight:600;cursor:pointer;transition:all 0.2s;">
              ðŸ“‹ Copy
            </button>
          </div>

          <div style="display:flex;justify-content:center;gap:12px;margin-top:16px;flex-wrap:wrap;">
            <button onclick="shareProviderReferral('sms')" style="display:inline-flex;align-items:center;gap:8px;padding:10px 20px;background:var(--bg-elevated);border:1px solid var(--border-subtle);border-radius:var(--radius-md);color:var(--text-primary);font-size:0.88rem;cursor:pointer;transition:all 0.2s;">
              ðŸ’¬ Share via Text
            </button>
            <button onclick="shareProviderReferral('email')" style="display:inline-flex;align-items:center;gap:8px;padding:10px 20px;background:var(--bg-elevated);border:1px solid var(--border-subtle);border-radius:var(--radius-md);color:var(--text-primary);font-size:0.88rem;cursor:pointer;transition:all 0.2s;">
              âœ‰ï¸ Share via Email
            </button>
          </div>
        </div>

        <div class="stats-grid" style="margin-bottom:32px;">
          <div class="stat-card">
            <div class="stat-icon blue">ðŸ‘¨â€ðŸ”§</div>
            <div class="stat-value" id="provider-ref-count">0</div>
            <div class="stat-label">Provider Referrals</div>
          </div>
          <div class="stat-card">
            <div class="stat-icon green">ðŸ’°</div>
            <div class="stat-value" id="provider-total-earnings">$0.00</div>
            <div class="stat-label">Total Earnings</div>
          </div>
          <div class="stat-card">
            <div class="stat-icon gold">â³</div>
            <div class="stat-value" id="provider-pending-balance">$0.00</div>
            <div class="stat-label">Pending Balance</div>
          </div>
        </div>

        <div class="card" style="margin-bottom:24px;">
          <div class="card-header">
            <h2 class="card-title">ðŸ“± Share via QR Code</h2>
          </div>
          <div style="text-align:center;padding:16px;">
            <p style="color:var(--text-secondary);font-size:0.9rem;margin-bottom:16px;">
              Other providers can scan this QR code to sign up with your referral
            </p>
            <div style="display:inline-block;background:#fff;padding:16px;border-radius:var(--radius-md);border:2px solid var(--accent-gold);">
              <canvas id="provider-qr-code" style="display:block;"></canvas>
            </div>
            <div style="margin-top:12px;">
              <button onclick="downloadProviderQRCode()" class="btn btn-secondary btn-sm">ðŸ“¥ Download QR Code</button>
            </div>
          </div>
        </div>

        <!-- Referral Codes Section - 3 Distinct QR Codes -->
        <div class="card" style="margin-bottom:24px;">
          <div class="card-header">
            <h2 class="card-title">ðŸŽ« Referral Codes</h2>
            <button onclick="loadReferralCodes()" class="btn btn-secondary btn-sm">ðŸ”„ Refresh</button>
          </div>
          <p style="color:var(--text-secondary);font-size:0.9rem;margin-bottom:20px;text-align:center;">
            Share these unique QR codes to grow your network and earn rewards
          </p>
          <div id="referral-codes-loading" style="text-align:center;padding:24px;display:none;">
            <div style="color:var(--text-muted);">Loading referral codes...</div>
          </div>
          <div id="referral-codes-grid" style="display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:24px;">
            
            <!-- Loyal Customer QR Code (Gold) -->
            <div class="referral-qr-card" style="background:linear-gradient(145deg,rgba(201,162,39,0.08),rgba(201,162,39,0.03));border:2px solid rgba(201,162,39,0.4);border-radius:var(--radius-lg);padding:20px;text-align:center;">
              <div style="display:flex;align-items:center;justify-content:center;gap:8px;margin-bottom:12px;">
                <span style="font-size:1.5rem;">ðŸ‘‘</span>
                <h3 style="font-size:1rem;font-weight:600;color:var(--accent-gold);">Loyal Customer</h3>
              </div>
              <div style="font-size:0.8rem;color:var(--text-secondary);margin-bottom:16px;">
                <div>âœ“ Skip identity verification</div>
                <div>âœ“ No 2% platform fee</div>
                <div>âœ“ Auto-linked to you</div>
              </div>
              <div style="display:inline-block;background:#fff;padding:12px;border-radius:var(--radius-md);border:3px solid var(--accent-gold);margin-bottom:12px;">
                <canvas id="loyal-customer-qr" style="display:block;"></canvas>
              </div>
              <div id="loyal-customer-code" style="font-family:monospace;font-size:0.85rem;color:var(--accent-gold);margin-bottom:12px;font-weight:600;">---</div>
              <div style="display:flex;gap:8px;justify-content:center;flex-wrap:wrap;">
                <button onclick="downloadReferralQR('loyal-customer')" class="btn btn-secondary btn-sm">ðŸ“¥ Download</button>
                <button onclick="copyReferralLink('loyal-customer')" class="btn btn-gold btn-sm">ðŸ“‹ Copy Link</button>
              </div>
            </div>

            <!-- New Member QR Code (Blue) -->
            <div class="referral-qr-card" style="background:linear-gradient(145deg,rgba(56,189,248,0.08),rgba(56,189,248,0.03));border:2px solid rgba(56,189,248,0.4);border-radius:var(--radius-lg);padding:20px;text-align:center;">
              <div style="display:flex;align-items:center;justify-content:center;gap:8px;margin-bottom:12px;">
                <span style="font-size:1.5rem;">ðŸŒŸ</span>
                <h3 style="font-size:1rem;font-weight:600;color:var(--accent-blue);">New Member</h3>
              </div>
              <div style="font-size:0.8rem;color:var(--text-secondary);margin-bottom:16px;">
                <div>âœ“ Standard signup flow</div>
                <div>âœ“ Referral bonus credits</div>
                <div>âœ“ Track your referrals</div>
              </div>
              <div style="display:inline-block;background:#fff;padding:12px;border-radius:var(--radius-md);border:3px solid var(--accent-blue);margin-bottom:12px;">
                <canvas id="new-member-qr" style="display:block;"></canvas>
              </div>
              <div id="new-member-code" style="font-family:monospace;font-size:0.85rem;color:var(--accent-blue);margin-bottom:12px;font-weight:600;">---</div>
              <div style="display:flex;gap:8px;justify-content:center;flex-wrap:wrap;">
                <button onclick="downloadReferralQR('new-member')" class="btn btn-secondary btn-sm">ðŸ“¥ Download</button>
                <button onclick="copyReferralLink('new-member')" class="btn btn-primary btn-sm">ðŸ“‹ Copy Link</button>
              </div>
            </div>

            <!-- Refer Provider QR Code (Green) -->
            <div class="referral-qr-card" style="background:linear-gradient(145deg,rgba(52,211,153,0.08),rgba(52,211,153,0.03));border:2px solid rgba(52,211,153,0.4);border-radius:var(--radius-lg);padding:20px;text-align:center;">
              <div style="display:flex;align-items:center;justify-content:center;gap:8px;margin-bottom:12px;">
                <span style="font-size:1.5rem;">ðŸ”§</span>
                <h3 style="font-size:1rem;font-weight:600;color:var(--accent-green);">Refer Provider</h3>
              </div>
              <div style="font-size:0.8rem;color:var(--text-secondary);margin-bottom:16px;">
                <div>âœ“ Provider application</div>
                <div>âœ“ Earn commission</div>
                <div>âœ“ Build your network</div>
              </div>
              <div style="display:inline-block;background:#fff;padding:12px;border-radius:var(--radius-md);border:3px solid var(--accent-green);margin-bottom:12px;">
                <canvas id="refer-provider-qr" style="display:block;"></canvas>
              </div>
              <div id="refer-provider-code" style="font-family:monospace;font-size:0.85rem;color:var(--accent-green);margin-bottom:12px;font-weight:600;">---</div>
              <div style="display:flex;gap:8px;justify-content:center;flex-wrap:wrap;">
                <button onclick="downloadReferralQR('refer-provider')" class="btn btn-secondary btn-sm">ðŸ“¥ Download</button>
                <button onclick="copyReferralLink('refer-provider')" class="btn btn-success btn-sm">ðŸ“‹ Copy Link</button>
              </div>
            </div>
          </div>
        </div>

        <div class="card" style="margin-bottom:24px;">
          <div class="card-header">
            <h2 class="card-title">ðŸ’¡ How It Works</h2>
          </div>
          <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:20px;">
            <div style="text-align:center;padding:16px;">
              <div style="width:48px;height:48px;background:var(--accent-gold-soft);border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:1.5rem;margin:0 auto 12px;">1</div>
              <div style="font-weight:600;margin-bottom:4px;">Share Your Code</div>
              <div style="font-size:0.85rem;color:var(--text-muted);">Share your unique referral code with other automotive professionals</div>
            </div>
            <div style="text-align:center;padding:16px;">
              <div style="width:48px;height:48px;background:var(--accent-gold-soft);border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:1.5rem;margin:0 auto 12px;">2</div>
              <div style="font-weight:600;margin-bottom:4px;">They Sign Up</div>
              <div style="font-size:0.85rem;color:var(--text-muted);">When they join as a provider using your code, they're linked to you</div>
            </div>
            <div style="text-align:center;padding:16px;">
              <div style="width:48px;height:48px;background:var(--accent-gold-soft);border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:1.5rem;margin:0 auto 12px;">3</div>
              <div style="font-weight:600;margin-bottom:4px;">You Earn 50%</div>
              <div style="font-size:0.85rem;color:var(--text-muted);">Earn 50% commission on every bid pack they purchase</div>
            </div>
          </div>
        </div>

        <div style="background:var(--bg-card);border:1px solid var(--border-subtle);border-radius:var(--radius-lg);padding:24px;text-align:center;">
          <p style="color:var(--text-secondary);margin-bottom:16px;">
            View detailed earnings, payout history, and more on your full Founder Dashboard
          </p>
          <a href="founder-dashboard.html" class="btn btn-primary">ðŸ“Š Open Founder Dashboard</a>
        </div>
      </div>
    </section>

    <!-- Loyalty Network Section -->
    <section id="loyalty-network" class="section">
      <div class="page-header">
        <h1 class="page-title">ðŸ‘¥ Loyalty Network</h1>
        <p class="page-subtitle">Track your referred members and providers in your network.</p>
      </div>

      <div id="loyalty-loading" style="text-align:center;padding:48px;">
        <div style="width:40px;height:40px;border:3px solid var(--border-subtle);border-top-color:var(--accent-gold);border-radius:50%;animation:spin 1s linear infinite;margin:0 auto 16px;"></div>
        <p style="color:var(--text-muted);">Loading your loyalty network...</p>
      </div>

      <div id="loyalty-content" style="display:none;">
        <div class="stats-grid" style="margin-bottom:24px;">
          <div class="stat-card" style="border-left:3px solid var(--accent-gold);">
            <div class="stat-icon gold">ðŸ‘‘</div>
            <div class="stat-value" id="loyalty-loyal-customers">0</div>
            <div class="stat-label">Loyal Customers</div>
          </div>
          <div class="stat-card" style="border-left:3px solid var(--accent-blue);">
            <div class="stat-icon blue">ðŸŒŸ</div>
            <div class="stat-value" id="loyalty-new-members">0</div>
            <div class="stat-label">New Members</div>
          </div>
          <div class="stat-card" style="border-left:3px solid var(--accent-green);">
            <div class="stat-icon green">ðŸ”§</div>
            <div class="stat-value" id="loyalty-providers">0</div>
            <div class="stat-label">Referred Providers</div>
          </div>
          <div class="stat-card" style="border:2px solid var(--accent-gold);">
            <div class="stat-icon gold">ðŸ“Š</div>
            <div class="stat-value" id="loyalty-total">0</div>
            <div class="stat-label">Total Network</div>
          </div>
        </div>

        <div class="card" style="margin-bottom:24px;">
          <div class="card-header">
            <h2 class="card-title">ðŸ“± QR Code Usage</h2>
            <button onclick="loadLoyaltyNetwork()" class="btn btn-secondary btn-sm">ðŸ”„ Refresh</button>
          </div>
          <div class="loyalty-qr-stats" id="loyalty-qr-usage">
            <div class="loyalty-qr-stat">
              <span class="loyalty-qr-stat-icon">ðŸ‘‘</span>
              <div>
                <div class="loyalty-qr-stat-value" id="qr-loyal-uses">0</div>
                <div class="loyalty-qr-stat-label">Loyal Customer Uses</div>
              </div>
            </div>
            <div class="loyalty-qr-stat">
              <span class="loyalty-qr-stat-icon">ðŸŒŸ</span>
              <div>
                <div class="loyalty-qr-stat-value" id="qr-member-uses">0</div>
                <div class="loyalty-qr-stat-label">New Member Uses</div>
              </div>
            </div>
            <div class="loyalty-qr-stat">
              <span class="loyalty-qr-stat-icon">ðŸ”§</span>
              <div>
                <div class="loyalty-qr-stat-value" id="qr-provider-uses">0</div>
                <div class="loyalty-qr-stat-label">Provider Uses</div>
              </div>
            </div>
          </div>
        </div>

        <div class="card">
          <div class="card-header">
            <h2 class="card-title">ðŸ• Recent Referrals</h2>
          </div>
          <div id="loyalty-referrals-list">
            <div class="empty-state" style="padding:32px;text-align:center;">
              <div style="font-size:2rem;margin-bottom:12px;">ðŸ‘¥</div>
              <p style="color:var(--text-muted);">No referrals yet. Share your QR codes to grow your network!</p>
              <button onclick="showSection('refer-providers')" class="btn btn-primary" style="margin-top:16px;">ðŸ”— Get Your QR Codes</button>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Emergency Queue Section -->
    <section id="emergencies" class="section">
      <div class="page-header">
        <h1 class="page-title">ðŸš¨ Emergency Queue</h1>
        <p class="page-subtitle">Nearby members need emergency roadside assistance.</p>
      </div>

      <div id="emergency-settings-notice" style="display:none;background:var(--accent-gold-soft);border:1px solid rgba(212,168,85,0.3);padding:16px 20px;border-radius:var(--radius-lg);margin-bottom:24px;">
        <strong>âš ï¸ Emergency services not enabled</strong>
        <p style="font-size:0.9rem;margin-top:4px;color:var(--text-secondary);">Enable emergency services in your <a href="#" onclick="showSection('profile')" style="color:var(--accent-gold);text-decoration:underline;">Business Profile</a> to receive emergency requests.</p>
      </div>

      <div class="card">
        <div class="card-header">
          <h2 class="card-title">ðŸ“ Nearby Emergencies</h2>
          <button class="btn btn-secondary btn-sm" onclick="refreshEmergencies()">ðŸ”„ Refresh</button>
        </div>
        <div id="emergency-queue">
          <div class="empty-state">
            <div class="empty-state-icon">âœ…</div>
            <p>No pending emergencies nearby</p>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="card-header">
          <h2 class="card-title">âœ“ Your Active Emergency</h2>
        </div>
        <div id="my-active-emergency">
          <div class="empty-state" style="padding:24px;">
            <p style="color:var(--text-muted);">No active emergency job</p>
          </div>
        </div>
      </div>
    </section>

    <!-- Fleet Services Section -->
    <section id="fleet-services" class="section">
      <div class="page-header">
        <h1 class="page-title">ðŸ¢ Fleet Services</h1>
        <p class="page-subtitle">Manage fleet accounts, bulk service batches, and high-volume jobs.</p>
      </div>

      <!-- Fleet Performance Metrics -->
      <div class="stats-grid" style="margin-bottom:24px;">
        <div class="stat-card">
          <div class="stat-icon gold">ðŸ†</div>
          <div class="stat-value" id="fleet-jobs-completed">0</div>
          <div class="stat-label">Fleet Jobs Completed</div>
        </div>
        <div class="stat-card">
          <div class="stat-icon blue">ðŸš—</div>
          <div class="stat-value" id="fleet-avg-vehicles">0</div>
          <div class="stat-label">Avg Vehicles per Batch</div>
        </div>
        <div class="stat-card">
          <div class="stat-icon green">ðŸ”„</div>
          <div class="stat-value" id="fleet-retention">--%</div>
          <div class="stat-label">Fleet Client Retention</div>
        </div>
        <div class="stat-card">
          <div class="stat-icon" style="background:rgba(168,85,247,0.12);">ðŸ“‹</div>
          <div class="stat-value" id="fleet-active-batches">0</div>
          <div class="stat-label">Active Batches</div>
        </div>
      </div>

      <!-- Fleet Tab Navigation -->
      <div class="fleet-tabs" id="fleet-tabs">
        <div class="fleet-tab active" data-fleet-tab="queue" onclick="switchFleetTab('queue')">
          ðŸ“¥ Job Queue <span id="fleet-queue-badge" class="nav-badge" style="display:none;margin-left:6px;">0</span>
        </div>
        <div class="fleet-tab" data-fleet-tab="batches" onclick="switchFleetTab('batches')">
          ðŸ“¦ Active Batches
        </div>
        <div class="fleet-tab" data-fleet-tab="completed" onclick="switchFleetTab('completed')">
          âœ… Completed
        </div>
      </div>

      <!-- Fleet Job Queue Section -->
      <div id="fleet-queue-section" class="fleet-section active">
        <div class="card">
          <div class="card-header">
            <h2 class="card-title">ðŸ“¥ Fleet Job Queue</h2>
            <button class="btn btn-secondary btn-sm" onclick="loadFleetJobQueue()">ðŸ”„ Refresh</button>
          </div>
          
          <!-- Fleet Account Benefits Info -->
          <div style="background:linear-gradient(135deg, var(--accent-gold-soft), rgba(212,168,85,0.05));border:1px solid rgba(212,168,85,0.3);border-radius:var(--radius-md);padding:16px;margin-bottom:20px;">
            <div style="display:flex;align-items:center;gap:12px;flex-wrap:wrap;">
              <span class="fleet-badge" style="background:linear-gradient(135deg, var(--accent-gold), #c49a45);color:#0a0a0f;padding:6px 14px;border-radius:100px;font-size:0.82rem;font-weight:600;">ðŸ¢ Fleet Account</span>
              <span style="color:var(--accent-green);font-size:0.88rem;font-weight:500;">âœ“ Guaranteed Payment</span>
              <span style="color:var(--accent-blue);font-size:0.88rem;font-weight:500;">ðŸ’° Volume Discounts</span>
              <span style="color:var(--text-secondary);font-size:0.88rem;">ðŸ”„ Recurring Service Potential</span>
            </div>
          </div>

          <div id="fleet-job-queue">
            <div class="empty-state">
              <div class="empty-state-icon">ðŸ¢</div>
              <p>No fleet job requests at the moment. Fleet requests from verified business accounts will appear here.</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Bulk Service Batches Section -->
      <div id="fleet-batches-section" class="fleet-section">
        <div class="card">
          <div class="card-header">
            <h2 class="card-title">ðŸ“¦ Active Bulk Service Batches</h2>
            <button class="btn btn-secondary btn-sm" onclick="loadFleetBatches()">ðŸ”„ Refresh</button>
          </div>

          <div id="fleet-batches-list">
            <div class="empty-state">
              <div class="empty-state-icon">ðŸ“¦</div>
              <p>No active bulk service batches. Accept fleet jobs to see batches here.</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Completed Fleet Jobs Section -->
      <div id="fleet-completed-section" class="fleet-section">
        <div class="card">
          <div class="card-header">
            <h2 class="card-title">âœ… Completed Fleet Jobs</h2>
          </div>
          <div id="fleet-completed-list">
            <div class="empty-state">
              <div class="empty-state-icon">âœ…</div>
              <p>No completed fleet jobs yet.</p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Background Checks Section -->
    <section id="background-checks" class="section">
      <div class="page-header">
        <h1 class="page-title">Background Verification</h1>
        <p class="page-subtitle">Verify your credentials and team members to build trust with customers. Background checks help ensure safety and reliability for our service marketplace.</p>
      </div>

      <!-- Provider's Own Background Check Card -->
      <div class="card" style="background:rgba(42,46,51,0.8);backdrop-filter:blur(12px);border:1px solid var(--border-subtle);">
        <div class="card-header">
          <h2 class="card-title" style="display:flex;align-items:center;gap:10px;">
            <span style="font-size:1.5rem;">ðŸ›¡ï¸</span> Your Background Check
          </h2>
          <div id="provider-check-badge"></div>
        </div>
        <div id="provider-check-content">
          <div class="empty-state">
            <div class="empty-state-icon">ðŸ”</div>
            <p>Loading background check status...</p>
          </div>
        </div>
      </div>

      <!-- Team Member Background Checks Card -->
      <div class="card" style="background:rgba(42,46,51,0.8);backdrop-filter:blur(12px);border:1px solid var(--border-subtle);">
        <div class="card-header">
          <h2 class="card-title" style="display:flex;align-items:center;gap:10px;">
            <span style="font-size:1.5rem;">ðŸ‘¥</span> Team Member Checks
          </h2>
          <button class="btn btn-primary btn-sm" onclick="openBackgroundCheckModal('team_member')">
            âž• Add Team Member Check
          </button>
        </div>
        <div id="team-checks-list">
          <div class="empty-state">
            <div class="empty-state-icon">ðŸ‘¥</div>
            <p>No team member background checks yet. Add team members to verify their credentials.</p>
          </div>
        </div>
      </div>

      <!-- Background Check Info Card -->
      <div class="card" style="background:linear-gradient(135deg,rgba(42,46,51,0.8),var(--accent-gold-soft));border:1px solid var(--accent-gold);backdrop-filter:blur(12px);">
        <div style="display:flex;align-items:flex-start;gap:16px;">
          <span style="font-size:2.5rem;">â„¹ï¸</span>
          <div>
            <h3 style="font-size:1.1rem;font-weight:600;margin-bottom:8px;">Why Background Checks Matter</h3>
            <ul style="color:var(--text-secondary);font-size:0.9rem;line-height:1.7;margin:0;padding-left:20px;">
              <li>Builds trust with customers and increases your chances of winning bids</li>
              <li>Verified providers are highlighted with a trusted badge on their profile</li>
              <li>Required for certain premium service categories and fleet contracts</li>
              <li>Checks are conducted by our trusted partner and typically complete within 24-72 hours</li>
            </ul>
          </div>
        </div>
      </div>
    </section>

    <!-- POS Integration Section -->
    <section id="pos-integration" class="section">
      <div class="page-header">
        <h1 class="page-title">ðŸ”— POS Integration</h1>
        <p class="page-subtitle">Connect your point-of-sale systems to sync transactions and unify your analytics</p>
      </div>

      <!-- POS Systems Grid -->
      <div class="pos-integrations-grid">
        <!-- Clover POS Card -->
        <div class="pos-integration-card" id="clover-card">
          <div class="pos-card-header">
            <div class="pos-provider-logo">
              <div class="pos-provider-icon clover">ðŸ€</div>
              <div>
                <div class="pos-provider-name">Clover POS</div>
                <div class="pos-provider-subtitle">Point of Sale System</div>
              </div>
            </div>
            <span class="pos-connection-badge disconnected" id="clover-status-badge">Not Connected</span>
          </div>

          <div id="clover-stats" class="pos-card-stats" style="display:none;">
            <div class="pos-stat">
              <div class="pos-stat-value" id="clover-tx-count">0</div>
              <div class="pos-stat-label">Transactions</div>
            </div>
            <div class="pos-stat">
              <div class="pos-stat-value" id="clover-last-sync-display">â€”</div>
              <div class="pos-stat-label">Last Sync</div>
            </div>
          </div>

          <div class="pos-card-actions">
            <button id="clover-connect-btn" class="btn btn-primary" onclick="connectClover()">
              ðŸ”— Connect Clover
            </button>
            <button id="clover-disconnect-btn" class="btn btn-secondary" onclick="disconnectClover()" style="display:none">
              âŒ Disconnect
            </button>
            <button id="clover-sync-btn" class="btn btn-secondary" onclick="syncClover()" style="display:none">
              ðŸ”„ Sync Now
            </button>
          </div>

          <div id="clover-connection-info" class="pos-card-info" style="display:none">
            <div class="pos-card-info-row">
              <span>Merchant ID</span>
              <span id="clover-merchant-id">â€”</span>
            </div>
            <div class="pos-card-info-row">
              <span>Last Sync</span>
              <span id="clover-last-sync">Never</span>
            </div>
            <div class="pos-card-info-row">
              <span>Environment</span>
              <span id="clover-environment">â€”</span>
            </div>
          </div>
        </div>

        <!-- Square POS Card -->
        <div class="pos-integration-card" id="square-card">
          <div class="pos-card-header">
            <div class="pos-provider-logo">
              <div class="pos-provider-icon square">â¬›</div>
              <div>
                <div class="pos-provider-name">Square</div>
                <div class="pos-provider-subtitle">Payments & POS</div>
              </div>
            </div>
            <span class="pos-connection-badge disconnected" id="square-status-badge">Not Connected</span>
          </div>

          <div id="square-stats" class="pos-card-stats" style="display:none;">
            <div class="pos-stat">
              <div class="pos-stat-value" id="square-tx-count">0</div>
              <div class="pos-stat-label">Transactions</div>
            </div>
            <div class="pos-stat">
              <div class="pos-stat-value" id="square-last-sync-display">â€”</div>
              <div class="pos-stat-label">Last Sync</div>
            </div>
          </div>

          <div class="pos-card-actions">
            <button id="square-connect-btn" class="btn btn-primary" onclick="connectSquare()">
              ðŸ”— Connect Square
            </button>
            <button id="square-disconnect-btn" class="btn btn-secondary" onclick="disconnectSquare()" style="display:none">
              âŒ Disconnect
            </button>
            <button id="square-sync-btn" class="btn btn-secondary" onclick="syncSquareTransactions()" style="display:none">
              ðŸ”„ Sync Now
            </button>
          </div>

          <div id="square-connection-info" class="pos-card-info" style="display:none">
            <div class="pos-card-info-row">
              <span>Merchant ID</span>
              <span id="square-merchant-id">â€”</span>
            </div>
            <div class="pos-card-info-row">
              <span>Last Sync</span>
              <span id="square-last-sync">Never</span>
            </div>
            <div class="pos-card-info-row">
              <span>Location</span>
              <span id="square-location">â€”</span>
            </div>
          </div>
        </div>
      </div>

      <!-- All POS Transactions Section -->
      <div class="all-pos-transactions" id="all-pos-transactions-section">
        <div class="card-header">
          <h3 class="card-title">ðŸ“Š All POS Transactions</h3>
          <button class="btn btn-secondary btn-sm" onclick="loadAllPosTransactions()">ðŸ”„ Refresh All</button>
        </div>
        <table class="transactions-table">
          <thead>
            <tr>
              <th>Date</th>
              <th>Source</th>
              <th>Amount</th>
              <th>Card</th>
              <th>Status</th>
            </tr>
          </thead>
          <tbody id="all-pos-transactions-body">
            <tr>
              <td colspan="5" style="text-align:center;padding:24px;color:var(--text-muted);">Connect a POS system to see transactions</td>
            </tr>
          </tbody>
        </table>
        <a href="#" onclick="showSection('pos-analytics'); return false;" class="view-all-link">View Full Analytics â†’</a>
      </div>

      <!-- Info Card -->
      <div class="card" style="background:linear-gradient(135deg,rgba(42,46,51,0.8),var(--accent-blue-soft));border:1px solid var(--accent-blue);backdrop-filter:blur(12px);margin-top:24px;">
        <div style="display:flex;align-items:flex-start;gap:16px;">
          <span style="font-size:2.5rem;">ðŸ’¡</span>
          <div>
            <h3 style="font-size:1.1rem;font-weight:600;margin-bottom:8px;">Why Connect Your POS?</h3>
            <ul style="color:var(--text-secondary);font-size:0.9rem;line-height:1.7;margin:0;padding-left:20px;">
              <li>See all your revenue in one place â€” walk-ins, marketplace jobs, and more</li>
              <li>Get unified analytics and insights across all payment sources</li>
              <li>Automatic transaction sync keeps your records up to date</li>
              <li>Export comprehensive reports for accounting and taxes</li>
            </ul>
          </div>
        </div>
      </div>
    </section>
    
    <div style="text-align:center;padding:40px 20px 20px;font-size:0.8rem;color:var(--text-muted);">
      Â© 2025 My Car Concierge. All rights reserved. - IMOR
    </div>
  </main>

  <!-- Bid Modal -->
  <div class="modal-backdrop" id="bid-modal">
    <div class="modal">
      <div class="modal-header"><h3 class="modal-title">Submit Bid</h3><button class="modal-close" onclick="closeModal('bid-modal')">Ã—</button></div>
      <div class="modal-body">
        <p id="bid-package-title" style="font-weight:600;margin-bottom:16px;"></p>
        
        <!-- Bid Calculator Toggle -->
        <div class="bid-calculator-toggle" onclick="toggleBidCalculator()">
          <span>ðŸ“Š</span>
          <span>Use Bid Calculator</span>
          <span class="toggle-icon">â–¼</span>
        </div>
        
        <!-- Bid Calculator Container -->
        <div class="bid-calculator-container" id="bid-calculator">
          <!-- Parts Cost -->
          <div class="calc-section">
            <div class="calc-section-title">ðŸ’° Cost Breakdown</div>
            <div class="calc-row">
              <div class="calc-input-group" style="flex:2;">
                <span class="calc-input-prefix">$</span>
                <input type="number" class="calc-input" id="calc-parts" placeholder="0.00" min="0" step="0.01" oninput="updateBidCalculation()">
                <span class="calc-input-suffix">Parts</span>
              </div>
            </div>
            
            <!-- Labor: Hours Ã— Rate -->
            <div class="calc-row">
              <div class="calc-input-group">
                <input type="number" class="calc-input" id="calc-labor-hours" placeholder="0" min="0" step="0.5" oninput="updateBidCalculation()">
                <span class="calc-input-suffix">hrs</span>
              </div>
              <span class="calc-multiply">Ã—</span>
              <div class="calc-input-group">
                <span class="calc-input-prefix">$</span>
                <input type="number" class="calc-input" id="calc-labor-rate" placeholder="75" min="0" step="1" oninput="updateBidCalculation()">
                <span class="calc-input-suffix">/hr</span>
              </div>
            </div>
          </div>
          
          <!-- Profit Margin Slider -->
          <div class="calc-section">
            <div class="calc-section-title">ðŸ“ˆ Profit Margin</div>
            <div class="calc-row">
              <div class="calc-slider-container">
                <input type="range" class="calc-slider" id="calc-profit-margin" min="10" max="40" value="20" oninput="updateBidCalculation()">
              </div>
              <span class="calc-slider-value" id="calc-profit-value">20%</span>
            </div>
          </div>
          
          <!-- Optional Fees -->
          <div class="calc-section">
            <div class="calc-section-title">ðŸš— Additional Fees (Optional)</div>
            
            <!-- Travel/Mileage -->
            <div class="calc-optional-row">
              <input type="checkbox" id="calc-travel-enabled" onchange="updateBidCalculation()">
              <label class="calc-optional-label" for="calc-travel-enabled">Travel/Mileage (mobile services)</label>
              <div style="display:flex;align-items:center;gap:4px;">
                <span style="color:var(--text-muted);">$</span>
                <input type="number" class="calc-optional-input" id="calc-travel" placeholder="0" min="0" oninput="updateBidCalculation()">
              </div>
            </div>
            
            <!-- Transport/Tow -->
            <div class="calc-optional-row">
              <input type="checkbox" id="calc-transport-enabled" onchange="updateBidCalculation()">
              <label class="calc-optional-label" for="calc-transport-enabled">Transport/Tow (destination services)</label>
              <div style="display:flex;align-items:center;gap:4px;">
                <span style="color:var(--text-muted);">$</span>
                <input type="number" class="calc-optional-input" id="calc-transport" placeholder="0" min="0" oninput="updateBidCalculation()">
              </div>
            </div>
            
            <!-- Urgency Premium -->
            <div class="calc-urgency-row" id="calc-urgency-row">
              <div class="calc-urgency-label">
                <span>âš¡ Rush/Urgency Premium</span>
                <span class="calc-urgency-badge">+25%</span>
              </div>
              <label class="calc-toggle-switch">
                <input type="checkbox" id="calc-urgency" onchange="updateBidCalculation()">
                <span class="calc-toggle-slider"></span>
              </label>
            </div>
          </div>
          
          <!-- Live Calculation Breakdown -->
          <div class="calc-breakdown" id="calc-breakdown">
            <div class="calc-breakdown-row">
              <span>Parts:</span>
              <span id="calc-display-parts">$0.00</span>
            </div>
            <div class="calc-breakdown-row">
              <span>Labor:<span class="label-detail" id="calc-display-labor-detail">(0 hrs Ã— $75/hr)</span></span>
              <span id="calc-display-labor">$0.00</span>
            </div>
            <hr class="calc-breakdown-divider">
            <div class="calc-breakdown-row highlight">
              <span>Subtotal:</span>
              <span id="calc-display-subtotal">$0.00</span>
            </div>
            <div class="calc-breakdown-row add">
              <span>Profit (<span id="calc-display-profit-pct">20</span>%):</span>
              <span id="calc-display-profit">+$0.00</span>
            </div>
            <div class="calc-breakdown-row add" id="calc-row-travel" style="display:none;">
              <span>Travel:</span>
              <span id="calc-display-travel">+$0.00</span>
            </div>
            <div class="calc-breakdown-row add" id="calc-row-transport" style="display:none;">
              <span>Transport:</span>
              <span id="calc-display-transport">+$0.00</span>
            </div>
            <div class="calc-breakdown-row add" id="calc-row-rush" style="display:none;">
              <span>Rush Fee (25%):</span>
              <span id="calc-display-rush">+$0.00</span>
            </div>
            <hr class="calc-breakdown-divider">
            <div class="calc-breakdown-row highlight">
              <span>Subtotal:</span>
              <span id="calc-display-pretax">$0.00</span>
            </div>
            <div class="calc-breakdown-row">
              <span>Est. Tax (<span id="calc-display-tax-pct">0.0</span>%):</span>
              <span id="calc-display-tax">$0.00</span>
            </div>
            <div class="calc-breakdown-total">
              <span>ALL-INCLUSIVE:</span>
              <span id="calc-display-total">$0.00</span>
            </div>
            <div class="calc-breakdown-fee">
              <span>Platform Fee (10%):</span>
              <span id="calc-display-platform-fee">-$0.00</span>
            </div>
            <div class="calc-breakdown-net">
              <span>Your Net Earnings:</span>
              <span id="calc-display-net">$0.00</span>
            </div>
          </div>
          
          <!-- Competition Insights -->
          <div class="calc-competition" id="calc-competition">
            <div class="calc-competition-title">
              <span>ðŸ“Š</span>
              <span>Competition Insights</span>
            </div>
            <div class="calc-competition-stats">
              <div class="calc-competition-stat">
                <span>Avg bid for <strong id="calc-comp-category">this category</strong>:</span>
                <strong id="calc-comp-range">$0 - $0</strong>
              </div>
              <div class="calc-competition-stat">
                <span id="calc-comp-count">0</span> providers have bid
              </div>
            </div>
            <div class="calc-gauge">
              <div class="calc-gauge-fill competitive" id="calc-gauge-fill" style="width:50%;"></div>
              <div class="calc-gauge-marker" id="calc-gauge-marker" style="left:50%;"></div>
            </div>
            <div class="calc-gauge-labels">
              <span>Low</span>
              <span>Competitive</span>
              <span>High</span>
            </div>
            <div class="calc-gauge-position competitive" id="calc-gauge-position">Competitive</div>
          </div>
          
          <!-- Apply Button -->
          <button class="calc-apply-btn" onclick="applyCalculatorToForm()">
            <span>âœ“</span>
            <span>Apply to Bid Form</span>
          </button>
        </div>
        
        <!-- Destination Service Details (shown conditionally) -->
        <div id="bid-destination-details" style="display:none;background:linear-gradient(135deg,rgba(74,124,255,0.1),rgba(74,124,255,0.02));border:1px solid rgba(74,124,255,0.3);border-radius:var(--radius-md);padding:16px;margin-bottom:20px;">
          <div style="display:flex;align-items:flex-start;gap:12px;">
            <span style="font-size:1.5rem;">ðŸš—</span>
            <div style="flex:1;">
              <h4 style="margin:0 0 12px 0;font-size:0.95rem;color:var(--accent-blue);">Destination Service Details</h4>
              <div style="display:grid;gap:8px;font-size:0.88rem;">
                <div id="bid-dest-service-type" style="color:var(--text-secondary);"></div>
                <div style="display:flex;align-items:flex-start;gap:8px;">
                  <span>ðŸ“</span>
                  <div>
                    <div style="color:var(--text-muted);font-size:0.8rem;">Pickup Location</div>
                    <div id="bid-dest-pickup" style="color:var(--text-primary);"></div>
                  </div>
                </div>
                <div style="display:flex;align-items:flex-start;gap:8px;">
                  <span>ðŸ</span>
                  <div>
                    <div style="color:var(--text-muted);font-size:0.8rem;">Dropoff Location</div>
                    <div id="bid-dest-dropoff" style="color:var(--text-primary);"></div>
                  </div>
                </div>
                <div id="bid-dest-schedule" style="display:flex;align-items:center;gap:8px;color:var(--text-secondary);"></div>
                <div id="bid-dest-instructions" style="display:none;margin-top:8px;padding:10px;background:var(--bg-input);border-radius:var(--radius-sm);font-size:0.85rem;color:var(--text-secondary);"></div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- All-Inclusive Pricing Notice -->
        <div style="background:linear-gradient(135deg,rgba(16,185,129,0.1),rgba(16,185,129,0.02));border:1px solid rgba(16,185,129,0.3);border-radius:var(--radius-md);padding:16px;margin-bottom:20px;">
          <div style="display:flex;align-items:flex-start;gap:12px;">
            <span style="font-size:1.5rem;">ðŸ’°</span>
            <div>
              <h4 style="margin:0 0 8px 0;font-size:0.95rem;color:#10b981;">All-Inclusive Pricing Required</h4>
              <p style="color:var(--text-secondary);font-size:0.85rem;margin:0 0 12px 0;line-height:1.5;">Your bid must be the <strong>total amount</strong> the member will pay. No hidden fees or surprises.</p>
              <div style="display:grid;grid-template-columns:1fr 1fr;gap:6px;font-size:0.8rem;color:var(--text-secondary);">
                <div>âœ“ Parts & materials</div>
                <div>âœ“ Labor charges</div>
                <div>âœ“ Applicable taxes</div>
                <div>âœ“ Shop/service fees</div>
                <div>âœ“ Disposal fees</div>
                <div>âœ“ Platform fees</div>
              </div>
            </div>
          </div>
        </div>
        
        <div class="form-row">
          <div class="form-group"><label class="form-label">Total Price ($) - All Inclusive *</label>
            <select class="form-input" id="bid-price" required>
              <option value="">Select Amount</option>
              <option value="20">$20</option>
              <option value="50">$50</option>
              <option value="75">$75</option>
              <option value="100">$100</option>
              <option value="150">$150</option>
              <option value="200">$200</option>
              <option value="250">$250</option>
              <option value="300">$300</option>
              <option value="350">$350</option>
              <option value="400">$400</option>
              <option value="500">$500</option>
              <option value="750">$750</option>
              <option value="1000">$1,000</option>
              <option value="1500">$1,500</option>
              <option value="2000">$2,000</option>
              <option value="2500">$2,500</option>
              <option value="3000">$3,000</option>
              <option value="5000">$5,000</option>
              <option value="custom">Custom Amount...</option>
            </select>
            <input type="number" class="form-input" id="bid-price-custom" placeholder="Enter custom amount" min="0" style="display:none;margin-top:8px;">
          </div>
          <div class="form-group"><label class="form-label">Estimated Duration</label><input type="text" class="form-input" id="bid-duration" placeholder="2-3 hours"></div>
        </div>
        <div class="form-row">
          <div class="form-group"><label class="form-label">Parts Cost ($)</label><input type="number" class="form-input" id="bid-parts" placeholder="100" min="0"></div>
          <div class="form-group"><label class="form-label">Labor Cost ($)</label><input type="number" class="form-input" id="bid-labor" placeholder="150" min="0"></div>
        </div>
        <div class="form-group"><label class="form-label">Your Availability</label><input type="text" class="form-input" id="bid-availability" placeholder="Available Mon-Fri, can start next week"></div>
        <div class="form-group"><label class="form-label">Notes for Member</label><textarea class="form-textarea" id="bid-notes" placeholder="Describe your approach, experience with this type of work, etc."></textarea></div>
        
        <!-- All-Inclusive Pricing Confirmation -->
        <div class="form-group" style="margin-top:16px;padding:12px;background:var(--bg-input);border:1px solid var(--border-subtle);border-radius:var(--radius-md);">
          <label style="display:flex;align-items:flex-start;gap:10px;cursor:pointer;">
            <input type="checkbox" id="bid-pricing-confirm" style="width:20px;height:20px;margin-top:2px;flex-shrink:0;">
            <span style="font-size:0.9rem;line-height:1.5;">
              <strong>I confirm this bid is all-inclusive</strong><br>
              <span style="color:var(--text-secondary);font-size:0.85rem;">My quoted price includes all parts, labor, taxes, shop fees, disposal fees, and platform fees. The member will pay exactly this amount with no hidden charges.</span>
            </span>
          </label>
        </div>
      </div>
      <div class="modal-footer"><button class="btn btn-secondary" onclick="closeModal('bid-modal')">Cancel</button><button class="btn btn-primary" onclick="submitBid()">Submit Bid</button></div>
    </div>
  </div>

  <!-- Package Details Modal -->
  <div class="modal-backdrop" id="package-details-modal">
    <div class="modal" style="max-width:700px;">
      <div class="modal-header"><h3 class="modal-title" id="package-details-title">Package Details</h3><button class="modal-close" onclick="closeModal('package-details-modal')">Ã—</button></div>
      <div class="modal-body" id="package-details-body"></div>
    </div>
  </div>

  <!-- Message Modal -->
  <div class="modal-backdrop" id="message-modal">
    <div class="modal">
      <div class="modal-header"><h3 class="modal-title" id="message-modal-title">Message Member</h3><button class="modal-close" onclick="closeModal('message-modal')">Ã—</button></div>
      <div class="modal-body">
        <div class="messages-container" id="message-thread"></div>
        <div class="message-input-row">
          <input type="text" class="form-input" id="message-input" placeholder="Type your message...">
          <button class="btn btn-primary" onclick="sendMessage()">Send</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Job Update Modal (Urgent Updates System) -->
  <div class="modal-backdrop" id="upsell-modal">
    <div class="modal" style="max-width:550px;">
      <div class="modal-header">
        <h3 class="modal-title" id="update-modal-title">Send Update to Member</h3>
        <button class="modal-close" onclick="closeModal('upsell-modal')">Ã—</button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label class="form-label">Update Type *</label>
          <div class="update-type-grid" style="display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:16px;">
            <div class="update-type-card active" data-type="cost_increase" onclick="selectUpdateType('cost_increase')" style="border:2px solid var(--accent-orange);background:var(--accent-orange-soft);padding:16px;border-radius:var(--radius-md);cursor:pointer;text-align:center;">
              <div style="font-size:24px;margin-bottom:6px;">ðŸ’°</div>
              <div style="font-weight:600;color:var(--accent-orange);">Cost Increase</div>
              <div style="font-size:0.8rem;color:var(--text-secondary);">Additional work needed</div>
            </div>
            <div class="update-type-card" data-type="car_ready" onclick="selectUpdateType('car_ready')" style="border:2px solid var(--border-subtle);background:var(--bg-input);padding:16px;border-radius:var(--radius-md);cursor:pointer;text-align:center;">
              <div style="font-size:24px;margin-bottom:6px;">âœ…</div>
              <div style="font-weight:600;color:var(--accent-green);">Car Ready</div>
              <div style="font-size:0.8rem;color:var(--text-secondary);">Vehicle ready for pickup</div>
            </div>
            <div class="update-type-card" data-type="work_paused" onclick="selectUpdateType('work_paused')" style="border:2px solid var(--border-subtle);background:var(--bg-input);padding:16px;border-radius:var(--radius-md);cursor:pointer;text-align:center;">
              <div style="font-size:24px;margin-bottom:6px;">â¸ï¸</div>
              <div style="font-weight:600;color:var(--accent-red);">Work Paused</div>
              <div style="font-size:0.8rem;color:var(--text-secondary);">Need decision to proceed</div>
            </div>
            <div class="update-type-card" data-type="question" onclick="selectUpdateType('question')" style="border:2px solid var(--border-subtle);background:var(--bg-input);padding:16px;border-radius:var(--radius-md);cursor:pointer;text-align:center;">
              <div style="font-size:24px;margin-bottom:6px;">â“</div>
              <div style="font-weight:600;color:var(--accent-blue);">Question</div>
              <div style="font-size:0.8rem;color:var(--text-secondary);">Need member input</div>
            </div>
            <div class="update-type-card" data-type="request_call" onclick="selectUpdateType('request_call')" style="border:2px solid var(--border-subtle);background:var(--bg-input);padding:16px;border-radius:var(--radius-md);cursor:pointer;text-align:center;">
              <div style="font-size:24px;margin-bottom:6px;">ðŸ“ž</div>
              <div style="font-weight:600;color:#9370DB;">Request Call</div>
              <div style="font-size:0.8rem;color:var(--text-secondary);">Need to speak directly</div>
            </div>
          </div>
          <input type="hidden" id="upsell-update-type" value="cost_increase">
        </div>

        <div id="update-alert-box" class="alert" style="background:var(--accent-orange-soft);border:1px solid rgba(245,158,11,0.3);color:var(--accent-orange);margin-bottom:20px;padding:16px;border-radius:var(--radius-md);">
          <strong>Cost Increase:</strong> The member has <strong>4 hours</strong> to approve the new total. If no response, you may suspend work until they respond.
          <div style="margin-top:8px;font-size:0.85rem;opacity:0.9;">âš ï¸ The new amount must be all-inclusive (parts, labor, taxes, all fees).</div>
        </div>

        <div class="form-group">
          <label class="form-label" id="upsell-title-label">Issue Found *</label>
          <input type="text" class="form-input" id="upsell-title" placeholder="e.g., Worn brake pads, Leaking coolant hose">
        </div>

        <div class="form-group">
          <label class="form-label">Details</label>
          <textarea class="form-textarea" id="upsell-description" placeholder="Explain the situation to the member..."></textarea>
        </div>

        <div id="cost-fields" class="form-row">
          <div class="form-group">
            <label class="form-label">New Total Price ($) - All Inclusive *</label>
            <input type="number" class="form-input" id="upsell-cost" placeholder="Enter new total (not just the difference)" min="0" step="0.01">
            <div style="font-size:0.75rem;color:var(--text-muted);margin-top:4px;">Enter the complete new total, including all parts, labor, taxes, and fees.</div>
          </div>
          <div class="form-group">
            <label class="form-label">Urgency</label>
            <select class="form-select" id="upsell-urgency">
              <option value="critical">ðŸ”´ Critical - Safety issue</option>
              <option value="recommended" selected>ðŸŸ¡ Recommended - Should address soon</option>
              <option value="optional">ðŸŸ¢ Optional - Can wait</option>
            </select>
          </div>
        </div>

        <div class="form-group" id="photo-upload-section">
          <label class="form-label">Photo Evidence (recommended)</label>
          <div style="border:2px dashed var(--border-subtle);border-radius:var(--radius-md);padding:20px;text-align:center;cursor:pointer;" onclick="document.getElementById('upsell-photos').click()">
            <div style="font-size:24px;margin-bottom:8px;">ðŸ“¸</div>
            <div style="color:var(--text-secondary);font-size:0.9rem;">Click to upload photos</div>
            <input type="file" id="upsell-photos" multiple accept="image/*" style="display:none;">
          </div>
        </div>

        <div class="form-group">
          <label style="display:flex;align-items:center;gap:8px;cursor:pointer;">
            <input type="checkbox" id="upsell-urgent" style="width:18px;height:18px;">
            <span style="font-weight:500;">ðŸš¨ Mark as URGENT - Send immediate notification</span>
          </label>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="closeModal('upsell-modal')">Cancel</button>
        <button class="btn btn-primary" id="send-update-btn" onclick="submitUpsellRequest()">Send to Member</button>
      </div>
    </div>
  </div>

  <!-- Provider Schedule Proposal Modal -->
  <div class="modal-backdrop" id="provider-schedule-modal">
    <div class="modal">
      <div class="modal-header">
        <h3 class="modal-title">ðŸ“… Propose Service Appointment</h3>
        <button class="modal-close" onclick="closeModal('provider-schedule-modal')">Ã—</button>
      </div>
      <div class="modal-body">
        <div class="alert" style="background:var(--accent-gold-soft);border:1px solid rgba(212,168,85,0.3);color:var(--accent-gold);margin-bottom:20px;padding:16px;border-radius:var(--radius-md);">
          ðŸ“… Propose a date and time for the service. The member will be notified and can confirm or suggest alternatives.
        </div>
        <input type="hidden" id="schedule-package-id">
        <input type="hidden" id="schedule-member-id">
        <input type="hidden" id="schedule-provider-id">
        <div class="form-group">
          <label class="form-label">Proposed Date *</label>
          <input type="date" class="form-input" id="schedule-date" required>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label class="form-label">Start Time</label>
            <input type="time" class="form-input" id="schedule-time-start" value="09:00">
          </div>
          <div class="form-group">
            <label class="form-label">End Time</label>
            <input type="time" class="form-input" id="schedule-time-end" value="17:00">
          </div>
        </div>
        <div class="form-group">
          <label class="form-label">Estimated Days to Complete</label>
          <select class="form-input" id="schedule-duration">
            <option value="1">Same day</option>
            <option value="2">2 days</option>
            <option value="3">3 days</option>
            <option value="5">Up to a week</option>
            <option value="7">1 week+</option>
          </select>
        </div>
        <div class="form-group">
          <label class="form-label">Notes for Member</label>
          <textarea class="form-textarea" id="schedule-notes" placeholder="Any special instructions or details about timing..."></textarea>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="closeModal('provider-schedule-modal')">Cancel</button>
        <button class="btn btn-primary" onclick="submitProviderScheduleProposal()">ðŸ“… Send Proposal</button>
      </div>
    </div>
  </div>

  <!-- Provider Counter Proposal Modal -->
  <div class="modal-backdrop" id="provider-counter-modal">
    <div class="modal">
      <div class="modal-header">
        <h3 class="modal-title">ðŸ”„ Propose New Time</h3>
        <button class="modal-close" onclick="closeModal('provider-counter-modal')">Ã—</button>
      </div>
      <div class="modal-body">
        <div class="alert" style="background:var(--accent-blue-soft);border:1px solid rgba(74,124,255,0.3);color:var(--accent-blue);margin-bottom:20px;padding:16px;border-radius:var(--radius-md);">
          The proposed time doesn't work? Suggest an alternative and the member will be notified.
        </div>
        <input type="hidden" id="counter-appointment-id">
        <input type="hidden" id="counter-package-id">
        <div class="form-group">
          <label class="form-label">New Proposed Date *</label>
          <input type="date" class="form-input" id="counter-date" required>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label class="form-label">Start Time</label>
            <input type="time" class="form-input" id="counter-time-start" value="09:00">
          </div>
          <div class="form-group">
            <label class="form-label">End Time</label>
            <input type="time" class="form-input" id="counter-time-end" value="17:00">
          </div>
        </div>
        <div class="form-group">
          <label class="form-label">Reason for Change</label>
          <textarea class="form-textarea" id="counter-notes" placeholder="Explain why this time works better..."></textarea>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="closeModal('provider-counter-modal')">Cancel</button>
        <button class="btn btn-primary" onclick="submitProviderCounterProposal()">ðŸ”„ Propose New Time</button>
      </div>
    </div>
  </div>

  <!-- Provider Location Share Modal -->
  <div class="modal-backdrop" id="provider-location-modal">
    <div class="modal">
      <div class="modal-header">
        <h3 class="modal-title">ðŸ“ Share Your Location</h3>
        <button class="modal-close" onclick="closeModal('provider-location-modal')">Ã—</button>
      </div>
      <div class="modal-body">
        <div class="alert" style="background:var(--accent-gold-soft);border:1px solid rgba(212,168,85,0.3);color:var(--accent-gold);margin-bottom:20px;padding:16px;border-radius:var(--radius-md);">
          ðŸ“ Share your current location with the member. This is useful for pickups or when you're on your way.
        </div>
        <input type="hidden" id="location-package-id">
        <input type="hidden" id="location-member-id">
        <div class="form-group">
          <label class="form-label">Context</label>
          <select class="form-input" id="location-context">
            <option value="shop_location">Shop Location</option>
            <option value="on_my_way">On My Way for Pickup</option>
            <option value="delivering">Delivering Vehicle</option>
            <option value="general">General</option>
          </select>
        </div>
        <div class="form-group">
          <label class="form-label">Message (optional)</label>
          <input type="text" class="form-input" id="location-message" placeholder="e.g., I'll be there in 15 minutes">
        </div>
        <div id="location-status" style="display:none;padding:16px;background:var(--bg-input);border-radius:var(--radius-md);margin-top:16px;"></div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="closeModal('provider-location-modal')">Cancel</button>
        <button class="btn btn-primary" id="share-location-btn" onclick="executeProviderLocationShare()">ðŸ“ Share Location</button>
      </div>
    </div>
  </div>

  <!-- Evidence Capture Modal -->
  <div class="modal-backdrop" id="evidence-modal">
    <div class="modal" style="max-width:640px;">
      <div class="modal-header">
        <h3 class="modal-title">ðŸ“¸ <span id="evidence-modal-title">Capture Evidence</span></h3>
        <button class="modal-close" onclick="closeModal('evidence-modal')">Ã—</button>
      </div>
      <div class="modal-body">
        <input type="hidden" id="evidence-package-id">
        <input type="hidden" id="evidence-type">
        
        <div class="form-group">
          <label class="form-label">Photos (up to 10) *</label>
          <div style="display:flex;flex-wrap:wrap;gap:10px;margin-bottom:12px;" id="evidence-photo-preview"></div>
          <input type="file" id="evidence-photos" accept="image/*" multiple onchange="previewEvidencePhotos()" style="display:none;">
          <button type="button" class="btn btn-secondary" onclick="document.getElementById('evidence-photos').click()">ðŸ“· Add Photos</button>
          <p class="form-hint">Take photos of vehicle condition, odometer, fuel gauge</p>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="form-label">Odometer Reading *</label>
            <input type="number" class="form-input" id="evidence-odometer" placeholder="e.g., 45230" required>
          </div>
          <div class="form-group">
            <label class="form-label">Fuel Level *</label>
            <select class="form-input" id="evidence-fuel" required>
              <option value="">Select...</option>
              <option value="empty">Empty</option>
              <option value="1/4">1/4</option>
              <option value="1/2">1/2</option>
              <option value="3/4">3/4</option>
              <option value="full">Full</option>
            </select>
          </div>
        </div>

        <div class="form-group">
          <label class="form-label">Exterior Condition</label>
          <textarea class="form-textarea" id="evidence-exterior" placeholder="Note any scratches, dents, or damage on the exterior..."></textarea>
        </div>

        <div class="form-group">
          <label class="form-label">Interior Condition</label>
          <textarea class="form-textarea" id="evidence-interior" placeholder="Note interior condition, cleanliness, any damage..."></textarea>
        </div>

        <div class="form-group">
          <label class="form-label">General Notes</label>
          <textarea class="form-textarea" id="evidence-notes" placeholder="Any additional observations..."></textarea>
        </div>

        <div id="evidence-upload-status" style="display:none;padding:16px;background:var(--bg-input);border-radius:var(--radius-md);margin-top:16px;"></div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="closeModal('evidence-modal')">Cancel</button>
        <button class="btn btn-primary" id="submit-evidence-btn" onclick="submitEvidence()">ðŸ“¸ Save Evidence</button>
      </div>
    </div>
  </div>

  <!-- Key Exchange Modal -->
  <div class="modal-backdrop" id="key-exchange-modal">
    <div class="modal" style="max-width:640px;">
      <div class="modal-header">
        <h3 class="modal-title">ðŸ”‘ <span id="key-exchange-modal-title">Key Exchange Verification</span></h3>
        <button class="modal-close" onclick="closeModal('key-exchange-modal')">Ã—</button>
      </div>
      <div class="modal-body">
        <input type="hidden" id="key-exchange-package-id">
        <input type="hidden" id="key-exchange-stage">
        
        <div class="alert" style="background:var(--accent-gold-soft);border:1px solid rgba(212,168,85,0.3);color:var(--accent-gold);margin-bottom:20px;padding:16px;border-radius:var(--radius-md);">
          ðŸ”‘ Document the key handoff for verification and liability protection.
        </div>

        <div class="form-group">
          <label class="form-label">Driver ID Photo *</label>
          <div style="display:flex;flex-wrap:wrap;gap:10px;margin-bottom:12px;" id="key-exchange-id-preview"></div>
          <input type="file" id="key-exchange-id-photo" accept="image/*" onchange="previewKeyExchangeIdPhoto()" style="display:none;">
          <button type="button" class="btn btn-secondary" onclick="document.getElementById('key-exchange-id-photo').click()">ðŸ“· Capture ID Photo</button>
          <p class="form-hint">Take a photo of the driver's ID for verification</p>
        </div>

        <div class="form-group">
          <label class="form-label">Key Handoff Photos (up to 3) *</label>
          <div style="display:flex;flex-wrap:wrap;gap:10px;margin-bottom:12px;" id="key-exchange-photos-preview"></div>
          <input type="file" id="key-exchange-key-photos" accept="image/*" multiple onchange="previewKeyExchangePhotos()" style="display:none;">
          <button type="button" class="btn btn-secondary" onclick="document.getElementById('key-exchange-key-photos').click()">ðŸ“· Add Key Photos</button>
          <p class="form-hint">Photograph keys being handed over, with vehicle visible if possible</p>
        </div>

        <div class="form-group">
          <label class="form-label">Notes (optional)</label>
          <textarea class="form-textarea" id="key-exchange-notes" placeholder="Any notes about the key exchange, number of keys, remotes, valet key, etc..."></textarea>
        </div>

        <div id="key-exchange-upload-status" style="display:none;padding:16px;background:var(--bg-input);border-radius:var(--radius-md);margin-top:16px;"></div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="closeModal('key-exchange-modal')">Cancel</button>
        <button class="btn btn-primary" id="submit-key-exchange-btn" onclick="submitKeyExchange()">ðŸ”‘ Verify Key Exchange</button>
      </div>
    </div>
  </div>

  <!-- Destination Task Detail Modal -->
  <div class="modal-backdrop" id="destination-task-modal">
    <div class="modal" style="max-width:720px;">
      <div class="modal-header">
        <h3 class="modal-title" id="dest-task-modal-title">Task Details</h3>
        <button class="modal-close" onclick="closeModal('destination-task-modal')">Ã—</button>
      </div>
      <div class="modal-body" id="dest-task-modal-body">
        <div class="empty-state"><p>Loading task details...</p></div>
      </div>
      <div class="modal-footer" id="dest-task-modal-footer">
        <button class="btn btn-secondary" onclick="closeModal('destination-task-modal')">Close</button>
      </div>
    </div>
  </div>

  <!-- Destination Task Status Update Modal -->
  <div class="modal-backdrop" id="dest-status-modal">
    <div class="modal" style="max-width:560px;">
      <div class="modal-header">
        <h3 class="modal-title" id="dest-status-modal-title">Update Status</h3>
        <button class="modal-close" onclick="closeModal('dest-status-modal')">Ã—</button>
      </div>
      <div class="modal-body">
        <input type="hidden" id="dest-status-service-id">
        <input type="hidden" id="dest-status-new-status">
        
        <div class="alert" style="background:var(--accent-gold-soft);border:1px solid rgba(212,168,85,0.3);color:var(--accent-gold);margin-bottom:20px;padding:16px;border-radius:var(--radius-md);">
          <span id="dest-status-info">Updating task status...</span>
        </div>

        <div class="form-group" id="dest-photo-group">
          <label class="form-label">ðŸ“¸ Photo Evidence <span style="color:var(--accent-red);">*</span></label>
          <div style="display:flex;flex-wrap:wrap;gap:10px;margin-bottom:12px;" id="dest-status-photo-preview"></div>
          <input type="file" id="dest-status-photo" accept="image/*" capture="environment" onchange="previewDestStatusPhoto()" style="display:none;">
          <button type="button" class="btn btn-secondary" onclick="document.getElementById('dest-status-photo').click()">ðŸ“· Capture Vehicle Photo</button>
          <p class="form-hint">Take a photo of the vehicle for documentation</p>
        </div>

        <div class="form-group" id="dest-odometer-group" style="display:none;">
          <label class="form-label">ðŸ”¢ Odometer Reading</label>
          <input type="number" class="form-input" id="dest-odometer-reading" placeholder="e.g., 45678" min="0">
          <p class="form-hint">Enter current odometer reading</p>
        </div>

        <div class="form-group" id="dest-fuel-group" style="display:none;">
          <label class="form-label">â›½ Fuel Level</label>
          <select class="form-input" id="dest-fuel-level">
            <option value="">Select fuel level...</option>
            <option value="empty">Empty</option>
            <option value="1/4">1/4 Tank</option>
            <option value="1/2">1/2 Tank</option>
            <option value="3/4">3/4 Tank</option>
            <option value="full">Full</option>
          </select>
          <p class="form-hint">Select current fuel level</p>
        </div>

        <div class="form-group" id="dest-parking-group" style="display:none;">
          <label class="form-label">ðŸ…¿ï¸ Parking Location/Spot</label>
          <input type="text" class="form-input" id="dest-parking-spot" placeholder="e.g., Terminal B, Level 3, Spot 427">
          <p class="form-hint">Enter the parking location for airport services</p>
        </div>

        <div class="form-group" id="dest-final-odometer-group" style="display:none;">
          <label class="form-label">ðŸ”¢ Final Odometer Reading</label>
          <input type="number" class="form-input" id="dest-final-odometer" placeholder="e.g., 45698" min="0">
          <p class="form-hint">Enter final odometer reading at delivery</p>
        </div>

        <div class="form-group">
          <label class="form-label" id="dest-notes-label">Notes (optional)</label>
          <textarea class="form-textarea" id="dest-status-notes" placeholder="Any notes about this status update..."></textarea>
        </div>

        <div class="form-group" id="dest-location-group">
          <label class="form-label">ðŸ“ Current Location</label>
          <div id="dest-location-status" style="padding:12px;background:var(--bg-input);border-radius:var(--radius-md);font-size:0.9rem;color:var(--text-muted);">
            Click "Capture Location" to record GPS coordinates
          </div>
          <input type="hidden" id="dest-location-lat">
          <input type="hidden" id="dest-location-lng">
          <button type="button" class="btn btn-secondary btn-sm" onclick="captureDestLocation()" style="margin-top:8px;">ðŸ“ Capture Location</button>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="closeModal('dest-status-modal')">Cancel</button>
        <button class="btn btn-primary" id="dest-status-submit-btn" onclick="submitDestStatusUpdate()">Update Status</button>
      </div>
    </div>
  </div>

  <!-- Driver Assignment Modal -->
  <div class="modal-backdrop" id="dest-driver-modal">
    <div class="modal" style="max-width:480px;">
      <div class="modal-header">
        <h3 class="modal-title">Assign Driver</h3>
        <button class="modal-close" onclick="closeModal('dest-driver-modal')">Ã—</button>
      </div>
      <div class="modal-body">
        <input type="hidden" id="dest-driver-service-id">
        
        <div class="form-group">
          <label class="form-label">Select Driver</label>
          <select class="form-input" id="dest-driver-select">
            <option value="">Select a team member...</option>
          </select>
          <p class="form-hint">Assign this task to a team member</p>
        </div>

        <div id="dest-driver-workload" style="display:none;padding:16px;background:var(--bg-input);border-radius:var(--radius-md);margin-top:12px;">
          <div style="font-size:0.85rem;color:var(--text-muted);margin-bottom:8px;">Current Workload</div>
          <div id="dest-driver-workload-info" style="font-size:0.9rem;"></div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="closeModal('dest-driver-modal')">Cancel</button>
        <button class="btn btn-primary" onclick="assignDestDriver()">Assign Driver</button>
      </div>
    </div>
  </div>

  <!-- Team Member Modal -->
  <div class="modal-backdrop" id="team-member-modal">
    <div class="modal">
      <div class="modal-header">
        <h3 class="modal-title" id="team-modal-title">Add Team Member</h3>
        <button class="modal-close" onclick="closeModal('team-member-modal')">Ã—</button>
      </div>
      <div class="modal-body">
        <div class="team-photo-upload" id="team-photo-upload" onclick="document.getElementById('team-photo-input').click()">
          <div class="team-photo-upload-icon">ðŸ“·</div>
          <div class="team-photo-upload-text">Upload Photo</div>
        </div>
        <input type="file" id="team-photo-input" accept="image/*" style="display:none;" onchange="handleTeamPhotoSelect(event)">
        <button type="button" class="btn btn-ghost btn-sm" id="remove-team-photo-btn" onclick="removeTeamPhoto()" style="display:none;margin:0 auto 16px;width:auto;">Remove Photo</button>

        <div class="form-group">
          <label class="form-label">Name *</label>
          <input type="text" class="form-input" id="team-member-name" placeholder="Full name" required>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="form-label">Role *</label>
            <select class="form-input" id="team-member-role" required>
              <option value="">Select role...</option>
              <option value="mechanic">Mechanic</option>
              <option value="driver">Driver</option>
              <option value="detailer">Detailer</option>
              <option value="technician">Technician</option>
              <option value="manager">Manager</option>
              <option value="other">Other</option>
            </select>
          </div>
          <div class="form-group">
            <label class="form-label">Years of Experience</label>
            <input type="number" class="form-input" id="team-member-experience" placeholder="e.g., 5" min="0" max="50">
          </div>
        </div>

        <div class="form-group">
          <label class="form-label">Bio</label>
          <textarea class="form-textarea" id="team-member-bio" placeholder="Brief description of skills and background..."></textarea>
        </div>

        <div class="form-group">
          <label class="form-label">Certifications</label>
          <input type="text" class="form-input" id="team-member-certifications" placeholder="ASE Certified, I-CAR Gold, etc. (comma-separated)">
          <p class="form-hint">Enter certifications separated by commas</p>
        </div>

        <div class="form-group">
          <label class="form-label">Specialties</label>
          <input type="text" class="form-input" id="team-member-specialties" placeholder="Brakes, Engine repair, Detailing, etc. (comma-separated)">
          <p class="form-hint">Enter specialties separated by commas</p>
        </div>

        <div class="form-group">
          <label style="display:flex;align-items:center;gap:12px;cursor:pointer;padding:12px;background:var(--bg-input);border-radius:var(--radius-md);">
            <input type="checkbox" id="team-member-active" checked style="width:20px;height:20px;cursor:pointer;">
            <div>
              <div style="font-weight:500;">Active Team Member</div>
              <div style="font-size:0.85rem;color:var(--text-muted);">Active members are visible to customers</div>
            </div>
          </label>
        </div>

        <div class="form-group">
          <label style="display:flex;align-items:flex-start;gap:12px;cursor:pointer;padding:12px;background:var(--bg-input);border-radius:var(--radius-md);border:1px solid var(--accent-gold);">
            <input type="checkbox" id="team-member-consent" style="width:20px;height:20px;cursor:pointer;flex-shrink:0;margin-top:2px;">
            <div>
              <div style="font-weight:500;color:var(--accent-gold);">âš–ï¸ Photo & Information Consent</div>
              <div style="font-size:0.85rem;color:var(--text-muted);line-height:1.5;margin-top:4px;">I confirm that I have obtained written permission from this team member to display their photo and personal information on the My Car Concierge platform. I understand that I am responsible for ensuring proper consent has been obtained.</div>
            </div>
          </label>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="closeModal('team-member-modal')">Cancel</button>
        <button class="btn btn-primary" onclick="saveTeamMember()">Save Team Member</button>
      </div>
    </div>
  </div>

  <!-- Emergency Detail Modal -->
  <div class="modal-backdrop" id="emergency-detail-modal">
    <div class="modal">
      <div class="modal-header">
        <h3 class="modal-title">ðŸš¨ Emergency Details</h3>
        <button class="modal-close" onclick="closeModal('emergency-detail-modal')">Ã—</button>
      </div>
      <div class="modal-body" id="emergency-detail-content">
        <div style="text-align:center;padding:40px;">
          <div style="font-size:48px;margin-bottom:16px;">â³</div>
          <div style="color:var(--text-muted);">Loading...</div>
        </div>
      </div>
      <div class="modal-footer" id="emergency-detail-footer"></div>
    </div>
  </div>

  <!-- Emergency Accept Modal -->
  <div class="modal-backdrop" id="emergency-accept-modal">
    <div class="modal">
      <div class="modal-header">
        <h3 class="modal-title">ðŸš— Claim Emergency</h3>
        <button class="modal-close" onclick="closeModal('emergency-accept-modal')">Ã—</button>
      </div>
      <div class="modal-body">
        <input type="hidden" id="accept-emergency-id">
        
        <div style="background:var(--accent-gold-soft);padding:14px;border-radius:var(--radius-md);margin-bottom:20px;display:flex;align-items:center;gap:12px;">
          <span style="font-size:1.5rem;">ðŸŽŸï¸</span>
          <div>
            <div style="font-weight:600;color:var(--accent-gold);">Claim Cost: 1 Bid Credit</div>
            <div style="font-size:0.85rem;color:var(--text-muted);">This credit will be deducted when you claim.</div>
          </div>
        </div>
        
        <div class="form-group">
          <label class="form-label">Your Estimated Time of Arrival *</label>
          <select class="form-input" id="accept-eta" required>
            <option value="">Select ETA...</option>
            <option value="10">~10 minutes</option>
            <option value="15">~15 minutes</option>
            <option value="20">~20 minutes</option>
            <option value="30">~30 minutes</option>
            <option value="45">~45 minutes</option>
            <option value="60">~1 hour</option>
          </select>
          <div class="form-hint">âš ï¸ You must arrive within ETA + 15 min or member can report no-show.</div>
        </div>
        
        <div style="background:var(--bg-input);padding:12px;border-radius:var(--radius-md);font-size:0.9rem;color:var(--text-secondary);">
          âœ“ The member will be notified immediately that you're on your way.
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="closeModal('emergency-accept-modal')">Cancel</button>
        <button class="btn btn-emergency" onclick="confirmAcceptEmergency()">ðŸš— Claim & Go!</button>
      </div>
    </div>
  </div>

  <!-- Emergency Complete Modal (Invoice Submission) -->
  <div class="modal-backdrop" id="emergency-complete-modal">
    <div class="modal">
      <div class="modal-header">
        <h3 class="modal-title">ðŸ“‹ Submit Invoice & Complete</h3>
        <button class="modal-close" onclick="closeModal('emergency-complete-modal')">Ã—</button>
      </div>
      <div class="modal-body">
        <input type="hidden" id="complete-emergency-id">
        <input type="hidden" id="complete-is-towing" value="false">
        
        <div style="background:var(--accent-gold-soft);padding:12px;border-radius:var(--radius-md);margin-bottom:20px;">
          <div style="font-size:0.85rem;color:var(--text-muted);">ðŸ’° Member Escrow</div>
          <div id="complete-escrow-display" style="font-size:1.2rem;font-weight:600;color:var(--accent-gold);">--</div>
        </div>
        
        <div id="complete-miles-group" class="form-group" style="display:none;">
          <label class="form-label">Actual Miles Towed *</label>
          <input type="number" class="form-input" id="complete-actual-miles" placeholder="e.g., 15" min="0" step="0.1">
          <div class="form-hint">Enter actual miles from pickup to destination (for towing/accident jobs)</div>
        </div>
        
        <div class="form-group">
          <label class="form-label">Invoice Amount ($) *</label>
          <input type="number" class="form-input" id="complete-amount" placeholder="0.00" min="0" step="0.01">
          <div class="form-hint">Enter the final amount to charge the member</div>
        </div>
        
        <div class="form-group">
          <label class="form-label">Service Notes</label>
          <textarea class="form-textarea" id="complete-notes" placeholder="Describe what was done to resolve the emergency..."></textarea>
        </div>
        
        <div style="background:var(--bg-input);padding:12px;border-radius:var(--radius-md);font-size:0.85rem;color:var(--text-muted);">
          â„¹ï¸ The member's escrow will be captured for the invoice amount. Any remaining balance will be refunded to the member.
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="closeModal('emergency-complete-modal')">Cancel</button>
        <button class="btn btn-primary" onclick="confirmCompleteEmergency()">ðŸ“‹ Submit Invoice</button>
      </div>
    </div>
  </div>

  <!-- Multi-Point Inspection Modal -->
  <div class="modal-backdrop" id="inspection-modal">
    <div class="modal inspection-modal">
      <div class="modal-header">
        <h3 class="modal-title">ðŸ” Multi-Point Inspection Report</h3>
        <button class="modal-close" onclick="closeModal('inspection-modal')">Ã—</button>
      </div>
      <div class="modal-body">
        <input type="hidden" id="inspection-package-id">
        <input type="hidden" id="inspection-vehicle-id">
        <input type="hidden" id="inspection-report-id">
        
        <div class="form-group">
          <label class="form-label">Inspection Type</label>
          <select class="form-input" id="inspection-type">
            <option value="standard">Standard Multi-Point</option>
            <option value="comprehensive">Comprehensive</option>
            <option value="pre_purchase">Pre-Purchase</option>
          </select>
        </div>

        <div id="inspection-summary" class="inspection-summary" style="display:none;">
          <div style="font-weight:600;margin-bottom:12px;">Inspection Summary</div>
          <div class="inspection-summary-grid">
            <div class="inspection-summary-item good">
              <div class="inspection-summary-count" id="count-good">0</div>
              <div class="inspection-summary-label">Good</div>
            </div>
            <div class="inspection-summary-item fair">
              <div class="inspection-summary-count" id="count-fair">0</div>
              <div class="inspection-summary-label">Fair</div>
            </div>
            <div class="inspection-summary-item attention">
              <div class="inspection-summary-count" id="count-attention">0</div>
              <div class="inspection-summary-label">Attention</div>
            </div>
            <div class="inspection-summary-item urgent">
              <div class="inspection-summary-count" id="count-urgent">0</div>
              <div class="inspection-summary-label">Urgent</div>
            </div>
          </div>
        </div>

        <div id="inspection-categories">
          <!-- Fluids Category -->
          <div class="inspection-category expanded" data-category="fluids">
            <div class="inspection-category-header" onclick="toggleInspectionCategory(this)">
              <div class="inspection-category-title">ðŸ›¢ï¸ Fluids</div>
              <div class="inspection-category-count">5 items</div>
            </div>
            <div class="inspection-category-body">
              <div class="inspection-item" data-field="engine_oil">
                <div class="inspection-item-label">Engine Oil</div>
                <div class="inspection-status-btns">
                  <button class="inspection-status-btn good" onclick="setInspectionStatus(this, 'good')">Good</button>
                  <button class="inspection-status-btn fair" onclick="setInspectionStatus(this, 'fair')">Fair</button>
                  <button class="inspection-status-btn needs_attention" onclick="setInspectionStatus(this, 'needs_attention')">Attention</button>
                  <button class="inspection-status-btn urgent" onclick="setInspectionStatus(this, 'urgent')">Urgent</button>
                  <button class="inspection-status-btn na" onclick="setInspectionStatus(this, 'na')">N/A</button>
                </div>
              </div>
              <div class="inspection-item" data-field="transmission_fluid">
                <div class="inspection-item-label">Transmission Fluid</div>
                <div class="inspection-status-btns">
                  <button class="inspection-status-btn good" onclick="setInspectionStatus(this, 'good')">Good</button>
                  <button class="inspection-status-btn fair" onclick="setInspectionStatus(this, 'fair')">Fair</button>
                  <button class="inspection-status-btn needs_attention" onclick="setInspectionStatus(this, 'needs_attention')">Attention</button>
                  <button class="inspection-status-btn urgent" onclick="setInspectionStatus(this, 'urgent')">Urgent</button>
                  <button class="inspection-status-btn na" onclick="setInspectionStatus(this, 'na')">N/A</button>
                </div>
              </div>
              <div class="inspection-item" data-field="coolant_level">
                <div class="inspection-item-label">Coolant Level</div>
                <div class="inspection-status-btns">
                  <button class="inspection-status-btn good" onclick="setInspectionStatus(this, 'good')">Good</button>
                  <button class="inspection-status-btn fair" onclick="setInspectionStatus(this, 'fair')">Fair</button>
                  <button class="inspection-status-btn needs_attention" onclick="setInspectionStatus(this, 'needs_attention')">Attention</button>
                  <button class="inspection-status-btn urgent" onclick="setInspectionStatus(this, 'urgent')">Urgent</button>
                  <button class="inspection-status-btn na" onclick="setInspectionStatus(this, 'na')">N/A</button>
                </div>
              </div>
              <div class="inspection-item" data-field="brake_fluid">
                <div class="inspection-item-label">Brake Fluid</div>
                <div class="inspection-status-btns">
                  <button class="inspection-status-btn good" onclick="setInspectionStatus(this, 'good')">Good</button>
                  <button class="inspection-status-btn fair" onclick="setInspectionStatus(this, 'fair')">Fair</button>
                  <button class="inspection-status-btn needs_attention" onclick="setInspectionStatus(this, 'needs_attention')">Attention</button>
                  <button class="inspection-status-btn urgent" onclick="setInspectionStatus(this, 'urgent')">Urgent</button>
                  <button class="inspection-status-btn na" onclick="setInspectionStatus(this, 'na')">N/A</button>
                </div>
              </div>
              <div class="inspection-item" data-field="power_steering_fluid">
                <div class="inspection-item-label">Power Steering Fluid</div>
                <div class="inspection-status-btns">
                  <button class="inspection-status-btn good" onclick="setInspectionStatus(this, 'good')">Good</button>
                  <button class="inspection-status-btn fair" onclick="setInspectionStatus(this, 'fair')">Fair</button>
                  <button class="inspection-status-btn needs_attention" onclick="setInspectionStatus(this, 'needs_attention')">Attention</button>
                  <button class="inspection-status-btn urgent" onclick="setInspectionStatus(this, 'urgent')">Urgent</button>
                  <button class="inspection-status-btn na" onclick="setInspectionStatus(this, 'na')">N/A</button>
                </div>
              </div>
            </div>
          </div>

          <!-- Brakes Category -->
          <div class="inspection-category" data-category="brakes">
            <div class="inspection-category-header" onclick="toggleInspectionCategory(this)">
              <div class="inspection-category-title">ðŸ›ž Brakes</div>
              <div class="inspection-category-count">3 items</div>
            </div>
            <div class="inspection-category-body">
              <div class="inspection-item" data-field="brake_pads_front">
                <div class="inspection-item-label">Front Brake Pads</div>
                <div class="inspection-status-btns">
                  <button class="inspection-status-btn good" onclick="setInspectionStatus(this, 'good')">Good</button>
                  <button class="inspection-status-btn fair" onclick="setInspectionStatus(this, 'fair')">Fair</button>
                  <button class="inspection-status-btn needs_attention" onclick="setInspectionStatus(this, 'needs_attention')">Attention</button>
                  <button class="inspection-status-btn urgent" onclick="setInspectionStatus(this, 'urgent')">Urgent</button>
                  <button class="inspection-status-btn na" onclick="setInspectionStatus(this, 'na')">N/A</button>
                </div>
                <div class="inspection-measurement">
                  <input type="number" id="brake_pads_front_percent" min="0" max="100" placeholder="0">
                  <span>%</span>
                </div>
              </div>
              <div class="inspection-item" data-field="brake_pads_rear">
                <div class="inspection-item-label">Rear Brake Pads</div>
                <div class="inspection-status-btns">
                  <button class="inspection-status-btn good" onclick="setInspectionStatus(this, 'good')">Good</button>
                  <button class="inspection-status-btn fair" onclick="setInspectionStatus(this, 'fair')">Fair</button>
                  <button class="inspection-status-btn needs_attention" onclick="setInspectionStatus(this, 'needs_attention')">Attention</button>
                  <button class="inspection-status-btn urgent" onclick="setInspectionStatus(this, 'urgent')">Urgent</button>
                  <button class="inspection-status-btn na" onclick="setInspectionStatus(this, 'na')">N/A</button>
                </div>
                <div class="inspection-measurement">
                  <input type="number" id="brake_pads_rear_percent" min="0" max="100" placeholder="0">
                  <span>%</span>
                </div>
              </div>
              <div class="inspection-item" data-field="brake_rotors">
                <div class="inspection-item-label">Brake Rotors</div>
                <div class="inspection-status-btns">
                  <button class="inspection-status-btn good" onclick="setInspectionStatus(this, 'good')">Good</button>
                  <button class="inspection-status-btn fair" onclick="setInspectionStatus(this, 'fair')">Fair</button>
                  <button class="inspection-status-btn needs_attention" onclick="setInspectionStatus(this, 'needs_attention')">Attention</button>
                  <button class="inspection-status-btn urgent" onclick="setInspectionStatus(this, 'urgent')">Urgent</button>
                  <button class="inspection-status-btn na" onclick="setInspectionStatus(this, 'na')">N/A</button>
                </div>
              </div>
            </div>
          </div>

          <!-- Tires Category -->
          <div class="inspection-category" data-category="tires">
            <div class="inspection-category-header" onclick="toggleInspectionCategory(this)">
              <div class="inspection-category-title">ðŸš— Tires</div>
              <div class="inspection-category-count">6 items</div>
            </div>
            <div class="inspection-category-body">
              <div class="inspection-item" data-field="tire_front_left">
                <div class="inspection-item-label">Front Left Tire</div>
                <div class="inspection-status-btns">
                  <button class="inspection-status-btn good" onclick="setInspectionStatus(this, 'good')">Good</button>
                  <button class="inspection-status-btn fair" onclick="setInspectionStatus(this, 'fair')">Fair</button>
                  <button class="inspection-status-btn needs_attention" onclick="setInspectionStatus(this, 'needs_attention')">Attention</button>
                  <button class="inspection-status-btn urgent" onclick="setInspectionStatus(this, 'urgent')">Urgent</button>
                  <button class="inspection-status-btn na" onclick="setInspectionStatus(this, 'na')">N/A</button>
                </div>
                <div class="inspection-measurement">
                  <input type="number" id="tire_front_left_tread" min="0" max="12" placeholder="0">
                  <span>/32"</span>
                </div>
              </div>
              <div class="inspection-item" data-field="tire_front_right">
                <div class="inspection-item-label">Front Right Tire</div>
                <div class="inspection-status-btns">
                  <button class="inspection-status-btn good" onclick="setInspectionStatus(this, 'good')">Good</button>
                  <button class="inspection-status-btn fair" onclick="setInspectionStatus(this, 'fair')">Fair</button>
                  <button class="inspection-status-btn needs_attention" onclick="setInspectionStatus(this, 'needs_attention')">Attention</button>
                  <button class="inspection-status-btn urgent" onclick="setInspectionStatus(this, 'urgent')">Urgent</button>
                  <button class="inspection-status-btn na" onclick="setInspectionStatus(this, 'na')">N/A</button>
                </div>
                <div class="inspection-measurement">
                  <input type="number" id="tire_front_right_tread" min="0" max="12" placeholder="0">
                  <span>/32"</span>
                </div>
              </div>
              <div class="inspection-item" data-field="tire_rear_left">
                <div class="inspection-item-label">Rear Left Tire</div>
                <div class="inspection-status-btns">
                  <button class="inspection-status-btn good" onclick="setInspectionStatus(this, 'good')">Good</button>
                  <button class="inspection-status-btn fair" onclick="setInspectionStatus(this, 'fair')">Fair</button>
                  <button class="inspection-status-btn needs_attention" onclick="setInspectionStatus(this, 'needs_attention')">Attention</button>
                  <button class="inspection-status-btn urgent" onclick="setInspectionStatus(this, 'urgent')">Urgent</button>
                  <button class="inspection-status-btn na" onclick="setInspectionStatus(this, 'na')">N/A</button>
                </div>
                <div class="inspection-measurement">
                  <input type="number" id="tire_rear_left_tread" min="0" max="12" placeholder="0">
                  <span>/32"</span>
                </div>
              </div>
              <div class="inspection-item" data-field="tire_rear_right">
                <div class="inspection-item-label">Rear Right Tire</div>
                <div class="inspection-status-btns">
                  <button class="inspection-status-btn good" onclick="setInspectionStatus(this, 'good')">Good</button>
                  <button class="inspection-status-btn fair" onclick="setInspectionStatus(this, 'fair')">Fair</button>
                  <button class="inspection-status-btn needs_attention" onclick="setInspectionStatus(this, 'needs_attention')">Attention</button>
                  <button class="inspection-status-btn urgent" onclick="setInspectionStatus(this, 'urgent')">Urgent</button>
                  <button class="inspection-status-btn na" onclick="setInspectionStatus(this, 'na')">N/A</button>
                </div>
                <div class="inspection-measurement">
                  <input type="number" id="tire_rear_right_tread" min="0" max="12" placeholder="0">
                  <span>/32"</span>
                </div>
              </div>
              <div class="inspection-item" data-field="tire_pressure_ok">
                <div class="inspection-item-label">Tire Pressure</div>
                <div class="inspection-status-btns">
                  <button class="inspection-status-btn good" onclick="setInspectionStatus(this, 'good')">OK</button>
                  <button class="inspection-status-btn needs_attention" onclick="setInspectionStatus(this, 'needs_attention')">Adjusted</button>
                </div>
              </div>
              <div class="inspection-item" data-field="spare_tire">
                <div class="inspection-item-label">Spare Tire</div>
                <div class="inspection-status-btns">
                  <button class="inspection-status-btn good" onclick="setInspectionStatus(this, 'good')">Good</button>
                  <button class="inspection-status-btn fair" onclick="setInspectionStatus(this, 'fair')">Fair</button>
                  <button class="inspection-status-btn needs_attention" onclick="setInspectionStatus(this, 'needs_attention')">Attention</button>
                  <button class="inspection-status-btn urgent" onclick="setInspectionStatus(this, 'urgent')">Urgent</button>
                  <button class="inspection-status-btn na" onclick="setInspectionStatus(this, 'na')">N/A</button>
                </div>
              </div>
            </div>
          </div>

          <!-- Electrical Category -->
          <div class="inspection-category" data-category="electrical">
            <div class="inspection-category-header" onclick="toggleInspectionCategory(this)">
              <div class="inspection-category-title">âš¡ Electrical & Lights</div>
              <div class="inspection-category-count">5 items</div>
            </div>
            <div class="inspection-category-body">
              <div class="inspection-item" data-field="battery">
                <div class="inspection-item-label">Battery</div>
                <div class="inspection-status-btns">
                  <button class="inspection-status-btn good" onclick="setInspectionStatus(this, 'good')">Good</button>
                  <button class="inspection-status-btn fair" onclick="setInspectionStatus(this, 'fair')">Fair</button>
                  <button class="inspection-status-btn needs_attention" onclick="setInspectionStatus(this, 'needs_attention')">Attention</button>
                  <button class="inspection-status-btn urgent" onclick="setInspectionStatus(this, 'urgent')">Urgent</button>
                  <button class="inspection-status-btn na" onclick="setInspectionStatus(this, 'na')">N/A</button>
                </div>
                <div class="inspection-measurement">
                  <input type="number" id="battery_voltage" min="0" max="15" step="0.1" placeholder="12.6">
                  <span>V</span>
                </div>
              </div>
              <div class="inspection-item" data-field="headlights">
                <div class="inspection-item-label">Headlights</div>
                <div class="inspection-status-btns">
                  <button class="inspection-status-btn good" onclick="setInspectionStatus(this, 'good')">Good</button>
                  <button class="inspection-status-btn fair" onclick="setInspectionStatus(this, 'fair')">Fair</button>
                  <button class="inspection-status-btn needs_attention" onclick="setInspectionStatus(this, 'needs_attention')">Attention</button>
                  <button class="inspection-status-btn urgent" onclick="setInspectionStatus(this, 'urgent')">Urgent</button>
                  <button class="inspection-status-btn na" onclick="setInspectionStatus(this, 'na')">N/A</button>
                </div>
              </div>
              <div class="inspection-item" data-field="taillights">
                <div class="inspection-item-label">Taillights</div>
                <div class="inspection-status-btns">
                  <button class="inspection-status-btn good" onclick="setInspectionStatus(this, 'good')">Good</button>
                  <button class="inspection-status-btn fair" onclick="setInspectionStatus(this, 'fair')">Fair</button>
                  <button class="inspection-status-btn needs_attention" onclick="setInspectionStatus(this, 'needs_attention')">Attention</button>
                  <button class="inspection-status-btn urgent" onclick="setInspectionStatus(this, 'urgent')">Urgent</button>
                  <button class="inspection-status-btn na" onclick="setInspectionStatus(this, 'na')">N/A</button>
                </div>
              </div>
              <div class="inspection-item" data-field="turn_signals">
                <div class="inspection-item-label">Turn Signals</div>
                <div class="inspection-status-btns">
                  <button class="inspection-status-btn good" onclick="setInspectionStatus(this, 'good')">Good</button>
                  <button class="inspection-status-btn fair" onclick="setInspectionStatus(this, 'fair')">Fair</button>
                  <button class="inspection-status-btn needs_attention" onclick="setInspectionStatus(this, 'needs_attention')">Attention</button>
                  <button class="inspection-status-btn urgent" onclick="setInspectionStatus(this, 'urgent')">Urgent</button>
                  <button class="inspection-status-btn na" onclick="setInspectionStatus(this, 'na')">N/A</button>
                </div>
              </div>
            </div>
          </div>

          <!-- Belts & Hoses Category -->
          <div class="inspection-category" data-category="belts">
            <div class="inspection-category-header" onclick="toggleInspectionCategory(this)">
              <div class="inspection-category-title">ðŸ”— Belts & Hoses</div>
              <div class="inspection-category-count">2 items</div>
            </div>
            <div class="inspection-category-body">
              <div class="inspection-item" data-field="serpentine_belt">
                <div class="inspection-item-label">Serpentine Belt</div>
                <div class="inspection-status-btns">
                  <button class="inspection-status-btn good" onclick="setInspectionStatus(this, 'good')">Good</button>
                  <button class="inspection-status-btn fair" onclick="setInspectionStatus(this, 'fair')">Fair</button>
                  <button class="inspection-status-btn needs_attention" onclick="setInspectionStatus(this, 'needs_attention')">Attention</button>
                  <button class="inspection-status-btn urgent" onclick="setInspectionStatus(this, 'urgent')">Urgent</button>
                  <button class="inspection-status-btn na" onclick="setInspectionStatus(this, 'na')">N/A</button>
                </div>
              </div>
              <div class="inspection-item" data-field="hoses">
                <div class="inspection-item-label">Hoses</div>
                <div class="inspection-status-btns">
                  <button class="inspection-status-btn good" onclick="setInspectionStatus(this, 'good')">Good</button>
                  <button class="inspection-status-btn fair" onclick="setInspectionStatus(this, 'fair')">Fair</button>
                  <button class="inspection-status-btn needs_attention" onclick="setInspectionStatus(this, 'needs_attention')">Attention</button>
                  <button class="inspection-status-btn urgent" onclick="setInspectionStatus(this, 'urgent')">Urgent</button>
                  <button class="inspection-status-btn na" onclick="setInspectionStatus(this, 'na')">N/A</button>
                </div>
              </div>
            </div>
          </div>

          <!-- Wipers & Glass Category -->
          <div class="inspection-category" data-category="wipers">
            <div class="inspection-category-header" onclick="toggleInspectionCategory(this)">
              <div class="inspection-category-title">ðŸŒ§ï¸ Wipers & Glass</div>
              <div class="inspection-category-count">2 items</div>
            </div>
            <div class="inspection-category-body">
              <div class="inspection-item" data-field="wiper_blades">
                <div class="inspection-item-label">Wiper Blades</div>
                <div class="inspection-status-btns">
                  <button class="inspection-status-btn good" onclick="setInspectionStatus(this, 'good')">Good</button>
                  <button class="inspection-status-btn fair" onclick="setInspectionStatus(this, 'fair')">Fair</button>
                  <button class="inspection-status-btn needs_attention" onclick="setInspectionStatus(this, 'needs_attention')">Attention</button>
                  <button class="inspection-status-btn urgent" onclick="setInspectionStatus(this, 'urgent')">Urgent</button>
                  <button class="inspection-status-btn na" onclick="setInspectionStatus(this, 'na')">N/A</button>
                </div>
              </div>
              <div class="inspection-item" data-field="windshield">
                <div class="inspection-item-label">Windshield</div>
                <div class="inspection-status-btns">
                  <button class="inspection-status-btn good" onclick="setInspectionStatus(this, 'good')">Good</button>
                  <button class="inspection-status-btn fair" onclick="setInspectionStatus(this, 'fair')">Fair</button>
                  <button class="inspection-status-btn needs_attention" onclick="setInspectionStatus(this, 'needs_attention')">Attention</button>
                  <button class="inspection-status-btn urgent" onclick="setInspectionStatus(this, 'urgent')">Urgent</button>
                  <button class="inspection-status-btn na" onclick="setInspectionStatus(this, 'na')">N/A</button>
                </div>
              </div>
            </div>
          </div>

          <!-- Suspension & Steering Category -->
          <div class="inspection-category" data-category="suspension">
            <div class="inspection-category-header" onclick="toggleInspectionCategory(this)">
              <div class="inspection-category-title">ðŸ”§ Suspension & Steering</div>
              <div class="inspection-category-count">2 items</div>
            </div>
            <div class="inspection-category-body">
              <div class="inspection-item" data-field="shocks_struts">
                <div class="inspection-item-label">Shocks/Struts</div>
                <div class="inspection-status-btns">
                  <button class="inspection-status-btn good" onclick="setInspectionStatus(this, 'good')">Good</button>
                  <button class="inspection-status-btn fair" onclick="setInspectionStatus(this, 'fair')">Fair</button>
                  <button class="inspection-status-btn needs_attention" onclick="setInspectionStatus(this, 'needs_attention')">Attention</button>
                  <button class="inspection-status-btn urgent" onclick="setInspectionStatus(this, 'urgent')">Urgent</button>
                  <button class="inspection-status-btn na" onclick="setInspectionStatus(this, 'na')">N/A</button>
                </div>
              </div>
              <div class="inspection-item" data-field="alignment">
                <div class="inspection-item-label">Alignment</div>
                <div class="inspection-status-btns">
                  <button class="inspection-status-btn good" onclick="setInspectionStatus(this, 'good')">Good</button>
                  <button class="inspection-status-btn fair" onclick="setInspectionStatus(this, 'fair')">Fair</button>
                  <button class="inspection-status-btn needs_attention" onclick="setInspectionStatus(this, 'needs_attention')">Attention</button>
                  <button class="inspection-status-btn urgent" onclick="setInspectionStatus(this, 'urgent')">Urgent</button>
                  <button class="inspection-status-btn na" onclick="setInspectionStatus(this, 'na')">N/A</button>
                </div>
              </div>
            </div>
          </div>

          <!-- Filters Category -->
          <div class="inspection-category" data-category="filters">
            <div class="inspection-category-header" onclick="toggleInspectionCategory(this)">
              <div class="inspection-category-title">ðŸŒ¬ï¸ Filters</div>
              <div class="inspection-category-count">2 items</div>
            </div>
            <div class="inspection-category-body">
              <div class="inspection-item" data-field="air_filter">
                <div class="inspection-item-label">Air Filter</div>
                <div class="inspection-status-btns">
                  <button class="inspection-status-btn good" onclick="setInspectionStatus(this, 'good')">Good</button>
                  <button class="inspection-status-btn fair" onclick="setInspectionStatus(this, 'fair')">Fair</button>
                  <button class="inspection-status-btn needs_attention" onclick="setInspectionStatus(this, 'needs_attention')">Attention</button>
                  <button class="inspection-status-btn urgent" onclick="setInspectionStatus(this, 'urgent')">Urgent</button>
                  <button class="inspection-status-btn na" onclick="setInspectionStatus(this, 'na')">N/A</button>
                </div>
              </div>
              <div class="inspection-item" data-field="cabin_filter">
                <div class="inspection-item-label">Cabin Filter</div>
                <div class="inspection-status-btns">
                  <button class="inspection-status-btn good" onclick="setInspectionStatus(this, 'good')">Good</button>
                  <button class="inspection-status-btn fair" onclick="setInspectionStatus(this, 'fair')">Fair</button>
                  <button class="inspection-status-btn needs_attention" onclick="setInspectionStatus(this, 'needs_attention')">Attention</button>
                  <button class="inspection-status-btn urgent" onclick="setInspectionStatus(this, 'urgent')">Urgent</button>
                  <button class="inspection-status-btn na" onclick="setInspectionStatus(this, 'na')">N/A</button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="form-group">
          <label class="form-label">Technician Notes</label>
          <textarea class="form-textarea" id="inspection-notes" placeholder="Add any notes about the vehicle condition, issues found, or work performed..."></textarea>
        </div>

        <div class="form-group">
          <label class="form-label">Recommendations</label>
          <textarea class="form-textarea" id="inspection-recommendations" placeholder="Recommended services, repairs, or follow-up actions..."></textarea>
        </div>

        <div class="form-group">
          <label class="form-label">Photos (optional)</label>
          <input type="file" class="form-input" id="inspection-photos" accept="image/*" multiple>
          <div class="form-hint">Upload photos of any issues found</div>
          <div id="inspection-photo-preview" class="photo-grid" style="margin-top:12px;"></div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="closeModal('inspection-modal')">Cancel</button>
        <button class="btn btn-primary" onclick="saveInspectionReport()">ðŸ’¾ Save Inspection Report</button>
      </div>
    </div>
  </div>

  <!-- Fleet Batch Detail Modal -->
  <div class="modal-backdrop" id="fleet-batch-modal">
    <div class="modal" style="max-width:900px;">
      <div class="modal-header">
        <h3 class="modal-title" id="fleet-batch-modal-title">ðŸ“¦ Batch Details</h3>
        <button class="modal-close" onclick="closeModal('fleet-batch-modal')">Ã—</button>
      </div>
      <div class="modal-body" id="fleet-batch-modal-body">
        <div class="empty-state"><p>Loading batch details...</p></div>
      </div>
      <div class="modal-footer" id="fleet-batch-modal-footer">
        <button class="btn btn-secondary" onclick="closeModal('fleet-batch-modal')">Close</button>
      </div>
    </div>
  </div>

  <!-- Fleet Bulk Bid Modal -->
  <div class="modal-backdrop" id="fleet-bulk-bid-modal">
    <div class="modal" style="max-width:700px;">
      <div class="modal-header">
        <h3 class="modal-title">ðŸ’¼ Submit Bulk Bid</h3>
        <button class="modal-close" onclick="closeModal('fleet-bulk-bid-modal')">Ã—</button>
      </div>
      <div class="modal-body">
        <input type="hidden" id="fleet-bid-batch-id">
        
        <div style="background:linear-gradient(135deg, var(--accent-gold-soft), rgba(212,168,85,0.05));border:1px solid rgba(212,168,85,0.3);border-radius:var(--radius-md);padding:16px;margin-bottom:20px;">
          <div style="display:flex;align-items:center;gap:8px;margin-bottom:8px;">
            <span class="fleet-badge" style="background:linear-gradient(135deg, var(--accent-gold), #c49a45);color:#0a0a0f;padding:4px 12px;border-radius:100px;font-size:0.78rem;font-weight:600;">ðŸ¢ Fleet Account</span>
            <span style="color:var(--accent-green);font-size:0.85rem;">âœ“ Guaranteed Payment</span>
          </div>
          <div id="fleet-bid-batch-summary" style="font-size:0.9rem;color:var(--text-secondary);"></div>
        </div>

        <div class="form-group">
          <label class="form-label">Pricing Type</label>
          <div style="display:flex;gap:12px;margin-bottom:12px;">
            <label style="display:flex;align-items:center;gap:8px;cursor:pointer;padding:12px 16px;background:var(--bg-input);border:1px solid var(--border-subtle);border-radius:var(--radius-md);flex:1;">
              <input type="radio" name="fleet-pricing-type" value="per_vehicle" checked onchange="updateFleetBidTotal()">
              <div><strong>Per Vehicle</strong><div style="font-size:0.82rem;color:var(--text-muted);">Same price for each</div></div>
            </label>
            <label style="display:flex;align-items:center;gap:8px;cursor:pointer;padding:12px 16px;background:var(--bg-input);border:1px solid var(--border-subtle);border-radius:var(--radius-md);flex:1;">
              <input type="radio" name="fleet-pricing-type" value="flat_rate" onchange="updateFleetBidTotal()">
              <div><strong>Flat Rate</strong><div style="font-size:0.82rem;color:var(--text-muted);">Total for all vehicles</div></div>
            </label>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="form-label" id="fleet-bid-price-label">Price Per Vehicle ($)</label>
            <input type="number" class="form-input" id="fleet-bid-price" placeholder="75.00" min="0" step="0.01" oninput="updateFleetBidTotal()">
          </div>
          <div class="form-group">
            <label class="form-label">Estimated Duration Per Vehicle</label>
            <input type="text" class="form-input" id="fleet-bid-duration" placeholder="45 min - 1 hour">
          </div>
        </div>

        <div class="fleet-bid-calculator">
          <div style="font-weight:600;margin-bottom:12px;">ðŸ’° Bid Summary</div>
          <div class="fleet-bid-row">
            <span>Vehicles in Batch</span>
            <span id="fleet-bid-vehicle-count">0</span>
          </div>
          <div class="fleet-bid-row">
            <span>Price per Vehicle</span>
            <span id="fleet-bid-per-vehicle">$0.00</span>
          </div>
          <div class="fleet-bid-row" style="border-bottom:2px solid var(--accent-gold);">
            <span style="font-weight:600;">Total Batch Value</span>
            <span class="fleet-bid-total" id="fleet-bid-total">$0.00</span>
          </div>
        </div>

        <div class="form-group">
          <label class="form-label">Proposed Schedule</label>
          <div class="form-row">
            <div class="form-group" style="margin-bottom:0;">
              <label class="form-label" style="font-size:0.82rem;">Start Date</label>
              <input type="date" class="form-input" id="fleet-bid-start-date">
            </div>
            <div class="form-group" style="margin-bottom:0;">
              <label class="form-label" style="font-size:0.82rem;">End Date</label>
              <input type="date" class="form-input" id="fleet-bid-end-date">
            </div>
          </div>
        </div>

        <div class="form-group">
          <label class="form-label">Notes for Fleet Manager</label>
          <textarea class="form-textarea" id="fleet-bid-notes" placeholder="Describe your capacity to handle this batch, experience with fleet services, etc."></textarea>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="closeModal('fleet-bulk-bid-modal')">Cancel</button>
        <button class="btn btn-primary" onclick="submitFleetBulkBid()">ðŸ’¼ Submit Bulk Bid</button>
      </div>
    </div>
  </div>

  <!-- Fleet Request Detail Modal -->
  <div class="modal-backdrop" id="fleet-request-modal">
    <div class="modal" style="max-width:800px;">
      <div class="modal-header">
        <h3 class="modal-title" id="fleet-request-modal-title">ðŸ“‹ Fleet Service Request</h3>
        <button class="modal-close" onclick="closeModal('fleet-request-modal')">Ã—</button>
      </div>
      <div class="modal-body" id="fleet-request-modal-body">
        <div class="empty-state"><p>Loading request details...</p></div>
      </div>
      <div class="modal-footer" id="fleet-request-modal-footer">
        <button class="btn btn-secondary" onclick="closeModal('fleet-request-modal')">Close</button>
      </div>
    </div>
  </div>

  <!-- Background Check Modal -->
  <div class="modal-backdrop" id="background-check-modal">
    <div class="modal">
      <div class="modal-header">
        <h3 class="modal-title">ðŸ” Initiate Background Check</h3>
        <button class="modal-close" onclick="closeModal('background-check-modal')">Ã—</button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label class="form-label">Check Type *</label>
          <select class="form-input" id="bg-check-type" onchange="updateBgCheckForm()">
            <option value="provider">Provider (Myself)</option>
            <option value="employee">Team Member / Employee</option>
          </select>
        </div>

        <div id="bg-check-employee-fields" style="display:none;">
          <div class="form-group">
            <label class="form-label">Select Team Member *</label>
            <select class="form-input" id="bg-check-team-member">
              <option value="">Select a team member...</option>
            </select>
          </div>
        </div>

        <div class="form-group">
          <label class="form-label">Email Address *</label>
          <input type="email" class="form-input" id="bg-check-email" placeholder="Email for background check invitation">
          <p class="form-hint">An invitation will be sent to this email to complete the background check</p>
        </div>

        <div style="background:var(--bg-input);padding:16px;border-radius:var(--radius-md);margin-top:16px;">
          <div style="font-weight:600;margin-bottom:8px;">ðŸ“‹ Background Check Package</div>
          <div style="font-size:0.9rem;color:var(--text-muted);line-height:1.6;">
            <div style="margin-bottom:8px;"><strong>Standard Criminal Check</strong> - National criminal database search, sex offender registry, global watchlist</div>
            <div><strong>Motor Vehicle Report (MVR)</strong> - Driving history verification for destination service providers</div>
          </div>
        </div>

        <div style="background:rgba(201,162,39,0.1);border:1px solid var(--accent-gold);padding:16px;border-radius:var(--radius-md);margin-top:16px;">
          <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
            <span style="font-size:1.2rem;">âš–ï¸</span>
            <span style="font-weight:600;color:var(--accent-gold);">Consent Required</span>
          </div>
          <div style="font-size:0.85rem;color:var(--text-muted);line-height:1.5;">
            By initiating this background check, you confirm that the subject has provided written consent for this screening as required by the Fair Credit Reporting Act (FCRA).
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="closeModal('background-check-modal')">Cancel</button>
        <button class="btn btn-primary" onclick="submitBackgroundCheck()">ðŸ” Initiate Check</button>
      </div>
    </div>
  </div>

    <!-- Walk-In POS Section -->
    <section id="walkin-pos" class="section">
      <div class="page-header">
        <h1 class="page-title">ðŸ›’ Walk-In POS</h1>
        <p class="page-subtitle">Serve walk-in customers at your shop without the bidding process.</p>
      </div>

      <div class="pos-container">
        <!-- Stepper -->
        <div class="pos-stepper" id="pos-stepper">
          <div class="pos-stepper-line"></div>
          <div class="pos-stepper-line-fill" id="pos-stepper-fill"></div>
          <div class="pos-step active" data-step="1">
            <div class="pos-step-circle">1</div>
            <div class="pos-step-label">Phone Entry</div>
          </div>
          <div class="pos-step" data-step="2">
            <div class="pos-step-circle">2</div>
            <div class="pos-step-label">Verify & Info</div>
          </div>
          <div class="pos-step" data-step="3">
            <div class="pos-step-circle">3</div>
            <div class="pos-step-label">Vehicle</div>
          </div>
          <div class="pos-step" data-step="4">
            <div class="pos-step-circle">4</div>
            <div class="pos-step-label">Service</div>
          </div>
          <div class="pos-step" data-step="5">
            <div class="pos-step-circle">5</div>
            <div class="pos-step-label">Authorize</div>
          </div>
          <div class="pos-step" data-step="6">
            <div class="pos-step-circle">6</div>
            <div class="pos-step-label">Pay</div>
          </div>
        </div>

        <!-- Step 1: Phone Entry -->
        <div class="pos-step-content active" id="pos-step-1">
          <div class="pos-card">
            <h2 style="font-size:1.4rem;font-weight:600;margin-bottom:8px;text-align:center;">ðŸ“± Customer Check-In</h2>
            <p style="color:var(--text-muted);text-align:center;margin-bottom:24px;">Scan customer's QR code for instant check-in, or enter phone number.</p>
            
            <!-- QR Scan Button -->
            <div style="text-align:center;margin-bottom:24px;">
              <button class="pos-btn pos-btn-primary" onclick="openPosQrScanner()" style="padding:16px 32px;font-size:1.1rem;background:linear-gradient(135deg, var(--accent-blue), #3a6bdb);">
                ðŸ“· Scan QR Code
              </button>
              <p style="color:var(--text-muted);font-size:0.85rem;margin-top:8px;">Fastest check-in method</p>
            </div>

            <div style="display:flex;align-items:center;gap:16px;margin:20px 0;">
              <div style="flex:1;height:1px;background:var(--border-subtle);"></div>
              <span style="color:var(--text-muted);font-size:0.9rem;">or enter phone number</span>
              <div style="flex:1;height:1px;background:var(--border-subtle);"></div>
            </div>

            <div class="pos-form-group">
              <input type="tel" class="pos-input pos-input-lg" id="pos-phone" placeholder="(555) 123-4567" maxlength="14" autocomplete="tel">
              <div class="pos-input-hint">ðŸ“± Format: (XXX) XXX-XXXX</div>
            </div>
            
            <div style="display:flex;gap:16px;justify-content:center;">
              <button class="pos-btn pos-btn-secondary" onclick="posLookupCustomer()" id="pos-lookup-btn">
                ðŸ” Look Up by Phone
              </button>
            </div>
            
            <div id="pos-phone-error" style="color:var(--accent-red);text-align:center;margin-top:16px;display:none;"></div>
          </div>
        </div>

        <!-- QR Scanner Modal -->
        <div id="pos-qr-scanner-modal" style="display:none;position:fixed;inset:0;background:rgba(0,0,0,0.95);z-index:2000;flex-direction:column;align-items:center;justify-content:center;">
          <button onclick="closePosQrScanner()" style="position:absolute;top:20px;right:20px;background:transparent;border:none;color:#fff;font-size:2rem;cursor:pointer;padding:10px;z-index:10;">âœ•</button>
          <div style="width:100%;max-width:400px;padding:20px;">
            <h3 style="color:#fff;text-align:center;margin-bottom:16px;font-size:1.2rem;">ðŸ“· Scan Customer QR Code</h3>
            <div id="pos-qr-reader" style="width:100%;border-radius:12px;overflow:hidden;"></div>
            <p id="pos-qr-scanner-status" style="color:#fff;text-align:center;margin-top:16px;font-size:0.95rem;">Point camera at customer's QR code</p>
            <button onclick="closePosQrScanner()" class="pos-btn pos-btn-secondary" style="width:100%;margin-top:20px;">Cancel & Use Phone Number</button>
          </div>
        </div>

        <!-- Step 2: Verify OTP & Customer Info -->
        <div class="pos-step-content" id="pos-step-2">
          <div class="pos-card">
            <h2 style="font-size:1.4rem;font-weight:600;margin-bottom:8px;text-align:center;">ðŸ” Verify Customer</h2>
            
            <div id="pos-otp-section">
              <p style="color:var(--text-muted);text-align:center;margin-bottom:16px;font-size:1.05rem;">Enter the verification code sent to customer's phone.</p>
              
              <div id="pos-otp-display-box" class="pos-otp-display" style="display:none;">
                <div style="font-size:1rem;color:var(--text-muted);margin-bottom:12px;">ðŸ“² Show this code to customer:</div>
                <div class="pos-otp-code" id="pos-otp-display">------</div>
                <div class="pos-otp-hint">â±ï¸ Code expires in 5 minutes</div>
                <div class="pos-otp-resend">
                  <button class="pos-btn-ghost" onclick="posResendOtp()" id="pos-resend-btn">ðŸ”„ Resend Code</button>
                </div>
              </div>
              
              <div class="pos-form-group">
                <label class="pos-label">Verification Code</label>
                <input type="text" class="pos-input pos-input-lg" id="pos-otp-input" placeholder="Enter 6-digit code" maxlength="6" inputmode="numeric" style="text-transform:uppercase;">
                <div class="pos-input-hint">Enter the code shown above or sent via SMS</div>
              </div>
            </div>
            
            <div id="pos-customer-info-section" style="display:none;">
              <div style="background:var(--accent-gold-soft);border:1px solid #c9a227;border-radius:var(--radius-md);padding:16px;margin-bottom:24px;text-align:center;">
                <span style="font-size:1.2rem;">ðŸ‘¤</span>
                <span style="font-weight:600;color:#c9a227;">New Customer</span>
                <span style="color:var(--text-muted);font-size:0.9rem;"> - Please collect their info</span>
              </div>
              
              <div class="pos-form-row">
                <div class="pos-form-group">
                  <label class="pos-label">Full Name *</label>
                  <input type="text" class="pos-input" id="pos-customer-name" placeholder="John Smith">
                </div>
                <div class="pos-form-group">
                  <label class="pos-label">Email Address</label>
                  <input type="email" class="pos-input" id="pos-customer-email" placeholder="john@email.com">
                </div>
              </div>
            </div>
            
            <div id="pos-existing-customer-section" style="display:none;">
              <div style="background:var(--accent-green-soft);border:1px solid var(--accent-green);border-radius:var(--radius-md);padding:20px;text-align:center;">
                <span style="font-size:2rem;display:block;margin-bottom:8px;">âœ…</span>
                <div style="font-weight:600;color:var(--accent-green);font-size:1.1rem;" id="pos-existing-name">Welcome back!</div>
                <div style="color:var(--text-muted);font-size:0.9rem;" id="pos-existing-email"></div>
              </div>
            </div>
            
            <div style="display:flex;gap:16px;justify-content:center;margin-top:24px;">
              <button class="pos-btn pos-btn-secondary" onclick="posGoToStep(1)">â† Back</button>
              <button class="pos-btn pos-btn-primary" onclick="posVerifyOtp()" id="pos-verify-btn">Verify & Continue â†’</button>
            </div>
            
            <div id="pos-otp-error" style="color:var(--accent-red);text-align:center;margin-top:16px;display:none;"></div>
          </div>
        </div>

        <!-- Step 3: Vehicle Selection -->
        <div class="pos-step-content" id="pos-step-3">
          <div class="pos-card">
            <h2 style="font-size:1.4rem;font-weight:600;margin-bottom:8px;text-align:center;">ðŸš— Select Vehicle</h2>
            <p style="color:var(--text-muted);text-align:center;margin-bottom:24px;">Choose an existing vehicle or add a new one.</p>
            
            <div id="pos-existing-vehicles"></div>
            
            <div style="text-align:center;margin:20px 0;">
              <button class="pos-btn pos-btn-secondary" onclick="posShowNewVehicleForm()" id="pos-add-vehicle-btn">
                + Add New Vehicle
              </button>
            </div>
            
            <div id="pos-new-vehicle-form" style="display:none;border-top:1px solid var(--border-subtle);padding-top:24px;margin-top:24px;">
              <h3 style="font-size:1.1rem;font-weight:600;margin-bottom:16px;">New Vehicle Details</h3>
              
              <div class="pos-form-row">
                <div class="pos-form-group">
                  <label class="pos-label">Year *</label>
                  <select class="pos-input" id="pos-vehicle-year">
                    <option value="">Select Year</option>
                  </select>
                </div>
                <div class="pos-form-group">
                  <label class="pos-label">Make *</label>
                  <input type="text" class="pos-input" id="pos-vehicle-make" placeholder="Toyota">
                </div>
              </div>
              
              <div class="pos-form-row">
                <div class="pos-form-group">
                  <label class="pos-label">Model *</label>
                  <input type="text" class="pos-input" id="pos-vehicle-model" placeholder="Camry">
                </div>
                <div class="pos-form-group">
                  <label class="pos-label">Color</label>
                  <input type="text" class="pos-input" id="pos-vehicle-color" placeholder="Silver">
                </div>
              </div>
              
              <div class="pos-form-row">
                <div class="pos-form-group">
                  <label class="pos-label">License Plate</label>
                  <input type="text" class="pos-input" id="pos-vehicle-plate" placeholder="ABC-1234" style="text-transform:uppercase;">
                </div>
                <div class="pos-form-group">
                  <label class="pos-label">VIN (optional)</label>
                  <input type="text" class="pos-input" id="pos-vehicle-vin" placeholder="17 characters" maxlength="17" style="text-transform:uppercase;">
                </div>
              </div>
            </div>
            
            <div style="display:flex;gap:16px;justify-content:center;margin-top:24px;">
              <button class="pos-btn pos-btn-secondary" onclick="posGoToStep(2)">â† Back</button>
              <button class="pos-btn pos-btn-primary" onclick="posSelectVehicle()" id="pos-vehicle-btn">Continue â†’</button>
            </div>
            
            <div id="pos-vehicle-error" style="color:var(--accent-red);text-align:center;margin-top:16px;display:none;"></div>
          </div>
        </div>

        <!-- Step 4: Service Entry -->
        <div class="pos-step-content" id="pos-step-4">
          <div class="pos-card">
            <h2 style="font-size:1.4rem;font-weight:600;margin-bottom:8px;text-align:center;">ðŸ”§ Service Details</h2>
            <p style="color:var(--text-muted);text-align:center;margin-bottom:24px;">Enter the service being performed.</p>
            
            <div class="pos-form-group">
              <label class="pos-label">âš¡ Quick Select Popular Services</label>
              <div class="pos-quick-services">
                <button class="pos-quick-btn" onclick="posQuickService('Detailing', 'Quick Detail - Exterior wash, interior vacuum, windows', 99)">
                  âœ¨ Quick Detail<span class="pos-quick-btn-price">$99</span>
                </button>
                <button class="pos-quick-btn" onclick="posQuickService('Detailing', 'Full Detail - Complete interior/exterior detail with wax', 199)">
                  ðŸ’Ž Full Detail<span class="pos-quick-btn-price">$199</span>
                </button>
                <button class="pos-quick-btn" onclick="posQuickService('Tint', 'Window Tint - 2 Front Doors', 150)">
                  ðŸªŸ Tint 2-Door<span class="pos-quick-btn-price">$150</span>
                </button>
                <button class="pos-quick-btn" onclick="posQuickService('Tint', 'Window Tint - Full Vehicle (5 windows)', 299)">
                  ðŸªŸ Full Tint<span class="pos-quick-btn-price">$299</span>
                </button>
                <button class="pos-quick-btn" onclick="posQuickService('Ceramic Coating', 'Ceramic Coating - 1 Year Protection', 499)">
                  ðŸ›¡ï¸ Ceramic<span class="pos-quick-btn-price">$499</span>
                </button>
              </div>
            </div>
            
            <div class="pos-form-group">
              <label class="pos-label">Service Category *</label>
              <select class="pos-input" id="pos-service-category">
                <option value="">Select Category</option>
                <option value="Detailing">âœ¨ Detailing</option>
                <option value="Tint">ðŸªŸ Tint</option>
                <option value="Wrap">ðŸŽ¨ Wrap</option>
                <option value="PPF">ðŸ›¡ï¸ PPF (Paint Protection Film)</option>
                <option value="Ceramic Coating">ðŸ’Ž Ceramic Coating</option>
                <option value="Wheels & Tires">ðŸ›ž Wheels & Tires</option>
                <option value="Maintenance">ðŸ”§ Maintenance</option>
                <option value="Performance">âš¡ Performance</option>
                <option value="Off-Road">ðŸ”ï¸ Off-Road</option>
                <option value="Cosmetic">âœ¨ Cosmetic</option>
                <option value="EV & Hybrid">ðŸ”‹ EV & Hybrid</option>
                <option value="Classic & Vintage">ðŸ›ï¸ Classic & Vintage</option>
                <option value="Fleet Graphics">ðŸš Fleet Graphics</option>
                <option value="Premium Protection">ðŸ”’ Premium Protection</option>
                <option value="Convertible & Specialty">ðŸš— Convertible & Specialty</option>
                <option value="Motorcycle">ðŸï¸ Motorcycle</option>
                <option value="RV & Camper">ðŸš RV & Camper</option>
                <option value="Boat & Marine">â›µ Boat & Marine</option>
                <option value="Other">ðŸ“¦ Other</option>
              </select>
            </div>
            
            <div class="pos-form-group">
              <label class="pos-label">Service Description *</label>
              <textarea class="pos-input" id="pos-service-description" placeholder="Describe the work being performed..." style="min-height:100px;resize:vertical;"></textarea>
            </div>
            
            <div class="pos-form-row">
              <div class="pos-form-group">
                <label class="pos-label">Labor Price *</label>
                <div style="position:relative;">
                  <span style="position:absolute;left:16px;top:50%;transform:translateY(-50%);font-size:1.2rem;color:var(--text-muted);">$</span>
                  <input type="number" class="pos-input" id="pos-labor-price" placeholder="0.00" step="0.01" min="0" style="padding-left:40px;">
                </div>
              </div>
              <div class="pos-form-group">
                <label class="pos-label">Parts Price</label>
                <div style="position:relative;">
                  <span style="position:absolute;left:16px;top:50%;transform:translateY(-50%);font-size:1.2rem;color:var(--text-muted);">$</span>
                  <input type="number" class="pos-input" id="pos-parts-price" placeholder="0.00" step="0.01" min="0" style="padding-left:40px;">
                </div>
              </div>
            </div>
            
            <div class="pos-form-group">
              <label class="pos-label">Internal Notes (optional)</label>
              <textarea class="pos-input" id="pos-service-notes" placeholder="Notes for your records..." style="min-height:80px;resize:vertical;"></textarea>
            </div>
            
            <!-- Vehicle Inspection Section -->
            <div style="border:1px solid var(--border-subtle);border-radius:var(--radius-md);margin-top:24px;overflow:hidden;">
              <div id="pos-inspection-header" onclick="posToggleInspection()" style="padding:16px;background:var(--bg-elevated);cursor:pointer;display:flex;justify-content:space-between;align-items:center;">
                <div style="display:flex;align-items:center;gap:10px;">
                  <span style="font-size:1.2rem;">ðŸ”</span>
                  <div>
                    <div style="font-weight:600;">Vehicle Inspection</div>
                    <div style="font-size:0.85rem;color:var(--text-muted);">Optional multi-point inspection checklist</div>
                  </div>
                </div>
                <span id="pos-inspection-toggle" style="font-size:1.2rem;color:var(--text-muted);transition:transform 0.2s;">â–¼</span>
              </div>
              
              <div id="pos-inspection-body" style="display:none;padding:20px;background:var(--bg-input);">
                <div class="pos-form-group">
                  <label class="pos-label">Inspection Type</label>
                  <select class="pos-input" id="pos-inspection-type" onchange="posUpdateInspectionChecklist()">
                    <option value="">Select Inspection Type</option>
                    <option value="quick_visual">ðŸ”Ž Quick Visual (5-point)</option>
                    <option value="multi_point">ðŸ“‹ Multi-Point (15-point)</option>
                    <option value="full_diagnostic">ðŸ”§ Full Diagnostic (25-point)</option>
                  </select>
                </div>
                
                <div id="pos-inspection-checklist" style="display:none;">
                  <div class="pos-form-group">
                    <label class="pos-label">Technician Name</label>
                    <input type="text" class="pos-input" id="pos-inspection-technician" placeholder="Enter technician name">
                  </div>
                  
                  <div id="pos-inspection-items" style="margin-top:16px;"></div>
                  
                  <div class="pos-form-group" style="margin-top:20px;">
                    <label class="pos-label">Overall Vehicle Condition</label>
                    <select class="pos-input" id="pos-inspection-condition">
                      <option value="">Select Overall Condition</option>
                      <option value="excellent">âœ… Excellent - No issues found</option>
                      <option value="good">ðŸ‘ Good - Minor wear, no immediate action needed</option>
                      <option value="fair">âš ï¸ Fair - Some items need attention soon</option>
                      <option value="needs_attention">ðŸ”¶ Needs Attention - Recommend service soon</option>
                      <option value="critical">ðŸ”´ Critical - Immediate attention required</option>
                    </select>
                  </div>
                  
                  <div class="pos-form-group">
                    <label class="pos-label">Inspection Notes</label>
                    <textarea class="pos-input" id="pos-inspection-notes" placeholder="Additional observations or recommendations..." style="min-height:80px;resize:vertical;"></textarea>
                  </div>
                </div>
              </div>
            </div>
            
            <div style="display:flex;gap:16px;justify-content:center;margin-top:24px;">
              <button class="pos-btn pos-btn-secondary" onclick="posGoToStep(3)">â† Back</button>
              <button class="pos-btn pos-btn-primary" onclick="posAddService()" id="pos-service-btn">Continue to Authorization â†’</button>
            </div>
            
            <div id="pos-service-error" style="color:var(--accent-red);text-align:center;margin-top:16px;display:none;"></div>
          </div>
        </div>

        <!-- Step 5: Authorization & Waiver -->
        <div class="pos-step-content" id="pos-step-5">
          <div class="pos-card">
            <h2 style="font-size:1.4rem;font-weight:600;margin-bottom:8px;text-align:center;">âœï¸ Authorization & Waiver</h2>
            <p style="color:var(--text-muted);text-align:center;margin-bottom:24px;">Please review and sign to authorize the service.</p>
            
            <div class="pos-auth-summary">
              <h3 style="font-size:1rem;font-weight:600;margin-bottom:12px;color:#c9a227;">ðŸ“‹ Service Authorization</h3>
              <div class="pos-auth-row">
                <span class="pos-auth-label">Customer</span>
                <span class="pos-auth-value" id="pos-auth-customer">-</span>
              </div>
              <div class="pos-auth-row">
                <span class="pos-auth-label">Vehicle</span>
                <span class="pos-auth-value" id="pos-auth-vehicle">-</span>
              </div>
              <div class="pos-auth-row">
                <span class="pos-auth-label">Service</span>
                <span class="pos-auth-value" id="pos-auth-service">-</span>
              </div>
              <div class="pos-auth-row">
                <span class="pos-auth-label">Estimated Cost</span>
                <span class="pos-auth-value" id="pos-auth-cost" style="color:#c9a227;font-weight:700;">$0.00</span>
              </div>
            </div>
            
            <div class="pos-waiver-box">
              <div class="pos-waiver-text" id="pos-waiver-text">
                I authorize the above services to be performed on my vehicle. I understand that the estimated cost may change if additional work is required, and I will be notified before any additional charges are incurred. I acknowledge that I have been informed of the nature of the work to be performed and agree to pay for the services rendered upon completion. I release the service provider from liability for any pre-existing conditions not caused by their service.
              </div>
            </div>
            
            <div class="pos-form-group">
              <label class="pos-label">Signer Name *</label>
              <input type="text" class="pos-input" id="pos-signer-name" placeholder="Full legal name">
            </div>
            
            <div class="pos-form-group">
              <label class="pos-label">Signature *</label>
              <p style="font-size:0.85rem;color:var(--text-muted);margin-bottom:12px;">Please sign below using your finger or mouse</p>
              <div class="pos-signature-container" id="pos-signature-container">
                <canvas class="pos-signature-canvas" id="pos-signature-canvas"></canvas>
              </div>
              <div class="pos-signature-actions">
                <button class="pos-btn pos-btn-secondary" onclick="posClearSignature()" style="flex:1;">ðŸ—‘ï¸ Clear Signature</button>
              </div>
            </div>
            
            <div style="display:flex;gap:16px;justify-content:center;margin-top:24px;">
              <button class="pos-btn pos-btn-secondary" onclick="posGoToStep(4)">â† Back</button>
              <button class="pos-btn pos-btn-primary" onclick="posSubmitAuthorization()" id="pos-auth-btn" style="min-width:200px;">âœï¸ Sign and Authorize</button>
            </div>
            
            <div id="pos-auth-error" style="color:var(--accent-red);text-align:center;margin-top:16px;display:none;"></div>
          </div>
        </div>

        <!-- Step 6: Review & Pay -->
        <div class="pos-step-content" id="pos-step-6">
          <div class="pos-card">
            <h2 style="font-size:1.4rem;font-weight:600;margin-bottom:8px;text-align:center;">ðŸ’³ Review & Payment</h2>
            <p style="color:var(--text-muted);text-align:center;margin-bottom:24px;">Review the service details and collect payment.</p>
            
            <div style="background:var(--bg-elevated);border:1px solid var(--border-subtle);border-radius:var(--radius-md);padding:20px;margin-bottom:24px;">
              <h3 style="font-size:1rem;font-weight:600;margin-bottom:16px;color:#c9a227;">ðŸ“‹ Service Summary</h3>
              
              <div class="pos-summary-row">
                <span>Customer</span>
                <span id="pos-summary-customer" style="font-weight:500;">-</span>
              </div>
              <div class="pos-summary-row">
                <span>Vehicle</span>
                <span id="pos-summary-vehicle" style="font-weight:500;">-</span>
              </div>
              <div class="pos-summary-row">
                <span>Service</span>
                <span id="pos-summary-service" style="font-weight:500;">-</span>
              </div>
              <div class="pos-summary-row">
                <span>Labor</span>
                <span id="pos-summary-labor">$0.00</span>
              </div>
              <div class="pos-summary-row">
                <span>Parts</span>
                <span id="pos-summary-parts">$0.00</span>
              </div>
              <div class="pos-summary-row total">
                <span>Total</span>
                <span id="pos-summary-total">$0.00</span>
              </div>
              <div id="pos-vip-badge" style="display:none;margin:12px 0;"></div>
              <div class="pos-summary-row" id="pos-summary-auth-row">
                <span>Authorization</span>
                <span class="pos-authorized-badge" id="pos-summary-auth">âœ“ Authorized by <span id="pos-auth-signer">-</span></span>
              </div>
            </div>
            
            <div class="pos-form-group">
              <label class="pos-label">ðŸ’³ Card Payment</label>
              <div id="pos-stripe-element"></div>
              <div id="pos-card-error" style="color:var(--accent-red);font-size:0.9rem;margin-top:8px;"></div>
            </div>
            
            <div style="display:flex;gap:16px;justify-content:center;margin-top:24px;">
              <button class="pos-btn pos-btn-secondary" onclick="posGoToStep(5)">â† Back</button>
              <button class="pos-btn pos-btn-success" onclick="posProcessPayment()" id="pos-pay-btn" style="min-width:200px;">
                ðŸ’³ Process Payment
              </button>
            </div>
            
            <div id="pos-payment-error" style="color:var(--accent-red);text-align:center;margin-top:16px;display:none;"></div>
          </div>
        </div>

        <!-- Marketplace Job Choice Overlay -->
        <div id="pos-marketplace-choice" style="display:none;position:absolute;top:0;left:0;right:0;bottom:0;background:rgba(10,10,15,0.95);z-index:100;padding:24px;overflow-y:auto;">
          <div class="pos-card" style="max-width:600px;margin:0 auto;">
            <h2 style="font-size:1.4rem;font-weight:600;margin-bottom:8px;text-align:center;">ðŸ“‹ Existing Marketplace Job Found</h2>
            <p style="color:var(--text-muted);text-align:center;margin-bottom:24px;">This customer has accepted bids awaiting vehicle drop-off. Select a job or start a new walk-in service.</p>
            
            <div id="pos-marketplace-jobs-list" style="margin-bottom:24px;"></div>
            
            <div style="border-top:1px solid var(--border-subtle);padding-top:20px;text-align:center;">
              <p style="color:var(--text-muted);font-size:0.9rem;margin-bottom:12px;">Or create a new walk-in transaction:</p>
              <button class="pos-btn pos-btn-secondary" onclick="posChooseNewWalkin()" style="min-width:200px;">
                âž• New Walk-In Service
              </button>
            </div>
          </div>
        </div>
        
        <!-- Marketplace Loading State -->
        <div id="pos-marketplace-loading" style="display:none;position:absolute;top:0;left:0;right:0;bottom:0;background:rgba(10,10,15,0.95);z-index:100;padding:24px;">
          <div class="pos-card" style="max-width:400px;margin:80px auto;text-align:center;">
            <div class="pos-spinner" style="margin:0 auto 16px;"></div>
            <h3 style="font-size:1.2rem;margin-bottom:8px;">Processing Marketplace Job...</h3>
            <p style="color:var(--text-muted);">Please wait while we link the job.</p>
          </div>
        </div>

        <!-- Success State -->
        <div class="pos-step-content" id="pos-step-success" style="display:none;">
          <div class="pos-card pos-success-animation" style="text-align:center;position:relative;overflow:hidden;" id="pos-success-card">
            <div class="pos-success-checkmark">âœ…</div>
            <h2 style="font-size:1.8rem;font-weight:600;color:var(--accent-green);margin-bottom:8px;" id="pos-success-title">Payment Successful!</h2>
            <p style="color:var(--text-muted);margin-bottom:24px;font-size:1.05rem;" id="pos-success-message">The transaction has been completed successfully.</p>
            
            <div style="background:var(--bg-elevated);border-radius:var(--radius-md);padding:24px;margin-bottom:24px;text-align:left;">
              <div class="pos-summary-row">
                <span>Transaction ID</span>
                <span id="pos-success-txn" style="font-weight:500;font-family:monospace;font-size:1.05rem;">-</span>
              </div>
              <div class="pos-summary-row">
                <span>Amount Charged</span>
                <span id="pos-success-amount" style="font-weight:700;color:#c9a227;font-size:1.3rem;">$0.00</span>
              </div>
              <div class="pos-summary-row">
                <span>Customer</span>
                <span id="pos-success-customer" style="font-weight:500;">-</span>
              </div>
              <div class="pos-summary-row">
                <span>Vehicle</span>
                <span id="pos-success-vehicle" style="font-weight:500;">-</span>
              </div>
              <div class="pos-summary-row" id="pos-success-auth-row">
                <span>Authorization</span>
                <span class="pos-authorized-badge">âœ“ Authorized by <span id="pos-success-signer">-</span></span>
              </div>
              <div style="font-size:0.85rem;color:var(--text-muted);margin-top:8px;padding-top:8px;border-top:1px solid var(--border-subtle);">
                ðŸ“‹ Work Authorization on file
              </div>
            </div>
            
            <!-- Receipt Delivery Options -->
            <div id="pos-receipt-section" style="background:var(--bg-input);border:1px solid var(--border-subtle);border-radius:var(--radius-md);padding:20px;margin-bottom:24px;text-align:left;">
              <h3 style="font-size:1.05rem;font-weight:600;margin-bottom:16px;display:flex;align-items:center;gap:8px;">
                ðŸ“§ Send Receipt & Service Report
                <span style="font-size:0.75rem;color:var(--accent-red);font-weight:500;">(Required - select at least one)</span>
              </h3>
              
              <div style="display:flex;flex-direction:column;gap:12px;">
                <label class="pos-receipt-option" style="display:flex;align-items:center;gap:12px;padding:14px 16px;background:var(--bg-elevated);border:1px solid var(--border-subtle);border-radius:var(--radius-md);cursor:pointer;transition:all 0.2s;">
                  <input type="checkbox" id="pos-receipt-email" checked style="width:20px;height:20px;accent-color:var(--accent-gold);cursor:pointer;">
                  <span style="flex:1;">
                    <span style="font-weight:500;">ðŸ“§ Email Receipt</span>
                    <span id="pos-receipt-email-display" style="display:block;font-size:0.85rem;color:var(--text-muted);margin-top:2px;"></span>
                  </span>
                </label>
                
                <label class="pos-receipt-option" style="display:flex;align-items:center;gap:12px;padding:14px 16px;background:var(--bg-elevated);border:1px solid var(--border-subtle);border-radius:var(--radius-md);cursor:pointer;transition:all 0.2s;">
                  <input type="checkbox" id="pos-receipt-sms" checked style="width:20px;height:20px;accent-color:var(--accent-gold);cursor:pointer;">
                  <span style="flex:1;">
                    <span style="font-weight:500;">ðŸ“± Text Message</span>
                    <span id="pos-receipt-sms-display" style="display:block;font-size:0.85rem;color:var(--text-muted);margin-top:2px;"></span>
                  </span>
                </label>
                
                <label class="pos-receipt-option" style="display:flex;align-items:center;gap:12px;padding:14px 16px;background:var(--bg-elevated);border:1px solid var(--border-subtle);border-radius:var(--radius-md);cursor:pointer;transition:all 0.2s;">
                  <input type="checkbox" id="pos-receipt-print" checked style="width:20px;height:20px;accent-color:var(--accent-gold);cursor:pointer;">
                  <span style="flex:1;">
                    <span style="font-weight:500;">ðŸ–¨ï¸ Print Receipt</span>
                    <span style="display:block;font-size:0.85rem;color:var(--text-muted);margin-top:2px;">Thermal printer friendly (80mm)</span>
                  </span>
                </label>
              </div>
              
              <div id="pos-receipt-validation-error" style="color:var(--accent-red);font-size:0.88rem;margin-top:12px;display:none;text-align:center;">
                âš ï¸ Please select at least one delivery method
              </div>
            </div>
            
            <div style="display:flex;gap:16px;justify-content:center;flex-wrap:wrap;">
              <button class="pos-btn pos-btn-success" onclick="posSendReceipt()" id="pos-send-receipt-btn" style="min-width:220px;">
                âœ‰ï¸ Send Receipt
              </button>
              <button class="pos-btn pos-btn-primary" onclick="posStartNewSession()" style="min-width:250px;">
                ðŸ›’ Start New Transaction
              </button>
            </div>
            
            <div id="pos-receipt-status" style="margin-top:16px;padding:12px;border-radius:var(--radius-md);display:none;"></div>
            
            <!-- Maintenance Reminder Section -->
            <div id="pos-maintenance-reminder-section" style="background:var(--bg-input);border:1px solid var(--border-subtle);border-radius:var(--radius-md);padding:20px;margin-top:24px;text-align:left;">
              <h3 style="font-size:1.05rem;font-weight:600;margin-bottom:16px;display:flex;align-items:center;gap:8px;">
                ðŸ”” Set Maintenance Reminder
                <span style="font-size:0.75rem;color:var(--text-muted);font-weight:400;">(Optional)</span>
              </h3>
              
              <div style="display:grid;gap:16px;">
                <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;">
                  <div>
                    <label style="display:block;font-size:0.85rem;color:var(--text-secondary);margin-bottom:6px;">Reminder Type</label>
                    <select id="pos-reminder-type" style="width:100%;padding:12px 14px;background:var(--bg-elevated);border:1px solid var(--border-subtle);border-radius:var(--radius-md);color:var(--text-primary);font-family:inherit;font-size:0.92rem;">
                      <option value="">Select service type...</option>
                      <option value="Oil Change">ðŸ›¢ï¸ Oil Change</option>
                      <option value="Tire Rotation">ðŸ”„ Tire Rotation</option>
                      <option value="Brake Service">ðŸ›‘ Brake Service</option>
                      <option value="Air Filter">ðŸ’¨ Air Filter</option>
                      <option value="Transmission Service">âš™ï¸ Transmission Service</option>
                      <option value="Coolant Flush">â„ï¸ Coolant Flush</option>
                      <option value="Spark Plugs">âš¡ Spark Plugs</option>
                      <option value="Battery Check">ðŸ”‹ Battery Check</option>
                      <option value="Wheel Alignment">â†”ï¸ Wheel Alignment</option>
                      <option value="General Inspection">ðŸ” General Inspection</option>
                      <option value="Other">ðŸ“‹ Other</option>
                    </select>
                  </div>
                  
                  <div>
                    <label style="display:block;font-size:0.85rem;color:var(--text-secondary);margin-bottom:6px;">Reminder Date</label>
                    <input type="date" id="pos-reminder-date" style="width:100%;padding:12px 14px;background:var(--bg-elevated);border:1px solid var(--border-subtle);border-radius:var(--radius-md);color:var(--text-primary);font-family:inherit;font-size:0.92rem;">
                  </div>
                </div>
                
                <div style="display:flex;gap:8px;flex-wrap:wrap;">
                  <button type="button" class="pos-btn pos-btn-secondary" onclick="posSetReminderQuick(3)" style="padding:8px 14px;font-size:0.82rem;">3 Months</button>
                  <button type="button" class="pos-btn pos-btn-secondary" onclick="posSetReminderQuick(6)" style="padding:8px 14px;font-size:0.82rem;">6 Months</button>
                  <button type="button" class="pos-btn pos-btn-secondary" onclick="posSetReminderQuick(12)" style="padding:8px 14px;font-size:0.82rem;">1 Year</button>
                </div>
                
                <div>
                  <label style="display:block;font-size:0.85rem;color:var(--text-secondary);margin-bottom:6px;">Notes (Optional)</label>
                  <textarea id="pos-reminder-notes" rows="2" placeholder="e.g., Customer prefers synthetic oil..." style="width:100%;padding:12px 14px;background:var(--bg-elevated);border:1px solid var(--border-subtle);border-radius:var(--radius-md);color:var(--text-primary);font-family:inherit;font-size:0.92rem;resize:vertical;"></textarea>
                </div>
                
                <div style="display:flex;gap:12px;align-items:center;">
                  <button type="button" class="pos-btn pos-btn-primary" onclick="posAddMaintenanceReminder()" id="pos-add-reminder-btn" style="flex:1;">
                    ðŸ”” Add Reminder
                  </button>
                </div>
                
                <div id="pos-reminder-status" style="display:none;padding:12px;border-radius:var(--radius-md);text-align:center;"></div>
                <div id="pos-reminders-list" style="display:none;"></div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Session History -->
      <div class="card" style="margin-top:32px;">
        <div class="card-header">
          <h2 class="card-title">ðŸ“œ Recent POS Sessions</h2>
          <button class="btn btn-ghost" onclick="posLoadHistory()">ðŸ”„ Refresh</button>
        </div>
        <div id="pos-history-list">
          <div class="empty-state" style="padding:32px;">
            <div class="empty-state-icon">ðŸ›’</div>
            <p>No walk-in transactions yet. Start your first transaction above!</p>
          </div>
        </div>
      </div>
    </section>

    <!-- POS Analytics Section -->
    <section id="pos-analytics" class="section">
      <div class="page-header">
        <h1 class="page-title">ðŸ“ˆ POS Analytics</h1>
        <p class="page-subtitle">Track your walk-in revenue, popular services, and customer insights.</p>
      </div>

      <div id="analytics-loading" style="text-align:center;padding:60px 20px;">
        <div class="pos-spinner" style="width:40px;height:40px;margin:0 auto 16px;border-width:4px;border-top-color:var(--accent-gold);"></div>
        <p style="color:var(--text-muted);">Loading analytics...</p>
      </div>

      <div id="analytics-content" style="display:none;">
        <div class="stats-grid" style="margin-bottom:24px;">
          <div class="stat-card">
            <div class="stat-icon gold">ðŸ’µ</div>
            <div class="stat-value" id="analytics-today">$0</div>
            <div class="stat-label">Today's Revenue</div>
          </div>
          <div class="stat-card">
            <div class="stat-icon blue">ðŸ“…</div>
            <div class="stat-value" id="analytics-week">$0</div>
            <div class="stat-label">This Week</div>
          </div>
          <div class="stat-card">
            <div class="stat-icon green">ðŸ“†</div>
            <div class="stat-value" id="analytics-month">$0</div>
            <div class="stat-label">This Month</div>
          </div>
          <div class="stat-card">
            <div class="stat-icon" style="background:rgba(168,85,247,0.15);">ðŸ“Š</div>
            <div class="stat-value" id="analytics-year">$0</div>
            <div class="stat-label">Year-to-Date</div>
          </div>
        </div>

        <div class="card" style="margin-bottom:24px;">
          <div class="card-header">
            <h2 class="card-title">ðŸ“‰ Revenue Trend (Last 30 Days)</h2>
            <span id="analytics-total-label" style="font-size:0.9rem;color:var(--text-muted);">Total: $0</span>
          </div>
          <div id="analytics-chart" style="display:flex;align-items:flex-end;gap:2px;height:150px;padding:16px 0;overflow-x:auto;"></div>
          <div id="analytics-chart-labels" style="display:flex;justify-content:space-between;font-size:0.72rem;color:var(--text-muted);padding:0 4px;"></div>
        </div>

        <div style="display:grid;grid-template-columns:repeat(auto-fit, minmax(320px, 1fr));gap:20px;margin-bottom:24px;">
          <div class="card">
            <div class="card-header">
              <h2 class="card-title">ðŸ”¥ Top Services by Count</h2>
            </div>
            <div id="analytics-services-count" style="display:flex;flex-direction:column;gap:12px;"></div>
          </div>
          <div class="card">
            <div class="card-header">
              <h2 class="card-title">ðŸ’° Top Services by Revenue</h2>
            </div>
            <div id="analytics-services-revenue" style="display:flex;flex-direction:column;gap:12px;"></div>
          </div>
        </div>

        <div style="display:grid;grid-template-columns:repeat(auto-fit, minmax(320px, 1fr));gap:20px;margin-bottom:24px;">
          <div class="card">
            <div class="card-header">
              <h2 class="card-title">ðŸ“… Busiest Days</h2>
            </div>
            <div id="analytics-busy-days" style="display:flex;gap:8px;flex-wrap:wrap;"></div>
          </div>
          <div class="card">
            <div class="card-header">
              <h2 class="card-title">â° Busiest Hours</h2>
            </div>
            <div id="analytics-busy-hours" style="display:flex;gap:8px;flex-wrap:wrap;"></div>
          </div>
        </div>

        <div class="card" style="background:linear-gradient(135deg, var(--bg-card), var(--accent-gold-soft));border:1px solid var(--accent-gold);">
          <div class="card-header">
            <h2 class="card-title">ðŸ‘¥ Customer Insights</h2>
          </div>
          <div style="display:grid;grid-template-columns:repeat(auto-fit, minmax(150px, 1fr));gap:20px;text-align:center;">
            <div>
              <div style="font-size:2rem;font-weight:700;color:var(--accent-gold);" id="analytics-unique-customers">0</div>
              <div style="font-size:0.85rem;color:var(--text-muted);">Unique Customers</div>
            </div>
            <div>
              <div style="font-size:2rem;font-weight:700;color:var(--accent-blue);" id="analytics-repeat-customers">0</div>
              <div style="font-size:0.85rem;color:var(--text-muted);">Repeat Customers</div>
            </div>
            <div>
              <div style="font-size:2rem;font-weight:700;color:var(--accent-green);" id="analytics-total-transactions">0</div>
              <div style="font-size:0.85rem;color:var(--text-muted);">Total Transactions</div>
            </div>
            <div>
              <div style="font-size:2rem;font-weight:700;color:var(--text-primary);" id="analytics-avg-transaction">$0</div>
              <div style="font-size:0.85rem;color:var(--text-muted);">Avg Transaction</div>
            </div>
          </div>
        </div>
      </div>

      <div id="analytics-empty" style="display:none;">
        <div class="empty-state" style="padding:60px 20px;">
          <div class="empty-state-icon">ðŸ“Š</div>
          <h3>No POS Data Yet</h3>
          <p>Complete your first walk-in transaction to start seeing analytics.</p>
          <button class="btn btn-primary" onclick="showSection('walkin-pos')" style="margin-top:16px;">ðŸ›’ Go to Walk-In POS</button>
        </div>
      </div>
    </section>

    <!-- Customer Queue Section -->
    <section id="customer-queue" class="section">
      <div class="page-header">
        <h1 class="page-title">ðŸ“‹ Customer Queue</h1>
        <p class="page-subtitle">Manage walk-in customers who checked in via tablet kiosk</p>
      </div>

      <div class="stats-grid" style="margin-bottom:24px;">
        <div class="stat-card">
          <div class="stat-icon" style="background:var(--accent-orange);background:rgba(245,158,11,0.15);">â³</div>
          <div class="stat-value" id="queue-waiting-count">0</div>
          <div class="stat-label">Total Waiting</div>
        </div>
        <div class="stat-card">
          <div class="stat-icon blue">ðŸ”§</div>
          <div class="stat-value" id="queue-serving-count">0</div>
          <div class="stat-label">Currently Serving</div>
        </div>
        <div class="stat-card">
          <div class="stat-icon green">âœ“</div>
          <div class="stat-value" id="queue-completed-count">0</div>
          <div class="stat-label">Completed Today</div>
        </div>
      </div>

      <div class="card" style="background:linear-gradient(135deg, var(--bg-card), var(--accent-blue-soft));border:1px solid var(--accent-blue);margin-bottom:24px;">
        <div style="display:flex;align-items:center;gap:16px;margin-bottom:16px;">
          <span style="font-size:2rem;">ðŸ“±</span>
          <div style="flex:1;">
            <div style="font-weight:600;font-size:1.05rem;margin-bottom:4px;">Tablet Kiosk Setup</div>
            <div style="font-size:0.88rem;color:var(--text-secondary);">Set up your customer check-in tablet by opening this URL:</div>
          </div>
        </div>
        <div style="display:flex;gap:12px;align-items:center;flex-wrap:wrap;">
          <div id="kiosk-url-display" style="flex:1;min-width:200px;padding:12px 16px;background:var(--bg-input);border:1px solid var(--border-subtle);border-radius:var(--radius-md);font-family:monospace;font-size:0.85rem;color:var(--accent-blue);word-break:break-all;">Loading...</div>
          <button class="btn btn-primary" onclick="copyKioskLink()" style="white-space:nowrap;">ðŸ“‹ Copy Link</button>
          <button class="btn btn-secondary" onclick="showKioskQR()" style="white-space:nowrap;">ðŸ“± Show QR Code</button>
        </div>
      </div>

      <div class="card">
        <div class="card-header">
          <h2 class="card-title">Customer Queue</h2>
          <button class="btn btn-ghost" onclick="loadCustomerQueue()">ðŸ”„ Refresh</button>
        </div>
        <div id="customer-queue-list">
          <div class="empty-state" style="padding:48px 24px;">
            <div class="empty-state-icon">ðŸ“‹</div>
            <p>No customers in queue. Set up the tablet kiosk to let customers check themselves in.</p>
          </div>
        </div>
      </div>
    </section>

  </main>

  <div class="toast-container" id="toast-container"></div>

  <!-- 2FA Verification Modal -->
  <div class="modal-backdrop" id="2fa-verify-modal">
    <div class="modal" style="max-width:420px;">
      <div class="modal-header">
        <h3 class="modal-title">ðŸ” Verify Your Phone</h3>
        <button class="modal-close" onclick="close2FAVerifyModal()">Ã—</button>
      </div>
      <div class="modal-body" style="text-align:center;">
        <div style="font-size:3rem;margin-bottom:16px;">ðŸ“±</div>
        <p style="color:var(--text-secondary);margin-bottom:8px;">We sent a verification code to</p>
        <p id="2fa-verify-phone-display" style="font-weight:600;font-size:1.1rem;margin-bottom:24px;color:var(--accent-gold);">(555) 555-5555</p>
        
        <div class="form-group" style="margin-bottom:20px;">
          <label class="form-label" style="text-align:center;">Enter 6-digit code</label>
          <div style="display:flex;justify-content:center;gap:8px;">
            <input type="text" class="form-input 2fa-digit" id="2fa-digit-1" maxlength="1" style="width:48px;height:56px;text-align:center;font-size:1.5rem;font-weight:600;" oninput="handle2FADigitInput(this, 1)" onkeydown="handle2FAKeydown(event, 1)">
            <input type="text" class="form-input 2fa-digit" id="2fa-digit-2" maxlength="1" style="width:48px;height:56px;text-align:center;font-size:1.5rem;font-weight:600;" oninput="handle2FADigitInput(this, 2)" onkeydown="handle2FAKeydown(event, 2)">
            <input type="text" class="form-input 2fa-digit" id="2fa-digit-3" maxlength="1" style="width:48px;height:56px;text-align:center;font-size:1.5rem;font-weight:600;" oninput="handle2FADigitInput(this, 3)" onkeydown="handle2FAKeydown(event, 3)">
            <input type="text" class="form-input 2fa-digit" id="2fa-digit-4" maxlength="1" style="width:48px;height:56px;text-align:center;font-size:1.5rem;font-weight:600;" oninput="handle2FADigitInput(this, 4)" onkeydown="handle2FAKeydown(event, 4)">
            <input type="text" class="form-input 2fa-digit" id="2fa-digit-5" maxlength="1" style="width:48px;height:56px;text-align:center;font-size:1.5rem;font-weight:600;" oninput="handle2FADigitInput(this, 5)" onkeydown="handle2FAKeydown(event, 5)">
            <input type="text" class="form-input 2fa-digit" id="2fa-digit-6" maxlength="1" style="width:48px;height:56px;text-align:center;font-size:1.5rem;font-weight:600;" oninput="handle2FADigitInput(this, 6)" onkeydown="handle2FAKeydown(event, 6)">
          </div>
        </div>
        
        <div id="2fa-verify-error" style="display:none;color:var(--accent-red);margin-bottom:16px;font-size:0.9rem;"></div>
        
        <button class="btn btn-primary" id="2fa-verify-btn" onclick="verify2FACode()" style="width:100%;margin-bottom:16px;" disabled>
          Verify & Enable 2FA
        </button>
        
        <div style="font-size:0.85rem;color:var(--text-muted);">
          Didn't receive the code? 
          <button onclick="resend2FACode()" style="background:none;border:none;color:var(--accent-gold);cursor:pointer;font-size:0.85rem;text-decoration:underline;" id="2fa-resend-btn">Resend Code</button>
        </div>
      </div>
    </div>
  </div>

  <!-- 2FA Disable Confirmation Modal -->
  <div class="modal-backdrop" id="2fa-disable-modal">
    <div class="modal" style="max-width:420px;">
      <div class="modal-header">
        <h3 class="modal-title">ðŸ”“ Disable 2FA</h3>
        <button class="modal-close" onclick="close2FADisableModal()">Ã—</button>
      </div>
      <div class="modal-body" style="text-align:center;">
        <div style="font-size:3rem;margin-bottom:16px;">âš ï¸</div>
        <h4 style="margin-bottom:12px;">Are you sure?</h4>
        <p style="color:var(--text-secondary);margin-bottom:24px;line-height:1.6;">
          Disabling two-factor authentication will make your account less secure. 
          Anyone with your password will be able to access your account.
        </p>
        
        <div style="display:flex;gap:12px;justify-content:center;">
          <button class="btn btn-secondary" onclick="close2FADisableModal()">Cancel</button>
          <button class="btn" style="background:rgba(239,95,95,0.15);color:var(--accent-red);border:1px solid rgba(239,95,95,0.3);" onclick="confirm2FADisable()">Yes, Disable 2FA</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Team Invite Modal -->
  <div class="modal-backdrop" id="team-invite-modal">
    <div class="modal" style="max-width:480px;">
      <div class="modal-header">
        <h3 class="modal-title">ðŸ‘¤ Invite Team Member</h3>
        <button class="modal-close" onclick="closeModal('team-invite-modal')">Ã—</button>
      </div>
      <div class="modal-body">
        <div id="team-invite-feedback" style="display:none;margin-bottom:16px;padding:12px 16px;border-radius:var(--radius-md);"></div>
        
        <div class="form-group">
          <label class="form-label">Email Address *</label>
          <input type="email" class="form-input" id="team-invite-email" placeholder="colleague@example.com">
        </div>
        
        <div class="form-group">
          <label class="form-label">Role *</label>
          <select class="form-input" id="team-invite-role">
            <option value="admin">Admin - Full access to manage jobs, bids, and settings</option>
            <option value="staff" selected>Staff - Can view and update jobs, limited settings access</option>
          </select>
          <p class="form-hint">Admins can manage team members. Staff members cannot.</p>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="closeModal('team-invite-modal')">Cancel</button>
        <button class="btn btn-primary" id="team-invite-submit-btn" onclick="submitTeamInvitation()">ðŸ“§ Send Invitation</button>
      </div>
    </div>
  </div>

  <!-- QR Code Modal -->
  <div class="modal-backdrop" id="qr-modal">
    <div class="modal" style="max-width:400px;text-align:center;">
      <div class="modal-header">
        <h3 class="modal-title">ðŸ“± Kiosk QR Code</h3>
        <button class="modal-close" onclick="closeQRModal()">Ã—</button>
      </div>
      <div class="modal-body">
        <p style="color:var(--text-secondary);margin-bottom:20px;">Scan this QR code with your tablet to open the customer check-in kiosk</p>
        <div id="qr-code-container" style="display:flex;justify-content:center;padding:20px;background:white;border-radius:var(--radius-md);"></div>
      </div>
    </div>
  </div>

  <script src="https://js.stripe.com/v3/"></script>
  <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
  <script src="supabaseclient.js?v=20260122"></script>
  <script src="mcc-config.js?v=20260122"></script>
  <script src="tos-modal.js?v=20260122"></script>
  <script src="emailService.js?v=20260122"></script>
  <script src="providers-core.js?v=20260122"></script>
  <script src="/pwa-init.js?v=20260122"></script>
  <script src="/chat-widget-base.js?v=20260122"></script>
  <script src="/helpdesk-widget.js?v=20260122"></script>
  <script>
    function toggleTheme() {
      const html = document.documentElement;
      html.classList.add('theme-transition');
      const current = html.getAttribute('data-theme');
      const newTheme = current === 'dark' ? 'light' : 'dark';
      html.setAttribute('data-theme', newTheme);
      localStorage.setItem('theme', newTheme);
      const metaTheme = document.querySelector('meta[name="theme-color"]');
      if (metaTheme) {
        metaTheme.content = newTheme === 'dark' ? '#12161c' : '#ffffff';
      }
      setTimeout(() => html.classList.remove('theme-transition'), 300);
    }

    document.addEventListener('DOMContentLoaded', async () => {
      await I18n.init();
      I18n.createLanguageSwitcher('language-switcher');
      
      new HelpdeskWidget({ mode: 'provider', position: 'bottom-right' });
    });
  </script>
</body>
</html>
